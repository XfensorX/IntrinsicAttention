{"timers": {"training_iteration": 1.6417203339515254, "restore_env_runners": 1.5583005733788013e-05, "training_step": 1.6415891669457778, "env_runner_sampling_timer": 1.5291564160725102, "learner_update_timer": 0.1091902080224827, "synch_weights": 0.0007276249816641212}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.00012054273065738893, "timers": {"connectors": {"tensor_to_numpy": 1.3860566608432946e-05, "normalize_and_clip_actions": 1.3383584524442868e-05, "listify_data_for_vector_env": 1.174829219994163e-05, "get_actions": 4.851556628715303e-05, "un_batch_to_individual_items": 5.711584988733049e-06, "remove_single_ts_time_rank_from_batch": 6.292275952203843e-07}}}, "num_env_steps_sampled": 5000.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7987572741277477e-06, "numpy_to_tensor": 9.350825248683095e-06, "batch_individual_items": 6.782854035273133e-06, "add_time_dim_to_batch_and_zero_pad": 2.566017532038709e-06, "add_observations_from_episodes_to_batch": 3.2698629292902684e-06}}, "connector_pipeline_timer": 4.764861369580415e-05}, "env_step_timer": 1.5355618307203693e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_in": 10.191744832559449, "num_agent_steps_sampled": {"default_agent": 5000.0}, "time_between_sampling": 0.0005339182218034623, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "episode_return_mean": -2.0200000000000005, "episode_duration_sec_mean": 0.005147254798561335, "env_to_module_sum_episodes_length_out": 10.191744832559449, "episode_len_mean": 20.0, "num_episodes": 250.0, "weights_seq_no": 0.0, "agent_episode_returns_mean": {"default_agent": -2.0200000000000005}, "episode_return_max": 9.5, "sample": 0.006314729260378657, "num_episodes_lifetime": 31375.0, "env_reset_timer": 9.152213395697203e-05, "module_episode_returns_mean": {"default_policy": -2.0200000000000005}, "episode_return_min": -10.5, "rlmodule_inference_timer": 5.308880143049691e-05, "num_env_steps_sampled_lifetime": 627500.0, "num_env_steps_sampled_lifetime_throughput": 3362.3083156357566}, "learners": {"__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.08008741703815758, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.007483749999664724, "add_time_dim_to_batch_and_zero_pad": 1.0541989468038082e-05, "add_observations_from_episodes_to_batch": 0.0007718330016359687, "add_columns_from_episodes_to_train_batch": 0.03324825002346188, "add_states_from_episodes_to_batch": 3.208988346159458e-06, "numpy_to_tensor": 5.787494592368603e-05, "batch_individual_items": 0.030938999960199, "general_advantage_estimation": 0.007458999985828996}}}, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 6000, "learner_connector_sum_episodes_length_out": 5250, "num_env_steps_trained_lifetime": 31500, "learner_connector_sum_episodes_length_in": 5000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1924595.9075980315, "num_module_steps_trained_throughput": 367927.63015963684, "num_module_steps_trained_lifetime_throughput": 367335.98172498407}, "default_policy": {"curr_kl_coeff": 0.3732481598854065, "num_trainable_parameters": 6003, "mean_kl_loss": 0.0005800133803859353, "weights_seq_no": 1.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "gradients_default_optimizer_global_norm": 0.10005132108926773, "module_train_batch_size_mean": 1000.0, "total_loss": 0.11597263813018799, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.009449124336242676, "entropy": 0.6901261210441589, "policy_loss": 0.05304957553744316, "num_module_steps_trained_lifetime": 6000, "curr_entropy_coeff": 0.0090570820258, "vf_loss_unclipped": 28.793254852294922, "num_module_steps_trained_lifetime_throughput": 368834.02566906926}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"episode_return_min": -14.5, "num_env_steps_sampled_lifetime": 5400, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.6042643374574275e-05, "un_batch_to_individual_items": 5.6164476404237606e-06, "remove_single_ts_time_rank_from_batch": 6.034948555430726e-07, "normalize_and_clip_actions": 1.1286942414986037e-05, "listify_data_for_vector_env": 1.1559882882870937e-05, "get_actions": 4.988017503539015e-05}}, "connector_pipeline_timer": 0.00012152371552413648}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.216013141322508, "episode_return_mean": 1.45, "episode_duration_sec_mean": 0.004710808297386393, "env_reset_timer": 0.000450958963483572, "module_episode_returns_mean": {"default_policy": 1.45}, "env_to_module_connector": {"connector_pipeline_timer": 4.7206764768681795e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 1.65276740249347e-06, "numpy_to_tensor": 8.986434873710291e-06, "batch_individual_items": 6.47550827640298e-06, "add_time_dim_to_batch_and_zero_pad": 2.3970407773746966e-06, "add_observations_from_episodes_to_batch": 3.0389655081028394e-06}}}, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_max": 13.5, "num_episodes_lifetime": 20, "rlmodule_inference_timer": 3.428792587002299e-05, "env_to_module_sum_episodes_length_in": 10.216013141322508, "episode_len_mean": 20.0, "sample": 0.10421333299018443, "weights_seq_no": 1.0, "episode_len_max": 20, "env_step_timer": 1.5819185582312212e-05, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": 1.45}}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "50370_00000", "date": "2025-08-11_19-19-25", "timestamp": 1754932765, "time_this_iter_s": 1.7605149745941162, "time_total_s": 1.7605149745941162, "pid": 14120, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x156df18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1.7605149745941162, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 33.93333333333333, "ram_util_percent": 83.7}}
{"timers": {"training_iteration": 1.6416588660329579, "restore_env_runners": 1.5494265826418994e-05, "training_step": 1.6415271994459908, "env_runner_sampling_timer": 1.5281890881620346, "learner_update_timer": 0.11009578927187248, "synch_weights": 0.000726241652155295, "restore_eval_env_runners": 7.416936568915844e-06, "evaluation_iteration": 0.11716912500560284, "synch_eval_env_connectors": 0.00013091694563627243, "synch_env_connectors": 4.584086127579212e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.00010879474757964687, "timers": {"connectors": {"tensor_to_numpy": 1.3530624322772685e-05, "normalize_and_clip_actions": 9.729135766928391e-06, "listify_data_for_vector_env": 1.1468061158476366e-05, "get_actions": 4.185796208789861e-05, "un_batch_to_individual_items": 5.4878216009818185e-06, "remove_single_ts_time_rank_from_batch": 6.068697414780735e-07}}}, "num_env_steps_sampled": 5000.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.773347908595936e-06, "numpy_to_tensor": 8.815555963190395e-06, "batch_individual_items": 6.484295355094814e-06, "add_time_dim_to_batch_and_zero_pad": 2.4279735632524656e-06, "add_observations_from_episodes_to_batch": 3.051457708666837e-06}}, "connector_pipeline_timer": 4.4392678045517524e-05}, "env_step_timer": 1.4307732815767195e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "time_between_sampling": 0.0015334710031665883, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "episode_return_mean": -1.3799999999999994, "episode_duration_sec_mean": 0.004720729503780602, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_mean": 20.0, "num_episodes": 250.0, "weights_seq_no": 1.0, "agent_episode_returns_mean": {"default_agent": -1.3799999999999994}, "episode_return_max": 9.5, "sample": 0.005415211207356831, "num_episodes_lifetime": 500.0, "env_reset_timer": 4.200033764342834e-05, "module_episode_returns_mean": {"default_policy": -1.3799999999999994}, "episode_return_min": -10.5, "rlmodule_inference_timer": 2.9963972730575793e-05, "num_env_steps_sampled_lifetime": 10000.0, "num_env_steps_sampled_lifetime_throughput": 3605.3915204031837}, "learners": {"__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.08114758911775424, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.007483592090429737, "add_time_dim_to_batch_and_zero_pad": 1.0636149672791362e-05, "add_observations_from_episodes_to_batch": 0.000772322581615299, "add_columns_from_episodes_to_train_batch": 0.03328291002311744, "add_states_from_episodes_to_batch": 3.216898767277598e-06, "numpy_to_tensor": 5.7974115479737525e-05, "batch_individual_items": 0.03198359746020287, "general_advantage_estimation": 0.0074394328962080186}}}, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 12000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 63000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1929324.2201204163, "num_module_steps_trained_throughput": 368813.9067865017, "num_module_steps_trained_lifetime_throughput": 368228.02118807874}, "default_policy": {"curr_kl_coeff": 0.18662407994270325, "num_trainable_parameters": 6003, "mean_kl_loss": 0.0005508643225766718, "weights_seq_no": 2.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "gradients_default_optimizer_global_norm": 0.09314917027950287, "module_train_batch_size_mean": 1000.0, "total_loss": 0.05817184969782829, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.009900569915771484, "entropy": 0.691680371761322, "policy_loss": -0.00450977822765708, "num_module_steps_trained_lifetime": 12000, "curr_entropy_coeff": 0.0090570820258, "vf_loss_unclipped": 28.727876663208008, "num_module_steps_trained_lifetime_throughput": 369698.1428059922}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_return_min": -14.5, "num_env_steps_sampled_lifetime": 10400, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.331681138797063e-05, "un_batch_to_individual_items": 5.365199262050772e-06, "remove_single_ts_time_rank_from_batch": 5.748217544571155e-07, "normalize_and_clip_actions": 9.503980630925978e-06, "listify_data_for_vector_env": 1.0910380477552244e-05, "get_actions": 3.721985873017459e-05}}, "connector_pipeline_timer": 0.00010245682273106975}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.366003441359926, "episode_return_mean": -0.55, "episode_duration_sec_mean": 0.004651230195304379, "env_reset_timer": 0.0004474610334727913, "module_episode_returns_mean": {"default_policy": -0.55}, "env_to_module_connector": {"connector_pipeline_timer": 4.2859365881740626e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 1.5956851408142283e-06, "numpy_to_tensor": 8.431804806820782e-06, "batch_individual_items": 6.1549216216489066e-06, "add_time_dim_to_batch_and_zero_pad": 2.384047718976399e-06, "add_observations_from_episodes_to_batch": 2.878814471228512e-06}}}, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_max": 13.5, "num_episodes_lifetime": 40, "rlmodule_inference_timer": 2.8028237577243194e-05, "env_to_module_sum_episodes_length_in": 10.366003441359926, "episode_len_mean": 20.0, "sample": 0.1041737555002328, "weights_seq_no": 2.0, "episode_len_max": 20, "env_step_timer": 1.4040928608008604e-05, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": -0.55}, "time_between_sampling": 1.6618485409999266}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "50370_00000", "date": "2025-08-11_19-19-27", "timestamp": 1754932767, "time_this_iter_s": 1.7436659336090088, "time_total_s": 3.504180908203125, "pid": 14120, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x156df18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3.504180908203125, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 32.93333333333334, "ram_util_percent": 83.39999999999999}}
{"timers": {"training_iteration": 1.6407055986223276, "restore_env_runners": 1.5405572799500074e-05, "training_step": 1.6405729612018563, "env_runner_sampling_timer": 1.5273705339402424, "learner_update_timer": 0.10995924970984923, "synch_weights": 0.0007256988164852373, "restore_eval_env_runners": 7.415267173200845e-06, "evaluation_iteration": 0.11705824208562261, "synch_eval_env_connectors": 0.0001307690260000527, "synch_env_connectors": 4.585325950756669e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.00010884856724627126, "timers": {"connectors": {"tensor_to_numpy": 1.3485213680885722e-05, "normalize_and_clip_actions": 9.778690047519066e-06, "listify_data_for_vector_env": 1.1614240903395112e-05, "get_actions": 4.158625187377188e-05, "un_batch_to_individual_items": 5.595878067526969e-06, "remove_single_ts_time_rank_from_batch": 6.189106180015614e-07}}}, "num_env_steps_sampled": 5000.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7758322500439213e-06, "numpy_to_tensor": 8.945235118240983e-06, "batch_individual_items": 6.489611566057365e-06, "add_time_dim_to_batch_and_zero_pad": 2.4611006141554754e-06, "add_observations_from_episodes_to_batch": 3.118917280109014e-06}}, "connector_pipeline_timer": 4.490481430795155e-05}, "env_step_timer": 1.451006552048022e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "time_between_sampling": 0.0019216811950686927, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "episode_return_mean": -1.1400000000000001, "episode_duration_sec_mean": 0.004769778977148234, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_mean": 20.0, "num_episodes": 250.0, "weights_seq_no": 2.0, "agent_episode_returns_mean": {"default_agent": -1.1400000000000001}, "episode_return_max": 9.5, "sample": 0.0051573404037462715, "num_episodes_lifetime": -30375.0, "env_reset_timer": 3.942459145520383e-05, "module_episode_returns_mean": {"default_policy": -1.1400000000000001}, "episode_return_min": -10.5, "rlmodule_inference_timer": 2.991864576405734e-05, "num_env_steps_sampled_lifetime": -607500.0, "num_env_steps_sampled_lifetime_throughput": 3607.409301014616}, "learners": {"__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.08112973780741449, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.007487444918870459, "add_time_dim_to_batch_and_zero_pad": 1.0785617830697446e-05, "add_observations_from_episodes_to_batch": 0.0007731743559008465, "add_columns_from_episodes_to_train_batch": 0.03329796634250087, "add_states_from_episodes_to_batch": 3.218069963622838e-06, "numpy_to_tensor": 5.7912294450216004e-05, "batch_individual_items": 0.03196276231529191, "general_advantage_estimation": 0.007422752317530104}}}, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 18000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 94500, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1938658.2989633651, "num_module_steps_trained_throughput": 370567.5097813355, "num_module_steps_trained_lifetime_throughput": 369991.2803000286}, "default_policy": {"curr_kl_coeff": 0.09331203997135162, "num_trainable_parameters": 6003, "mean_kl_loss": 0.0010828013764694333, "weights_seq_no": 3.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "gradients_default_optimizer_global_norm": 0.03816163167357445, "module_train_batch_size_mean": 1000.0, "total_loss": 0.05550922453403473, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.010045528411865234, "entropy": 0.6914566159248352, "policy_loss": -0.007170871365815401, "num_module_steps_trained_lifetime": 18000, "curr_entropy_coeff": 0.0090570820258, "vf_loss_unclipped": 28.677812576293945, "num_module_steps_trained_lifetime_throughput": 371415.7697736754}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_return_min": -14.5, "num_env_steps_sampled_lifetime": 15400, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3625154643871584e-05, "un_batch_to_individual_items": 5.726224667028281e-06, "remove_single_ts_time_rank_from_batch": 6.251861003705769e-07, "normalize_and_clip_actions": 9.844854985322311e-06, "listify_data_for_vector_env": 1.1361066692970489e-05, "get_actions": 3.9885166614161095e-05}}, "connector_pipeline_timer": 0.0001080596674216055}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368205581254823, "episode_return_mean": -0.8833333333333333, "episode_duration_sec_mean": 0.004690024299391856, "env_reset_timer": 0.0004441047541215084, "module_episode_returns_mean": {"default_policy": -0.8833333333333333}, "env_to_module_connector": {"connector_pipeline_timer": 4.621729036489718e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 1.6986396882983941e-06, "numpy_to_tensor": 8.776591923667349e-06, "batch_individual_items": 6.518093949709376e-06, "add_time_dim_to_batch_and_zero_pad": 2.3739663680083704e-06, "add_observations_from_episodes_to_batch": 3.239720915563245e-06}}}, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_max": 13.5, "num_episodes_lifetime": 60, "rlmodule_inference_timer": 3.370974938375698e-05, "env_to_module_sum_episodes_length_in": 10.368205581254823, "episode_len_mean": 20.0, "sample": 0.10417067419510569, "weights_seq_no": 3.0, "episode_len_max": 20, "env_step_timer": 1.528525399944676e-05, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": -0.8833333333333333}, "time_between_sampling": 1.6608677868405357}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "50370_00000", "date": "2025-08-11_19-19-28", "timestamp": 1754932768, "time_this_iter_s": 1.6585071086883545, "time_total_s": 5.1626880168914795, "pid": 14120, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x156df18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5.1626880168914795, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 56.1, "ram_util_percent": 83.6}}
{"timers": {"training_iteration": 1.6407915892958478, "restore_env_runners": 1.5318606057320718e-05, "training_step": 1.6406581974199999, "env_runner_sampling_timer": 1.5275560723515051, "learner_update_timer": 0.10985344721296218, "synch_weights": 0.00072712557779497, "restore_eval_env_runners": 7.720694807358086e-06, "evaluation_iteration": 0.11698714549423893, "synch_eval_env_connectors": 0.0001307480056071654, "synch_env_connectors": 4.580722132232041e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.00010727706173411776, "timers": {"connectors": {"tensor_to_numpy": 1.330210138397345e-05, "normalize_and_clip_actions": 9.620037477949835e-06, "listify_data_for_vector_env": 1.1317743228237577e-05, "get_actions": 4.129085321489096e-05, "un_batch_to_individual_items": 5.487473771556527e-06, "remove_single_ts_time_rank_from_batch": 6.040301802710741e-07}}}, "num_env_steps_sampled": 5000.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.762419416870289e-06, "numpy_to_tensor": 8.696555170010867e-06, "batch_individual_items": 6.3994473280145646e-06, "add_time_dim_to_batch_and_zero_pad": 2.3914796730252765e-06, "add_observations_from_episodes_to_batch": 3.105023095244439e-06}}, "connector_pipeline_timer": 4.419609146870303e-05}, "env_step_timer": 1.4198481301330097e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "time_between_sampling": 0.0019760661941810487, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "episode_return_mean": -0.3400000000000001, "episode_duration_sec_mean": 0.004672269779257478, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_mean": 20.0, "num_episodes": 250.0, "weights_seq_no": 3.0, "agent_episode_returns_mean": {"default_agent": -0.3400000000000001}, "episode_return_max": 9.5, "sample": 0.00502690583845272, "num_episodes_lifetime": -61250.0, "env_reset_timer": 3.966968977498335e-05, "module_episode_returns_mean": {"default_policy": -0.3400000000000001}, "episode_return_min": -10.5, "rlmodule_inference_timer": 2.8929525054736272e-05, "num_env_steps_sampled_lifetime": -1225000.0, "num_env_steps_sampled_lifetime_throughput": 3609.5859040433015}, "learners": {"__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.08114062167930905, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.007494516299706534, "add_time_dim_to_batch_and_zero_pad": 1.079276136390399e-05, "add_observations_from_episodes_to_batch": 0.0007741142825626303, "add_columns_from_episodes_to_train_batch": 0.03330754876944853, "add_states_from_episodes_to_batch": 3.224219008698128e-06, "numpy_to_tensor": 5.815692166634836e-05, "batch_individual_items": 0.031967305102306415, "general_advantage_estimation": 0.007411135623836658}}}, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 24000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 126000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1941909.2219703004, "num_module_steps_trained_throughput": 371155.00275750057, "num_module_steps_trained_lifetime_throughput": 370591.30980007944}, "default_policy": {"curr_kl_coeff": 0.04665601998567581, "num_trainable_parameters": 6003, "mean_kl_loss": 0.0008237484726123512, "weights_seq_no": 4.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "gradients_default_optimizer_global_norm": 0.021336890757083893, "module_train_batch_size_mean": 1000.0, "total_loss": 0.10854453593492508, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.010156989097595215, "entropy": 0.6889801025390625, "policy_loss": 0.04596720635890961, "num_module_steps_trained_lifetime": 24000, "curr_entropy_coeff": 0.0090570820258, "vf_loss_unclipped": 28.70688247680664, "num_module_steps_trained_lifetime_throughput": 371958.4466467425}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_return_min": -14.5, "num_env_steps_sampled_lifetime": 20400, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.6738425459658137e-05, "un_batch_to_individual_items": 6.170149664799131e-06, "remove_single_ts_time_rank_from_batch": 7.581698539875107e-07, "normalize_and_clip_actions": 1.110486171280992e-05, "listify_data_for_vector_env": 1.3268351360766527e-05, "get_actions": 4.876071944405597e-05}}, "connector_pipeline_timer": 0.0001269504830307492}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368237912813044, "episode_return_mean": -1.05, "episode_duration_sec_mean": 0.005137432810442988, "env_reset_timer": 0.00044055453641351773, "module_episode_returns_mean": {"default_policy": -1.05}, "env_to_module_connector": {"connector_pipeline_timer": 5.037537312178203e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7551191120316225e-06, "numpy_to_tensor": 1.1306411420405961e-05, "batch_individual_items": 7.635308900136446e-06, "add_time_dim_to_batch_and_zero_pad": 2.5678792701302038e-06, "add_observations_from_episodes_to_batch": 3.225454825547472e-06}}}, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_max": 13.5, "num_episodes_lifetime": 80, "rlmodule_inference_timer": 3.4027991820295474e-05, "env_to_module_sum_episodes_length_in": 10.368237912813044, "episode_len_mean": 20.0, "sample": 0.10453813495266892, "weights_seq_no": 4.0, "episode_len_max": 20, "env_step_timer": 1.6994305357979777e-05, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": -1.05}, "time_between_sampling": 1.6609725389723666}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "50370_00000", "date": "2025-08-11_19-19-30", "timestamp": 1754932770, "time_this_iter_s": 1.7999780178070068, "time_total_s": 6.962666034698486, "pid": 14120, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x156df18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6.962666034698486, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 27.55, "ram_util_percent": 83.55}}
{"timers": {"training_iteration": 1.6403135013235162, "restore_env_runners": 1.5225419289463894e-05, "training_step": 1.6401795204460803, "env_runner_sampling_timer": 1.5272545091284824, "learner_update_timer": 0.10967783233062586, "synch_weights": 0.0007254105727065715, "restore_eval_env_runners": 7.757238434394821e-06, "evaluation_iteration": 0.11730240321034763, "synch_eval_env_connectors": 0.00013150177523936146, "synch_env_connectors": 4.606584839639255e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.00010561031722133531, "timers": {"connectors": {"tensor_to_numpy": 1.3142133006617426e-05, "normalize_and_clip_actions": 9.452751016615511e-06, "listify_data_for_vector_env": 1.1089917518233905e-05, "get_actions": 4.0403387629917076e-05, "un_batch_to_individual_items": 5.3798445385883585e-06, "remove_single_ts_time_rank_from_batch": 5.998197840704129e-07}}}, "num_env_steps_sampled": 5000.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.756042035198582e-06, "numpy_to_tensor": 8.558890068207834e-06, "batch_individual_items": 6.324049567197618e-06, "add_time_dim_to_batch_and_zero_pad": 2.3797304464796447e-06, "add_observations_from_episodes_to_batch": 3.0019514566383133e-06}}, "connector_pipeline_timer": 4.372446799157204e-05}, "env_step_timer": 1.3973569453322e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "time_between_sampling": 0.0018344195025356011, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "episode_return_mean": -1.1400000000000001, "episode_duration_sec_mean": 0.004994719028472901, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_mean": 20.0, "num_episodes": 250.0, "weights_seq_no": 4.0, "agent_episode_returns_mean": {"default_agent": -1.1400000000000001}, "episode_return_max": 9.5, "sample": 0.005014625942676606, "num_episodes_lifetime": -92125.0, "env_reset_timer": 3.6700608905699494e-05, "module_episode_returns_mean": {"default_policy": -1.1400000000000001}, "episode_return_min": -10.5, "rlmodule_inference_timer": 4.835135326202824e-05, "num_env_steps_sampled_lifetime": -1842500.0, "num_env_steps_sampled_lifetime_throughput": 3677.477814862148}, "learners": {"__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.0811217454622601, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.007496082796136083, "add_time_dim_to_batch_and_zero_pad": 1.0781493391977855e-05, "add_observations_from_episodes_to_batch": 0.0007744377296658396, "add_columns_from_episodes_to_train_batch": 0.033318419951936094, "add_states_from_episodes_to_batch": 3.2215567877341525e-06, "numpy_to_tensor": 5.822785217945232e-05, "batch_individual_items": 0.03195669080156446, "general_advantage_estimation": 0.007390132597482999}}}, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 30000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 157500, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1949951.8080951856, "num_module_steps_trained_throughput": 372649.16840797436, "num_module_steps_trained_lifetime_throughput": 372099.4818895713}, "default_policy": {"curr_kl_coeff": 0.023328009992837906, "num_trainable_parameters": 6003, "mean_kl_loss": 0.0012158984318375587, "weights_seq_no": 5.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "gradients_default_optimizer_global_norm": 0.02561800181865692, "module_train_batch_size_mean": 1000.0, "total_loss": 0.05677541345357895, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.010284781455993652, "entropy": 0.6833857297897339, "policy_loss": -0.005832438822835684, "num_module_steps_trained_lifetime": 30000, "curr_entropy_coeff": 0.0090570820258, "vf_loss_unclipped": 28.676191329956055, "num_module_steps_trained_lifetime_throughput": 373398.4685933206}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_return_min": -14.5, "num_env_steps_sampled_lifetime": 25400, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3361764324896424e-05, "un_batch_to_individual_items": 5.3815886977151154e-06, "remove_single_ts_time_rank_from_batch": 5.821593715297392e-07, "normalize_and_clip_actions": 9.55297422647338e-06, "listify_data_for_vector_env": 1.1180422101158505e-05, "get_actions": 3.791377786488027e-05}}, "connector_pipeline_timer": 0.00010379605121531326}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238387501162, "episode_return_mean": -0.35, "episode_duration_sec_mean": 0.005047865000087768, "env_reset_timer": 0.0004370898305765574, "module_episode_returns_mean": {"default_policy": -0.35}, "env_to_module_connector": {"connector_pipeline_timer": 4.331416910588858e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 1.5870184073776555e-06, "numpy_to_tensor": 8.705170853076221e-06, "batch_individual_items": 6.211809014175371e-06, "add_time_dim_to_batch_and_zero_pad": 2.2489609437659663e-06, "add_observations_from_episodes_to_batch": 2.8895365830473443e-06}}}, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_max": 13.5, "num_episodes_lifetime": 100, "rlmodule_inference_timer": 2.8125103876524714e-05, "env_to_module_sum_episodes_length_in": 10.368238387501162, "episode_len_mean": 20.0, "sample": 0.10451509485218723, "weights_seq_no": 5.0, "episode_len_max": 20, "env_step_timer": 1.4257803801834928e-05, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": -0.35}, "time_between_sampling": 1.6604918765022876}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "50370_00000", "date": "2025-08-11_19-19-32", "timestamp": 1754932772, "time_this_iter_s": 1.7023649215698242, "time_total_s": 8.66503095626831, "pid": 14120, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x156df18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8.66503095626831, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 49.4, "ram_util_percent": 83.6}}
{"timers": {"training_iteration": 1.639747287980988, "restore_env_runners": 1.5128585774678185e-05, "training_step": 1.639612808572368, "env_runner_sampling_timer": 1.5258606827868177, "learner_update_timer": 0.11049766025777148, "synch_weights": 0.0007326377169433705, "restore_eval_env_runners": 7.748416282508987e-06, "evaluation_iteration": 0.11720199167852802, "synch_eval_env_connectors": 0.00013124342793105403, "synch_env_connectors": 4.6005192958225965e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.0001043194845007614, "timers": {"connectors": {"tensor_to_numpy": 1.2986921013146629e-05, "normalize_and_clip_actions": 9.38133785077364e-06, "listify_data_for_vector_env": 1.1016136907546866e-05, "get_actions": 3.973531271034227e-05, "un_batch_to_individual_items": 5.3311457190386705e-06, "remove_single_ts_time_rank_from_batch": 5.895665895212253e-07}}}, "num_env_steps_sampled": 5000.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.746674345619977e-06, "numpy_to_tensor": 8.504785021073127e-06, "batch_individual_items": 6.2179179973760904e-06, "add_time_dim_to_batch_and_zero_pad": 2.353303157219146e-06, "add_observations_from_episodes_to_batch": 2.9723810992665484e-06}}, "connector_pipeline_timer": 4.332219462778028e-05}, "env_step_timer": 1.3806804765770999e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "time_between_sampling": 0.0015470551905653065, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "episode_return_mean": 0.54, "episode_duration_sec_mean": 0.004557183209806681, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_mean": 20.0, "num_episodes": 250.0, "weights_seq_no": 5.0, "agent_episode_returns_mean": {"default_agent": 0.54}, "episode_return_max": 9.5, "sample": 0.005189851526565183, "num_episodes_lifetime": -123000.0, "env_reset_timer": 3.654990289144777e-05, "module_episode_returns_mean": {"default_policy": 0.54}, "episode_return_min": -10.5, "rlmodule_inference_timer": 2.850832070634706e-05, "num_env_steps_sampled_lifetime": -2460000.0, "num_env_steps_sampled_lifetime_throughput": 3702.2104347319428}, "learners": {"__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.08205247841712439, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.007497644047936793, "add_time_dim_to_batch_and_zero_pad": 1.0784508172743755e-05, "add_observations_from_episodes_to_batch": 0.0007753721018056937, "add_columns_from_episodes_to_train_batch": 0.03332378908234644, "add_states_from_episodes_to_batch": 3.2180911477351906e-06, "numpy_to_tensor": 5.8407232542242696e-05, "batch_individual_items": 0.03288466681313988, "general_advantage_estimation": 0.007384890860668403}}}, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 36000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 189000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1952760.8397384111, "num_module_steps_trained_throughput": 373143.2142536253, "num_module_steps_trained_lifetime_throughput": 372609.07885113184}, "default_policy": {"curr_kl_coeff": 0.011664004996418953, "num_trainable_parameters": 6003, "mean_kl_loss": 0.0007163780392147601, "weights_seq_no": 6.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "gradients_default_optimizer_global_norm": 0.013501612469553947, "module_train_batch_size_mean": 1000.0, "total_loss": 0.20164747536182404, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.010419487953186035, "entropy": 0.6760303974151611, "policy_loss": 0.13901302218437195, "num_module_steps_trained_lifetime": 36000, "curr_entropy_coeff": 0.0090570820258, "vf_loss_unclipped": 28.676469802856445, "num_module_steps_trained_lifetime_throughput": 373835.1185423621}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_return_min": -14.5, "num_env_steps_sampled_lifetime": 30400, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3624930017155591e-05, "un_batch_to_individual_items": 5.420515069528096e-06, "remove_single_ts_time_rank_from_batch": 5.776319298761039e-07, "normalize_and_clip_actions": 9.617419951379076e-06, "listify_data_for_vector_env": 1.109780081461444e-05, "get_actions": 3.834876642065289e-05}}, "connector_pipeline_timer": 0.00010493687773725053}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394470474, "episode_return_mean": -0.35, "episode_duration_sec_mean": 0.005040249620797113, "env_reset_timer": 0.0004334418516287324, "module_episode_returns_mean": {"default_policy": -0.35}, "env_to_module_connector": {"connector_pipeline_timer": 4.451959547408803e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 1.6338149113983769e-06, "numpy_to_tensor": 8.819836990436593e-06, "batch_individual_items": 6.3022250995708656e-06, "add_time_dim_to_batch_and_zero_pad": 2.257692889746249e-06, "add_observations_from_episodes_to_batch": 2.9189964387281658e-06}}}, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_max": 13.5, "num_episodes_lifetime": 120, "rlmodule_inference_timer": 2.832277887918119e-05, "env_to_module_sum_episodes_length_in": 10.368238394470474, "episode_len_mean": 20.0, "sample": 0.10448830390470039, "weights_seq_no": 6.0, "episode_len_max": 20, "env_step_timer": 1.4382282215015163e-05, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": -0.35}, "time_between_sampling": 1.6598898314865043}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "50370_00000", "date": "2025-08-11_19-19-34", "timestamp": 1754932774, "time_this_iter_s": 1.692779779434204, "time_total_s": 10.357810735702515, "pid": 14120, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x156df18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10.357810735702515, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 48.55, "ram_util_percent": 83.1}}
{"timers": {"training_iteration": 1.6386548821819495, "restore_env_runners": 1.5035209554620993e-05, "training_step": 1.63851954256576, "env_runner_sampling_timer": 1.5245685147094532, "learner_update_timer": 0.1106793490752417, "synch_weights": 0.0007384325898594694, "restore_eval_env_runners": 7.739681187988794e-06, "evaluation_iteration": 0.11709919801156235, "synch_eval_env_connectors": 0.00013096182338684376, "synch_env_connectors": 4.594933502602682e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.00010414677059358177, "timers": {"connectors": {"tensor_to_numpy": 1.3009571492837812e-05, "normalize_and_clip_actions": 9.403140263734653e-06, "listify_data_for_vector_env": 1.107856828957185e-05, "get_actions": 3.928363904577465e-05, "un_batch_to_individual_items": 5.365432282482143e-06, "remove_single_ts_time_rank_from_batch": 5.948437596813218e-07}}}, "num_env_steps_sampled": 5000.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.749478399586826e-06, "numpy_to_tensor": 8.529984904683791e-06, "batch_individual_items": 6.329621096684594e-06, "add_time_dim_to_batch_and_zero_pad": 2.371525029608926e-06, "add_observations_from_episodes_to_batch": 3.006016624709347e-06}}, "connector_pipeline_timer": 4.36269624738316e-05}, "env_step_timer": 1.39063953012461e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "time_between_sampling": 0.0018973856808266545, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "episode_return_mean": 2.0599999999999996, "episode_duration_sec_mean": 0.004575909791979937, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_mean": 20.0, "num_episodes": 250.0, "weights_seq_no": 6.0, "agent_episode_returns_mean": {"default_agent": 2.0599999999999996}, "episode_return_max": 9.5, "sample": 0.004900883833482663, "num_episodes_lifetime": -153875.0, "env_reset_timer": 3.50501326494065e-05, "module_episode_returns_mean": {"default_policy": 2.0599999999999996}, "episode_return_min": -10.5, "rlmodule_inference_timer": 2.8185886255387473e-05, "num_env_steps_sampled_lifetime": -3077500.0, "num_env_steps_sampled_lifetime_throughput": 3710.408933208521}, "learners": {"__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.0821904173839656, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.007563887608262758, "add_time_dim_to_batch_and_zero_pad": 1.079124254321804e-05, "add_observations_from_episodes_to_batch": 0.0007788492101923037, "add_columns_from_episodes_to_train_batch": 0.03341594161223737, "add_states_from_episodes_to_batch": 3.2204902434533115e-06, "numpy_to_tensor": 5.852233084910813e-05, "batch_individual_items": 0.03287812681572266, "general_advantage_estimation": 0.007366785282220012}}}, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 42000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 220500, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1945194.399383287, "num_module_steps_trained_throughput": 371669.31522587436, "num_module_steps_trained_lifetime_throughput": 371149.84284739546}, "default_policy": {"curr_kl_coeff": 0.0058320024982094765, "num_trainable_parameters": 6003, "mean_kl_loss": 0.00041595392394810915, "weights_seq_no": 7.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "gradients_default_optimizer_global_norm": 0.058202605694532394, "module_train_batch_size_mean": 1000.0, "total_loss": 0.027804788202047348, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.010401129722595215, "entropy": 0.6714522838592529, "policy_loss": -0.034859273582696915, "num_module_steps_trained_lifetime": 42000, "curr_entropy_coeff": 0.0090570820258, "vf_loss_unclipped": 28.562328338623047, "num_module_steps_trained_lifetime_throughput": 372306.2209037617}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_return_min": -14.5, "num_env_steps_sampled_lifetime": 35400, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.6211333412937647e-05, "un_batch_to_individual_items": 6.191668643985043e-06, "remove_single_ts_time_rank_from_batch": 6.679629730679708e-07, "normalize_and_clip_actions": 1.1180840045751718e-05, "listify_data_for_vector_env": 1.3582345061021338e-05, "get_actions": 4.8583487428620726e-05}}, "connector_pipeline_timer": 0.00012861409351175968}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394572801, "episode_return_mean": -0.15, "episode_duration_sec_mean": 0.005157631711335852, "env_reset_timer": 0.00043044368310097116, "module_episode_returns_mean": {"default_policy": -0.15}, "env_to_module_connector": {"connector_pipeline_timer": 5.0852688163870886e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7462465778723992e-06, "numpy_to_tensor": 1.1077870777938676e-05, "batch_individual_items": 7.316257248184324e-06, "add_time_dim_to_batch_and_zero_pad": 2.97012443430161e-06, "add_observations_from_episodes_to_batch": 3.569609834864529e-06}}}, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_max": 13.5, "num_episodes_lifetime": 140, "rlmodule_inference_timer": 3.587893815751297e-05, "env_to_module_sum_episodes_length_in": 10.368238394572801, "episode_len_mean": 20.0, "sample": 0.1045850275257475, "weights_seq_no": 7.0, "episode_len_max": 20, "env_step_timer": 1.7991228132840958e-05, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": -0.15}, "time_between_sampling": 1.6588044756721967}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "50370_00000", "date": "2025-08-11_19-19-35", "timestamp": 1754932775, "time_this_iter_s": 1.6544067859649658, "time_total_s": 12.01221752166748, "pid": 14120, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x156df18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12.01221752166748, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 48.03333333333333, "ram_util_percent": 83.16666666666667}}
{"timers": {"training_iteration": 1.6394333504403904, "restore_env_runners": 1.494860765346043e-05, "training_step": 1.6392974325607184, "env_runner_sampling_timer": 1.5253994345621933, "learner_update_timer": 0.110621498504077, "synch_weights": 0.0007421736734708614, "restore_eval_env_runners": 7.758534235888979e-06, "evaluation_iteration": 0.1171400977016924, "synch_eval_env_connectors": 0.00013093262584561288, "synch_env_connectors": 4.587324389667138e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.00011036068702437457, "timers": {"connectors": {"tensor_to_numpy": 1.3605995382755062e-05, "normalize_and_clip_actions": 9.88112001126942e-06, "listify_data_for_vector_env": 1.1519909403004999e-05, "get_actions": 4.2982314644230846e-05, "un_batch_to_individual_items": 5.589238105149631e-06, "remove_single_ts_time_rank_from_batch": 6.127959887070041e-07}}}, "num_env_steps_sampled": 5000.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.779618139118522e-06, "numpy_to_tensor": 9.118890297418388e-06, "batch_individual_items": 6.53618761753842e-06, "add_time_dim_to_batch_and_zero_pad": 2.482344564358337e-06, "add_observations_from_episodes_to_batch": 3.1721389480977263e-06}}, "connector_pipeline_timer": 4.525127320512787e-05}, "env_step_timer": 1.4772567424308635e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "time_between_sampling": 0.0017851512866606347, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "episode_return_mean": 1.6599999999999997, "episode_duration_sec_mean": 0.005392172667663545, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_mean": 20.0, "num_episodes": 250.0, "weights_seq_no": 7.0, "agent_episode_returns_mean": {"default_agent": 1.6599999999999997}, "episode_return_max": 9.5, "sample": 0.005455770980917325, "num_episodes_lifetime": -184750.0, "env_reset_timer": 3.7954828251817076e-05, "module_episode_returns_mean": {"default_policy": 1.6599999999999997}, "episode_return_min": -10.5, "rlmodule_inference_timer": 5.622180004821731e-05, "num_env_steps_sampled_lifetime": -3695000.0, "num_env_steps_sampled_lifetime_throughput": 3554.560561462792}, "learners": {"__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.08226827196000024, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.007567892902071383, "add_time_dim_to_batch_and_zero_pad": 1.089333055267625e-05, "add_observations_from_episodes_to_batch": 0.000782356138208057, "add_columns_from_episodes_to_train_batch": 0.033503361366621444, "add_states_from_episodes_to_batch": 3.227445126974923e-06, "numpy_to_tensor": 5.9306266976470415e-05, "batch_individual_items": 0.0328667609575197, "general_advantage_estimation": 0.007359691589407434}}}, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 48000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 252000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1943194.9070203512, "num_module_steps_trained_throughput": 371252.0047359585, "num_module_steps_trained_lifetime_throughput": 370747.86113785073}, "default_policy": {"curr_kl_coeff": 0.0029160012491047382, "num_trainable_parameters": 6003, "mean_kl_loss": 0.0010036317398771644, "weights_seq_no": 8.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "gradients_default_optimizer_global_norm": 0.019486667588353157, "module_train_batch_size_mean": 1000.0, "total_loss": 0.06938596069812775, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.010833382606506348, "entropy": 0.6594521403312683, "policy_loss": 0.006612226366996765, "num_module_steps_trained_lifetime": 48000, "curr_entropy_coeff": 0.0090570820258, "vf_loss_unclipped": 28.607404708862305, "num_module_steps_trained_lifetime_throughput": 371833.2658288892}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_return_min": -14.5, "num_env_steps_sampled_lifetime": 40400, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3225549060797121e-05, "un_batch_to_individual_items": 5.300773988836956e-06, "remove_single_ts_time_rank_from_batch": 5.7690402417706e-07, "normalize_and_clip_actions": 9.524260097105145e-06, "listify_data_for_vector_env": 1.1200565108426111e-05, "get_actions": 3.7311128079556844e-05}}, "connector_pipeline_timer": 0.00010292576451367719}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.3682383945743, "episode_return_mean": -0.35, "episode_duration_sec_mean": 0.005152905050199479, "env_reset_timer": 0.0004271704962643735, "module_episode_returns_mean": {"default_policy": -0.35}, "env_to_module_connector": {"connector_pipeline_timer": 4.326153443116552e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 1.5820861080098708e-06, "numpy_to_tensor": 8.595310274171691e-06, "batch_individual_items": 6.227313191305645e-06, "add_time_dim_to_batch_and_zero_pad": 2.22326642403847e-06, "add_observations_from_episodes_to_batch": 2.849730476426041e-06}}}, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_max": 13.5, "num_episodes_lifetime": 160, "rlmodule_inference_timer": 2.7817622098017683e-05, "env_to_module_sum_episodes_length_in": 10.3682383945743, "episode_len_mean": 20.0, "sample": 0.10457756391973279, "weights_seq_no": 8.0, "episode_len_max": 20, "env_step_timer": 1.3997540804197326e-05, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": -0.35}, "time_between_sampling": 1.6595847934148757}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "50370_00000", "date": "2025-08-11_19-19-37", "timestamp": 1754932777, "time_this_iter_s": 1.83064603805542, "time_total_s": 13.8428635597229, "pid": 14120, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x156df18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13.8428635597229, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 49.7, "ram_util_percent": 83.45}}
{"timers": {"training_iteration": 1.639733997355693, "restore_env_runners": 1.487537128441603e-05, "training_step": 1.639597426575469, "env_runner_sampling_timer": 1.5246359189666567, "learner_update_timer": 0.111686016018835, "synch_weights": 0.0007407852772051555, "restore_eval_env_runners": 7.80927932354601e-06, "evaluation_iteration": 0.11708767797384026, "synch_eval_env_connectors": 0.00013069913897813495, "synch_env_connectors": 4.6081210364275344e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.00010978872997083835, "timers": {"connectors": {"tensor_to_numpy": 1.3638980702556844e-05, "normalize_and_clip_actions": 9.748379102889037e-06, "listify_data_for_vector_env": 1.150127244942367e-05, "get_actions": 4.256305388116369e-05, "un_batch_to_individual_items": 5.514358054766602e-06, "remove_single_ts_time_rank_from_batch": 6.047433152515719e-07}}}, "num_env_steps_sampled": 5000.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7730146923843286e-06, "numpy_to_tensor": 8.906080165029855e-06, "batch_individual_items": 6.4655722351300515e-06, "add_time_dim_to_batch_and_zero_pad": 2.465630999965204e-06, "add_observations_from_episodes_to_batch": 3.0808981356941377e-06}}, "connector_pipeline_timer": 4.483007634342811e-05}, "env_step_timer": 1.451064648855046e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "time_between_sampling": 0.0016498209934020873, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "episode_return_mean": 2.379999999999999, "episode_duration_sec_mean": 0.004772382121067495, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_mean": 20.0, "num_episodes": 250.0, "weights_seq_no": 8.0, "agent_episode_returns_mean": {"default_agent": 2.379999999999999}, "episode_return_max": 9.5, "sample": 0.005319428971641992, "num_episodes_lifetime": -215625.0, "env_reset_timer": 4.411353292825643e-05, "module_episode_returns_mean": {"default_policy": 2.379999999999999}, "episode_return_min": -10.5, "rlmodule_inference_timer": 2.993916253330954e-05, "num_env_steps_sampled_lifetime": -4312500.0, "num_env_steps_sampled_lifetime_throughput": 3536.6513093697818}, "learners": {"__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.08345229340972575, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.0087874764736944, "add_time_dim_to_batch_and_zero_pad": 1.0903146696179052e-05, "add_observations_from_episodes_to_batch": 0.0007830825767373145, "add_columns_from_episodes_to_train_batch": 0.03351186150264737, "add_states_from_episodes_to_batch": 3.22892064165602e-06, "numpy_to_tensor": 5.9355703960328225e-05, "batch_individual_items": 0.03283958292766864, "general_advantage_estimation": 0.007342064253357164}}}, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 54000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 283500, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1942032.7851420594, "num_module_steps_trained_throughput": 370991.2744814342, "num_module_steps_trained_lifetime_throughput": 370504.0291527034}, "default_policy": {"curr_kl_coeff": 0.0014580006245523691, "num_trainable_parameters": 6003, "mean_kl_loss": 0.000535716419108212, "weights_seq_no": 9.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "gradients_default_optimizer_global_norm": 0.05511411279439926, "module_train_batch_size_mean": 1000.0, "total_loss": -0.021834900602698326, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.010897278785705566, "entropy": 0.6498231291770935, "policy_loss": -0.08469157665967941, "num_module_steps_trained_lifetime": 54000, "curr_entropy_coeff": 0.0090570820258, "vf_loss_unclipped": 28.564573287963867, "num_module_steps_trained_lifetime_throughput": 371522.54376206396}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_return_min": -14.5, "num_env_steps_sampled_lifetime": 45400, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3615516030137284e-05, "un_batch_to_individual_items": 5.521651221967127e-06, "remove_single_ts_time_rank_from_batch": 5.862647260852512e-07, "normalize_and_clip_actions": 9.837663715086401e-06, "listify_data_for_vector_env": 1.1388753759940853e-05, "get_actions": 3.877458402566035e-05}}, "connector_pipeline_timer": 0.00010580227017863816}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_return_mean": 0.65, "episode_duration_sec_mean": 0.004810893782414496, "env_reset_timer": 0.0004241158808951403, "module_episode_returns_mean": {"default_policy": 0.65}, "env_to_module_connector": {"connector_pipeline_timer": 4.3848538275069094e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 1.612440402517369e-06, "numpy_to_tensor": 8.829652837249612e-06, "batch_individual_items": 6.4062787275766266e-06, "add_time_dim_to_batch_and_zero_pad": 2.350570282417229e-06, "add_observations_from_episodes_to_batch": 2.948572979913644e-06}}}, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_max": 13.5, "num_episodes_lifetime": 180, "rlmodule_inference_timer": 2.8974515180073587e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "sample": 0.10458509286080857, "weights_seq_no": 9.0, "episode_len_max": 20, "env_step_timer": 1.4867043617036793e-05, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": 0.65}, "time_between_sampling": 1.659901726310898}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "50370_00000", "date": "2025-08-11_19-19-39", "timestamp": 1754932779, "time_this_iter_s": 1.7827210426330566, "time_total_s": 15.625584602355957, "pid": 14120, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x156df18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15.625584602355957, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 56.666666666666664, "ram_util_percent": 83.66666666666667}}
{"timers": {"training_iteration": 1.639970806973109, "restore_env_runners": 1.4788287424156471e-05, "training_step": 1.639833805230429, "env_runner_sampling_timer": 1.524108598106776, "learner_update_timer": 0.11245162043818603, "synch_weights": 0.0007388990951154597, "restore_eval_env_runners": 7.841186203751602e-06, "evaluation_iteration": 0.11702717827414191, "synch_eval_env_connectors": 0.0001305008975908123, "synch_env_connectors": 4.601208925245149e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.00011148908504055782, "timers": {"connectors": {"tensor_to_numpy": 1.3759179138692173e-05, "normalize_and_clip_actions": 9.89205052492056e-06, "listify_data_for_vector_env": 1.1606919345402383e-05, "get_actions": 4.3667060638304355e-05, "un_batch_to_individual_items": 5.554189759830473e-06, "remove_single_ts_time_rank_from_batch": 6.200853323695526e-07}}}, "num_env_steps_sampled": 5000.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.798027563112681e-06, "numpy_to_tensor": 9.099944539672017e-06, "batch_individual_items": 6.549328440527984e-06, "add_time_dim_to_batch_and_zero_pad": 2.485820843107455e-06, "add_observations_from_episodes_to_batch": 3.1620552133584748e-06}}, "connector_pipeline_timer": 4.529498271729775e-05}, "env_step_timer": 1.4769540540829931e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "time_between_sampling": 0.0020175450811016895, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "episode_return_mean": 2.460000000000001, "episode_duration_sec_mean": 0.0048467628257349155, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_mean": 20.0, "num_episodes": 250.0, "weights_seq_no": 9.0, "agent_episode_returns_mean": {"default_agent": 2.460000000000001}, "episode_return_max": 9.5, "sample": 0.005122536248871786, "num_episodes_lifetime": -246500.0, "env_reset_timer": 4.157967525052844e-05, "module_episode_returns_mean": {"default_policy": 2.460000000000001}, "episode_return_min": -10.5, "rlmodule_inference_timer": 3.0177516300094758e-05, "num_env_steps_sampled_lifetime": -4930000.0, "num_env_steps_sampled_lifetime_throughput": 3533.0061935884505}, "learners": {"__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.08436358463630517, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008778289209166073, "add_time_dim_to_batch_and_zero_pad": 1.0916614415762871e-05, "add_observations_from_episodes_to_batch": 0.0007838150815997819, "add_columns_from_episodes_to_train_batch": 0.03353089330721003, "add_states_from_episodes_to_batch": 3.227881964230682e-06, "numpy_to_tensor": 5.940797721670492e-05, "batch_individual_items": 0.03376106626860113, "general_advantage_estimation": 0.00732135861058875}}}, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 60000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 315000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1945636.5840263332, "num_module_steps_trained_throughput": 371638.51806780766, "num_module_steps_trained_lifetime_throughput": 371167.23417957075}, "default_policy": {"curr_kl_coeff": 0.0007290003122761846, "num_trainable_parameters": 6003, "mean_kl_loss": 0.0009032915695570409, "weights_seq_no": 10.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "gradients_default_optimizer_global_norm": 0.012517706491053104, "module_train_batch_size_mean": 1000.0, "total_loss": -0.09232137352228165, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.010891318321228027, "entropy": 0.6338445544242859, "policy_loss": -0.15532250702381134, "num_module_steps_trained_lifetime": 60000, "curr_entropy_coeff": 0.0090570820258, "vf_loss_unclipped": 28.557741165161133, "num_module_steps_trained_lifetime_throughput": 372116.64198359236}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_return_min": -14.5, "num_env_steps_sampled_lifetime": 50400, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.2791015343870006e-05, "un_batch_to_individual_items": 5.245231088567002e-06, "remove_single_ts_time_rank_from_batch": 5.789987987180673e-07, "normalize_and_clip_actions": 9.334773326881526e-06, "listify_data_for_vector_env": 1.0884654723690068e-05, "get_actions": 3.557394556242588e-05}}, "connector_pipeline_timer": 0.00010000240080066299}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_return_mean": -0.35, "episode_duration_sec_mean": 0.004765390041284263, "env_reset_timer": 0.0004207134723610408, "module_episode_returns_mean": {"default_policy": -0.35}, "env_to_module_connector": {"connector_pipeline_timer": 4.2379028517010905e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 1.5781090696685988e-06, "numpy_to_tensor": 8.262299148630988e-06, "batch_individual_items": 6.075393882078304e-06, "add_time_dim_to_batch_and_zero_pad": 2.180155738569523e-06, "add_observations_from_episodes_to_batch": 2.816805912222162e-06}}}, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_max": 13.5, "num_episodes_lifetime": 200, "rlmodule_inference_timer": 2.6816759238892448e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "sample": 0.10451148360186092, "weights_seq_no": 10.0, "episode_len_max": 20, "env_step_timer": 1.3668421595967557e-05, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": -0.35}, "time_between_sampling": 1.6601280423878824}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "50370_00000", "date": "2025-08-11_19-19-41", "timestamp": 1754932781, "time_this_iter_s": 1.7680938243865967, "time_total_s": 17.393678426742554, "pid": 14120, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x156df18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 17.393678426742554, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 52.35, "ram_util_percent": 83.65}}
{"timers": {"training_iteration": 1.6382114047337764, "restore_env_runners": 1.4697063887048075e-05, "training_step": 1.6380741600882094, "env_runner_sampling_timer": 1.5225557008750736, "learner_update_timer": 0.11224500756421407, "synch_weights": 0.0007371909332180498, "restore_eval_env_runners": 7.829023973059358e-06, "evaluation_iteration": 0.11688137315127423, "synch_eval_env_connectors": 0.0001300850490524136, "synch_env_connectors": 4.592697703612808e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.00010291533182472113, "timers": {"connectors": {"tensor_to_numpy": 1.2893965256764512e-05, "normalize_and_clip_actions": 9.334248207336258e-06, "listify_data_for_vector_env": 1.0984764277917482e-05, "get_actions": 3.8536068458936584e-05, "un_batch_to_individual_items": 5.320920832435576e-06, "remove_single_ts_time_rank_from_batch": 5.910312193687724e-07}}}, "num_env_steps_sampled": 5000.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7539170511259821e-06, "numpy_to_tensor": 8.40488731498507e-06, "batch_individual_items": 6.234832118886764e-06, "add_time_dim_to_batch_and_zero_pad": 2.3601241942079326e-06, "add_observations_from_episodes_to_batch": 2.9815320950827147e-06}}, "connector_pipeline_timer": 4.32243963373267e-05}, "env_step_timer": 1.37181366357705e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "time_between_sampling": 0.0018875075841032261, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "episode_return_mean": 2.8600000000000008, "episode_duration_sec_mean": 0.00452983567211777, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_mean": 20.0, "num_episodes": 250.0, "weights_seq_no": 10.0, "agent_episode_returns_mean": {"default_agent": 2.8600000000000008}, "episode_return_max": 9.5, "sample": 0.0050037438102995165, "num_episodes_lifetime": -277375.0, "env_reset_timer": 3.739081472916723e-05, "module_episode_returns_mean": {"default_policy": 2.8600000000000008}, "episode_return_min": -10.5, "rlmodule_inference_timer": 2.85090477731013e-05, "num_env_steps_sampled_lifetime": -5547500.0, "num_env_steps_sampled_lifetime_throughput": 3724.6566660151016}, "learners": {"__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.08429937253971494, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008764988406914288, "add_time_dim_to_batch_and_zero_pad": 1.0908698169457781e-05, "add_observations_from_episodes_to_batch": 0.0007849494310018626, "add_columns_from_episodes_to_train_batch": 0.033539671454003786, "add_states_from_episodes_to_batch": 3.223102771910334e-06, "numpy_to_tensor": 5.9473477554178823e-05, "batch_individual_items": 0.03372062227612205, "general_advantage_estimation": 0.007301123354541839}}}, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 66000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 346500, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1951683.6436992, "num_module_steps_trained_throughput": 372751.5881115972, "num_module_steps_trained_lifetime_throughput": 372295.41898997256}, "default_policy": {"curr_kl_coeff": 0.0003645001561380923, "num_trainable_parameters": 6003, "mean_kl_loss": 0.0006507525686174631, "weights_seq_no": 11.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "gradients_default_optimizer_global_norm": 0.01735222153365612, "module_train_batch_size_mean": 1000.0, "total_loss": 0.04307083040475845, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.0113600492477417, "entropy": 0.6183834671974182, "policy_loss": -0.020069513469934464, "num_module_steps_trained_lifetime": 66000, "curr_entropy_coeff": 0.0090570820258, "vf_loss_unclipped": 28.637535095214844, "num_module_steps_trained_lifetime_throughput": 373176.2952900119}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_return_min": -14.5, "num_env_steps_sampled_lifetime": 55400, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.2801988534961582e-05, "un_batch_to_individual_items": 5.23921846457232e-06, "remove_single_ts_time_rank_from_batch": 5.739577213304572e-07, "normalize_and_clip_actions": 9.341007886552291e-06, "listify_data_for_vector_env": 1.0721132130905707e-05, "get_actions": 3.576486471514243e-05}}, "connector_pipeline_timer": 9.959279230759702e-05}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_return_mean": -0.15, "episode_duration_sec_mean": 0.004719777114223689, "env_reset_timer": 0.0004172492571476608, "module_episode_returns_mean": {"default_policy": -0.15}, "env_to_module_connector": {"connector_pipeline_timer": 4.194009748622903e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 1.5627105251504198e-06, "numpy_to_tensor": 8.174325116613217e-06, "batch_individual_items": 6.017770195429032e-06, "add_time_dim_to_batch_and_zero_pad": 2.1931224222015155e-06, "add_observations_from_episodes_to_batch": 2.775994469007418e-06}}}, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_max": 13.5, "num_episodes_lifetime": 220, "rlmodule_inference_timer": 2.6898725169298768e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "sample": 0.1044339400157725, "weights_seq_no": 11.0, "episode_len_max": 20, "env_step_timer": 1.3572976643645096e-05, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": -0.15}, "time_between_sampling": 1.658342808623838}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "50370_00000", "date": "2025-08-11_19-19-42", "timestamp": 1754932782, "time_this_iter_s": 1.568037748336792, "time_total_s": 18.961716175079346, "pid": 14120, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x156df18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 18.961716175079346, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 44.4, "ram_util_percent": 83.7}}
{"timers": {"training_iteration": 1.6373344127666511, "restore_env_runners": 1.4623842354554958e-05, "training_step": 1.6371967551581357, "env_runner_sampling_timer": 1.5218583297067863, "learner_update_timer": 0.11206600873877674, "synch_weights": 0.0007359669438070738, "restore_eval_env_runners": 7.832813520136063e-06, "evaluation_iteration": 0.11672988149904001, "synch_eval_env_connectors": 0.00013007085795162373, "synch_env_connectors": 4.586771031156414e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.00010316511109553927, "timers": {"connectors": {"tensor_to_numpy": 1.2880619948272592e-05, "normalize_and_clip_actions": 9.298370378299995e-06, "listify_data_for_vector_env": 1.09854998981338e-05, "get_actions": 3.876722703634894e-05, "un_batch_to_individual_items": 5.333874187570826e-06, "remove_single_ts_time_rank_from_batch": 5.942622945197694e-07}}}, "num_env_steps_sampled": 5000.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7538922844299228e-06, "numpy_to_tensor": 8.41680483522802e-06, "batch_individual_items": 6.229233617187259e-06, "add_time_dim_to_batch_and_zero_pad": 2.3614104600522892e-06, "add_observations_from_episodes_to_batch": 3.019051119754989e-06}}, "connector_pipeline_timer": 4.332721739145148e-05}, "env_step_timer": 1.3715596565358766e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "time_between_sampling": 0.0017855504970336685, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "episode_return_mean": 4.380000000000001, "episode_duration_sec_mean": 0.0045278095300309365, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_mean": 20.0, "num_episodes": 250.0, "weights_seq_no": 11.0, "agent_episode_returns_mean": {"default_agent": 4.380000000000001}, "episode_return_max": 9.5, "sample": 0.004844009798544067, "num_episodes_lifetime": -308250.0, "env_reset_timer": 3.258247757126414e-05, "module_episode_returns_mean": {"default_policy": 4.380000000000001}, "episode_return_min": -10.5, "rlmodule_inference_timer": 2.78908867593311e-05, "num_env_steps_sampled_lifetime": -6165000.0, "num_env_steps_sampled_lifetime_throughput": 3738.7318720563235}, "learners": {"__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.08426116423450461, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008771743522244703, "add_time_dim_to_batch_and_zero_pad": 1.089294018711864e-05, "add_observations_from_episodes_to_batch": 0.0007855782759876782, "add_columns_from_episodes_to_train_batch": 0.03354759389962901, "add_states_from_episodes_to_batch": 3.220462190693201e-06, "numpy_to_tensor": 5.949832258369826e-05, "batch_individual_items": 0.03368448564269257, "general_advantage_estimation": 0.007283898371155565}}}, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 72000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 378000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1958786.3772249555, "num_module_steps_trained_throughput": 374068.8071895151, "num_module_steps_trained_lifetime_throughput": 373626.51111229777}, "default_policy": {"curr_kl_coeff": 0.00018225007806904614, "num_trainable_parameters": 6003, "mean_kl_loss": 0.0004655509255826473, "weights_seq_no": 12.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "gradients_default_optimizer_global_norm": 0.02542821504175663, "module_train_batch_size_mean": 1000.0, "total_loss": 0.01771397329866886, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.01087331771850586, "entropy": 0.6033130884170532, "policy_loss": -0.04556255415081978, "num_module_steps_trained_lifetime": 72000, "curr_entropy_coeff": 0.0090570820258, "vf_loss_unclipped": 28.60890007019043, "num_module_steps_trained_lifetime_throughput": 374442.5676246148}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_return_min": -14.5, "num_env_steps_sampled_lifetime": 60400, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3697408406077696e-05, "un_batch_to_individual_items": 5.535894976892927e-06, "remove_single_ts_time_rank_from_batch": 5.767337784132987e-07, "normalize_and_clip_actions": 9.733221273487583e-06, "listify_data_for_vector_env": 1.1396071238926383e-05, "get_actions": 3.907570389389139e-05}}, "connector_pipeline_timer": 0.00010596136579609721}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_return_mean": -0.15, "episode_duration_sec_mean": 0.0046063583646900955, "env_reset_timer": 0.0004137963439785416, "module_episode_returns_mean": {"default_policy": -0.15}, "env_to_module_connector": {"connector_pipeline_timer": 4.521013775534156e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 1.6149012231042537e-06, "numpy_to_tensor": 9.097646241617598e-06, "batch_individual_items": 6.714346212564147e-06, "add_time_dim_to_batch_and_zero_pad": 2.2896631175416308e-06, "add_observations_from_episodes_to_batch": 2.9653293889872826e-06}}}, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_max": 13.5, "num_episodes_lifetime": 240, "rlmodule_inference_timer": 2.8603896185541928e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "sample": 0.10439533769631919, "weights_seq_no": 12.0, "episode_len_max": 20, "env_step_timer": 1.4640980568617035e-05, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": -0.15}, "time_between_sampling": 1.6574349284568357}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "50370_00000", "date": "2025-08-11_19-19-44", "timestamp": 1754932784, "time_this_iter_s": 1.6588859558105469, "time_total_s": 20.620602130889893, "pid": 14120, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x156df18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 20.620602130889893, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 41.43333333333334, "ram_util_percent": 83.0}}
{"timers": {"training_iteration": 1.6382689598886413, "restore_env_runners": 1.4606354620337126e-05, "training_step": 1.63812913802599, "env_runner_sampling_timer": 1.5229283355696763, "learner_update_timer": 0.11192335282243633, "synch_weights": 0.0007359951851057279, "restore_eval_env_runners": 7.821565057524602e-06, "evaluation_iteration": 0.11662395143399223, "synch_eval_env_connectors": 0.00013024305930692622, "synch_env_connectors": 4.595903739641985e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.00011248451617089592, "timers": {"connectors": {"tensor_to_numpy": 1.3859727262133024e-05, "normalize_and_clip_actions": 9.977104159894942e-06, "listify_data_for_vector_env": 1.1701995906339611e-05, "get_actions": 4.42012299977773e-05, "un_batch_to_individual_items": 5.634112265555919e-06, "remove_single_ts_time_rank_from_batch": 6.282147360845795e-07}}}, "num_env_steps_sampled": 5000.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.8086112918952172e-06, "numpy_to_tensor": 9.235413806778882e-06, "batch_individual_items": 6.7454690410435975e-06, "add_time_dim_to_batch_and_zero_pad": 2.470919927112989e-06, "add_observations_from_episodes_to_batch": 3.1141200989229087e-06}}, "connector_pipeline_timer": 4.580356788221796e-05}, "env_step_timer": 1.4810166297397785e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "time_between_sampling": 0.001832472282590017, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "episode_return_mean": 3.339999999999999, "episode_duration_sec_mean": 0.0048993248492479324, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_mean": 20.0, "num_episodes": 250.0, "weights_seq_no": 12.0, "agent_episode_returns_mean": {"default_agent": 3.339999999999999}, "episode_return_max": 9.5, "sample": 0.005127604261989292, "num_episodes_lifetime": -339125.0, "env_reset_timer": 3.8735063059508123e-05, "module_episode_returns_mean": {"default_policy": 3.339999999999999}, "episode_return_min": -10.5, "rlmodule_inference_timer": 3.0611848388898015e-05, "num_env_steps_sampled_lifetime": -6782500.0, "num_env_steps_sampled_lifetime_throughput": 3495.5824664005745}, "learners": {"__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.08424055467196306, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008764848166930357, "add_time_dim_to_batch_and_zero_pad": 1.0955681475426324e-05, "add_observations_from_episodes_to_batch": 0.0007899312427679517, "add_columns_from_episodes_to_train_batch": 0.033571391710269204, "add_states_from_episodes_to_batch": 3.2224173166699463e-06, "numpy_to_tensor": 5.976042038928806e-05, "batch_individual_items": 0.033654118696173345, "general_advantage_estimation": 0.007271968137609264}}}, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 78000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 409500, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1963537.020400303, "num_module_steps_trained_throughput": 374938.78916040435, "num_module_steps_trained_lifetime_throughput": 374509.6629450185}, "default_policy": {"curr_kl_coeff": 9.112503903452307e-05, "num_trainable_parameters": 6003, "mean_kl_loss": 0.0013015683507546782, "weights_seq_no": 13.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "gradients_default_optimizer_global_norm": 0.02619677409529686, "module_train_batch_size_mean": 1000.0, "total_loss": 0.023966753855347633, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.011479973793029785, "entropy": 0.5803787112236023, "policy_loss": -0.039517566561698914, "num_module_steps_trained_lifetime": 78000, "curr_entropy_coeff": 0.0090570820258, "vf_loss_unclipped": 28.610172271728516, "num_module_steps_trained_lifetime_throughput": 375262.4991072695}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_return_min": -14.5, "num_env_steps_sampled_lifetime": 65400, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.41678696286395e-05, "un_batch_to_individual_items": 5.668628094591457e-06, "remove_single_ts_time_rank_from_batch": 5.958461897037771e-07, "normalize_and_clip_actions": 1.0080430886711609e-05, "listify_data_for_vector_env": 1.1557970015731863e-05, "get_actions": 4.128211302903077e-05}}, "connector_pipeline_timer": 0.00010993906711100095}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_return_mean": 0.05, "episode_duration_sec_mean": 0.004606516725616529, "env_reset_timer": 0.00041716338064202123, "module_episode_returns_mean": {"default_policy": 0.05}, "env_to_module_connector": {"connector_pipeline_timer": 4.4535070427964546e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 1.6045604475897474e-06, "numpy_to_tensor": 9.34828632373407e-06, "batch_individual_items": 6.4053910103705955e-06, "add_time_dim_to_batch_and_zero_pad": 2.3046733422378056e-06, "add_observations_from_episodes_to_batch": 2.9471501940373405e-06}}}, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_max": 13.5, "num_episodes_lifetime": 260, "rlmodule_inference_timer": 2.9319648654090583e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "sample": 0.1044067343191619, "weights_seq_no": 13.0, "episode_len_max": 20, "env_step_timer": 1.4816868231523996e-05, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": 0.05}, "time_between_sampling": 1.6584262308421327}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "50370_00000", "date": "2025-08-11_19-19-46", "timestamp": 1754932786, "time_this_iter_s": 1.8484430313110352, "time_total_s": 22.469045162200928, "pid": 14120, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x156df18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 22.469045162200928, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 54.2, "ram_util_percent": 83.1}}
{"timers": {"training_iteration": 1.6378779690400498, "restore_env_runners": 1.4524041268519403e-05, "training_step": 1.637737654975344, "env_runner_sampling_timer": 1.521777911793729, "learner_update_timer": 0.11268249054456199, "synch_weights": 0.0007345869037187989, "restore_eval_env_runners": 7.808759683824255e-06, "evaluation_iteration": 0.11661072524983811, "synch_eval_env_connectors": 0.0001299427189984578, "synch_env_connectors": 4.58953522489247e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.00010641758936808929, "timers": {"connectors": {"tensor_to_numpy": 1.3226325125996817e-05, "normalize_and_clip_actions": 9.520825381984197e-06, "listify_data_for_vector_env": 1.1202179990682935e-05, "get_actions": 4.096851055050916e-05, "un_batch_to_individual_items": 5.412895326329666e-06, "remove_single_ts_time_rank_from_batch": 5.909861793813987e-07}}}, "num_env_steps_sampled": 5000.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7839967598201748e-06, "numpy_to_tensor": 8.72607998966091e-06, "batch_individual_items": 6.371345636240326e-06, "add_time_dim_to_batch_and_zero_pad": 2.385053574773072e-06, "add_observations_from_episodes_to_batch": 3.0160942600116206e-06}}, "connector_pipeline_timer": 4.403240435984664e-05}, "env_step_timer": 1.4106911614646055e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "time_between_sampling": 0.0019312304023587708, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "episode_return_mean": 5.019999999999998, "episode_duration_sec_mean": 0.004647633027750999, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_mean": 20.0, "num_episodes": 250.0, "weights_seq_no": 13.0, "agent_episode_returns_mean": {"default_agent": 5.019999999999998}, "episode_return_max": 9.5, "sample": 0.005026359605207239, "num_episodes_lifetime": -370000.0, "env_reset_timer": 3.8055116035644486e-05, "module_episode_returns_mean": {"default_policy": 5.019999999999998}, "episode_return_min": -10.5, "rlmodule_inference_timer": 2.919542638117875e-05, "num_env_steps_sampled_lifetime": -7400000.0, "num_env_steps_sampled_lifetime_throughput": 3642.080951836792}, "learners": {"__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.08514267829592609, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008751815515350949, "add_time_dim_to_batch_and_zero_pad": 1.1014874490426295e-05, "add_observations_from_episodes_to_batch": 0.0007899506798105359, "add_columns_from_episodes_to_train_batch": 0.0335787211223607, "add_states_from_episodes_to_batch": 3.2251934100105147e-06, "numpy_to_tensor": 5.9861566558371244e-05, "batch_individual_items": 0.03457437917916314, "general_advantage_estimation": 0.00725951220614369}}}, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 84000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 441000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1971637.5408463285, "num_module_steps_trained_throughput": 376448.3837559329, "num_module_steps_trained_lifetime_throughput": 376031.6625652117}, "default_policy": {"curr_kl_coeff": 4.5562519517261535e-05, "num_trainable_parameters": 6003, "mean_kl_loss": 0.001021185191348195, "weights_seq_no": 14.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "gradients_default_optimizer_global_norm": 0.035518303513526917, "module_train_batch_size_mean": 1000.0, "total_loss": -0.1332673281431198, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.00948035717010498, "entropy": 0.5491995215415955, "policy_loss": -0.19703388214111328, "num_module_steps_trained_lifetime": 84000, "curr_entropy_coeff": 0.0090570820258, "vf_loss_unclipped": 28.610187530517578, "num_module_steps_trained_lifetime_throughput": 376721.86782221484}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_return_min": -14.5, "num_env_steps_sampled_lifetime": 70400, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4733121636761386e-05, "un_batch_to_individual_items": 5.803838857343607e-06, "remove_single_ts_time_rank_from_batch": 6.11249160525604e-07, "normalize_and_clip_actions": 1.035527878032514e-05, "listify_data_for_vector_env": 1.1853030319866645e-05, "get_actions": 4.367764810096159e-05}}, "connector_pipeline_timer": 0.00011472772911693966}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_return_mean": -0.55, "episode_duration_sec_mean": 0.004622613794635981, "env_reset_timer": 0.0004138984173016664, "module_episode_returns_mean": {"default_policy": -0.55}, "env_to_module_connector": {"connector_pipeline_timer": 4.676522571510523e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 1.66924365841095e-06, "numpy_to_tensor": 9.734050327338615e-06, "batch_individual_items": 6.7044259646021586e-06, "add_time_dim_to_batch_and_zero_pad": 2.5480553866157412e-06, "add_observations_from_episodes_to_batch": 3.0508326276481894e-06}}}, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_max": 13.5, "num_episodes_lifetime": 280, "rlmodule_inference_timer": 3.1392409622232936e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "sample": 0.10442203863620096, "weights_seq_no": 14.0, "episode_len_max": 20, "env_step_timer": 1.6034696706787012e-05, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": -0.55}, "time_between_sampling": 1.6581104947842078}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "50370_00000", "date": "2025-08-11_19-19-48", "timestamp": 1754932788, "time_this_iter_s": 1.7131812572479248, "time_total_s": 24.182226419448853, "pid": 14120, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x156df18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 24.182226419448853, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 49.0, "ram_util_percent": 83.53333333333333}}
{"timers": {"training_iteration": 1.6424154706001877, "restore_env_runners": 1.4442960832152687e-05, "training_step": 1.6422743705057925, "env_runner_sampling_timer": 1.5235128893458625, "learner_update_timer": 0.11546381271991779, "synch_weights": 0.0007368652045882122, "restore_eval_env_runners": 7.797341977643081e-06, "evaluation_iteration": 0.11656206466788126, "synch_eval_env_connectors": 0.00012971745132635748, "synch_env_connectors": 4.59072987032254e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.00012532242963677289, "timers": {"connectors": {"tensor_to_numpy": 1.5181457416867932e-05, "normalize_and_clip_actions": 1.068469295576858e-05, "listify_data_for_vector_env": 1.3770778517569433e-05, "get_actions": 4.978538782498793e-05, "un_batch_to_individual_items": 6.257508876008027e-06, "remove_single_ts_time_rank_from_batch": 6.617651323633442e-07}}}, "num_env_steps_sampled": 5000.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.9769905229066603e-06, "numpy_to_tensor": 1.0272811525196729e-05, "batch_individual_items": 7.32820764467103e-06, "add_time_dim_to_batch_and_zero_pad": 2.668687509047296e-06, "add_observations_from_episodes_to_batch": 3.600189513571439e-06}}, "connector_pipeline_timer": 4.979741012406344e-05}, "env_step_timer": 1.6605315353392953e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "time_between_sampling": 0.001965416075308218, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "episode_return_mean": 4.14, "episode_duration_sec_mean": 0.005489143667742609, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_mean": 20.0, "num_episodes": 250.0, "weights_seq_no": 14.0, "agent_episode_returns_mean": {"default_agent": 4.14}, "episode_return_max": 9.5, "sample": 0.005330244116240776, "num_episodes_lifetime": -400875.0, "env_reset_timer": 4.464340666475802e-05, "module_episode_returns_mean": {"default_policy": 4.14}, "episode_return_min": -10.5, "rlmodule_inference_timer": 3.4058293902407163e-05, "num_env_steps_sampled_lifetime": -8017500.0, "num_env_steps_sampled_lifetime_throughput": 3361.3575385920167}, "learners": {"__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.08795958609252774, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00886596944994925, "add_time_dim_to_batch_and_zero_pad": 1.1192645283617627e-05, "add_observations_from_episodes_to_batch": 0.0008041157636062304, "add_columns_from_episodes_to_train_batch": 0.0337608868306091, "add_states_from_episodes_to_batch": 3.227102387947305e-06, "numpy_to_tensor": 6.057004117150243e-05, "batch_individual_items": 0.03709278663747685, "general_advantage_estimation": 0.007246112923649363}}}, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 90000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 472500, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1968380.3793395807, "num_module_steps_trained_throughput": 375803.9969134742, "num_module_steps_trained_lifetime_throughput": 375396.8285804357}, "default_policy": {"curr_kl_coeff": 2.2781259758630767e-05, "num_trainable_parameters": 6003, "mean_kl_loss": 0.0006800030241720378, "weights_seq_no": 15.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "gradients_default_optimizer_global_norm": 0.1371627002954483, "module_train_batch_size_mean": 1000.0, "total_loss": 0.2012055665254593, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.012212872505187988, "entropy": 0.5368001461029053, "policy_loss": 0.13732679188251495, "num_module_steps_trained_lifetime": 90000, "curr_entropy_coeff": 0.0090570820258, "vf_loss_unclipped": 28.692230224609375, "num_module_steps_trained_lifetime_throughput": 376032.9338389718}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_return_min": -14.5, "num_env_steps_sampled_lifetime": 75400, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.727440127315512e-05, "un_batch_to_individual_items": 6.517779743573894e-06, "remove_single_ts_time_rank_from_batch": 6.941277411630797e-07, "normalize_and_clip_actions": 1.1571074486456458e-05, "listify_data_for_vector_env": 1.3101982182182438e-05, "get_actions": 5.097145193714712e-05}}, "connector_pipeline_timer": 0.00013115528234241953}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_return_mean": -0.75, "episode_duration_sec_mean": 0.005213697968283668, "env_reset_timer": 0.00041966985317763163, "module_episode_returns_mean": {"default_policy": -0.75}, "env_to_module_connector": {"connector_pipeline_timer": 5.065984958993945e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 1.77676936560179e-06, "numpy_to_tensor": 1.086318816679188e-05, "batch_individual_items": 7.6277847540183065e-06, "add_time_dim_to_batch_and_zero_pad": 2.6161266422162976e-06, "add_observations_from_episodes_to_batch": 3.473559046036572e-06}}}, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_max": 13.5, "num_episodes_lifetime": 300, "rlmodule_inference_timer": 3.6076305478671274e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "sample": 0.10503089574977995, "weights_seq_no": 15.0, "episode_len_max": 20, "env_step_timer": 1.816943694022253e-05, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": -0.75}, "time_between_sampling": 1.6627157848363336}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "50370_00000", "date": "2025-08-11_19-19-50", "timestamp": 1754932790, "time_this_iter_s": 2.273228168487549, "time_total_s": 26.4554545879364, "pid": 14120, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x156df18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 26.4554545879364, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 58.866666666666674, "ram_util_percent": 83.83333333333333}}
{"timers": {"training_iteration": 1.642953950064381, "restore_env_runners": 1.4376441013810619e-05, "training_step": 1.642812327630248, "env_runner_sampling_timer": 1.524279602952813, "learner_update_timer": 0.11523605418356148, "synch_weights": 0.0007359965531421018, "restore_eval_env_runners": 7.844788604836899e-06, "evaluation_iteration": 0.11718283902172913, "synch_eval_env_connectors": 0.00012943319605093108, "synch_env_connectors": 4.593572651787562e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.0001241773051353706, "timers": {"connectors": {"tensor_to_numpy": 1.5803238348814194e-05, "normalize_and_clip_actions": 1.0558548272290181e-05, "listify_data_for_vector_env": 1.2744559139382312e-05, "get_actions": 4.9803386841449015e-05, "un_batch_to_individual_items": 6.00248485529424e-06, "remove_single_ts_time_rank_from_batch": 6.581419393461273e-07}}}, "num_env_steps_sampled": 5000.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.012256601072664e-06, "numpy_to_tensor": 1.011276650824611e-05, "batch_individual_items": 7.285576759407286e-06, "add_time_dim_to_batch_and_zero_pad": 2.7264622755028633e-06, "add_observations_from_episodes_to_batch": 3.4199551484085915e-06}}, "connector_pipeline_timer": 4.965098411810914e-05}, "env_step_timer": 1.6682757031340827e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "time_between_sampling": 0.00315839001429434, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "episode_return_mean": 6.62, "episode_duration_sec_mean": 0.005321260966826232, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_mean": 20.0, "num_episodes": 250.0, "weights_seq_no": 15.0, "agent_episode_returns_mean": {"default_agent": 6.62}, "episode_return_max": 9.5, "sample": 0.0061636307279767525, "num_episodes_lifetime": -431750.0, "env_reset_timer": 5.2670726795264524e-05, "module_episode_returns_mean": {"default_policy": 6.62}, "episode_return_min": -10.5, "rlmodule_inference_timer": 3.413646265551361e-05, "num_env_steps_sampled_lifetime": -8635000.0, "num_env_steps_sampled_lifetime_throughput": 3367.9279136980704}, "learners": {"__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.08785863148065565, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008854337254659847, "add_time_dim_to_batch_and_zero_pad": 1.1157798579516283e-05, "add_observations_from_episodes_to_batch": 0.0008039237658535033, "add_columns_from_episodes_to_train_batch": 0.033761716292521206, "add_states_from_episodes_to_batch": 3.222751250701586e-06, "numpy_to_tensor": 6.0465180429044804e-05, "batch_individual_items": 0.037020425431014546, "general_advantage_estimation": 0.007228994715235892}}}, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 96000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 504000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1968812.9415488401, "num_module_steps_trained_throughput": 375860.3631242833, "num_module_steps_trained_lifetime_throughput": 375463.6586160945}, "default_policy": {"curr_kl_coeff": 1.1390629879315384e-05, "num_trainable_parameters": 6003, "mean_kl_loss": 0.0011202433379366994, "weights_seq_no": 16.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "gradients_default_optimizer_global_norm": 0.06061369180679321, "module_train_batch_size_mean": 1000.0, "total_loss": 0.2740742564201355, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.011586427688598633, "entropy": 0.4997800886631012, "policy_loss": 0.2098601907491684, "num_module_steps_trained_lifetime": 96000, "curr_entropy_coeff": 0.0090570820258, "vf_loss_unclipped": 28.64261817932129, "num_module_steps_trained_lifetime_throughput": 376047.2893306212}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_return_min": -14.5, "num_env_steps_sampled_lifetime": 80400, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.2952168198559073e-05, "un_batch_to_individual_items": 5.343549245589179e-06, "remove_single_ts_time_rank_from_batch": 5.947283128614881e-07, "normalize_and_clip_actions": 9.45503164277916e-06, "listify_data_for_vector_env": 1.1027880202395121e-05, "get_actions": 3.577871525168329e-05}}, "connector_pipeline_timer": 0.00010071463354762964}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_return_mean": -1.35, "episode_duration_sec_mean": 0.005221355867106468, "env_reset_timer": 0.0004161869039688956, "module_episode_returns_mean": {"default_policy": -1.35}, "env_to_module_connector": {"connector_pipeline_timer": 4.237650418160599e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 1.561352761494269e-06, "numpy_to_tensor": 8.348760448285004e-06, "batch_individual_items": 6.0649636133643914e-06, "add_time_dim_to_batch_and_zero_pad": 2.1979999801909076e-06, "add_observations_from_episodes_to_batch": 2.8271151807475252e-06}}}, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_max": 13.5, "num_episodes_lifetime": 320, "rlmodule_inference_timer": 2.7213770287460548e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "sample": 0.10495626929256631, "weights_seq_no": 16.0, "episode_len_max": 20, "env_step_timer": 1.3691686351537196e-05, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": -1.35}, "time_between_sampling": 1.66332655073746}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "50370_00000", "date": "2025-08-11_19-19-52", "timestamp": 1754932792, "time_this_iter_s": 1.8007159233093262, "time_total_s": 28.256170511245728, "pid": 14120, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x156df18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 28.256170511245728, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 55.6, "ram_util_percent": 83.94999999999999}}
{"timers": {"training_iteration": 1.6427181834732016, "restore_env_runners": 1.4306015928117044e-05, "training_step": 1.6425762539348046, "env_runner_sampling_timer": 1.5242904773426185, "learner_update_timer": 0.11499186281186895, "synch_weights": 0.0007339524266908208, "restore_eval_env_runners": 7.842590426278736e-06, "evaluation_iteration": 0.11703201938146997, "synch_eval_env_connectors": 0.00012901761466985342, "synch_env_connectors": 4.593477786545478e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.00010892066756853449, "timers": {"connectors": {"tensor_to_numpy": 1.329351096731701e-05, "normalize_and_clip_actions": 9.587692481244164e-06, "listify_data_for_vector_env": 1.1441402966773733e-05, "get_actions": 4.2703383528787424e-05, "un_batch_to_individual_items": 5.571815836937869e-06, "remove_single_ts_time_rank_from_batch": 6.016427727685278e-07}}}, "num_env_steps_sampled": 5000.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7692715569842435e-06, "numpy_to_tensor": 9.330957544884958e-06, "batch_individual_items": 6.5151900371226225e-06, "add_time_dim_to_batch_and_zero_pad": 2.3975614852617413e-06, "add_observations_from_episodes_to_batch": 3.1510710246018484e-06}}, "connector_pipeline_timer": 4.492970094263224e-05}, "env_step_timer": 1.4303353556005592e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "time_between_sampling": 0.001623336122504318, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "episode_return_mean": 7.18, "episode_duration_sec_mean": 0.005124894543085249, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_mean": 20.0, "num_episodes": 250.0, "weights_seq_no": 16.0, "agent_episode_returns_mean": {"default_agent": 7.18}, "episode_return_max": 9.5, "sample": 0.005400709706895309, "num_episodes_lifetime": -462625.0, "env_reset_timer": 3.6013629640877755e-05, "module_episode_returns_mean": {"default_policy": 7.18}, "episode_return_min": -10.5, "rlmodule_inference_timer": 4.558736033636207e-05, "num_env_steps_sampled_lifetime": -9252500.0, "num_env_steps_sampled_lifetime_throughput": 3681.8027330303153}, "learners": {"__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.08776039724632277, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008842189302005173, "add_time_dim_to_batch_and_zero_pad": 1.1134560032383053e-05, "add_observations_from_episodes_to_batch": 0.0008063278580060644, "add_columns_from_episodes_to_train_batch": 0.033761934960465145, "add_states_from_episodes_to_batch": 3.215933710489735e-06, "numpy_to_tensor": 6.036135898078601e-05, "batch_individual_items": 0.03695203867627122, "general_advantage_estimation": 0.007209121018193205}}}, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 102000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 535500, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1974459.9657321519, "num_module_steps_trained_throughput": 376912.0297490831, "num_module_steps_trained_lifetime_throughput": 376524.4582853846}, "default_policy": {"curr_kl_coeff": 5.695314939657692e-06, "num_trainable_parameters": 6003, "mean_kl_loss": 0.0014901324175298214, "weights_seq_no": 17.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "gradients_default_optimizer_global_norm": 0.09873435646295547, "module_train_batch_size_mean": 1000.0, "total_loss": 0.14732712507247925, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.01027071475982666, "entropy": 0.4579978883266449, "policy_loss": 0.08273464441299438, "num_module_steps_trained_lifetime": 102000, "curr_entropy_coeff": 0.0090570820258, "vf_loss_unclipped": 28.64337730407715, "num_module_steps_trained_lifetime_throughput": 377069.553182118}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_return_min": -14.5, "num_env_steps_sampled_lifetime": 85400, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.2816066096159703e-05, "un_batch_to_individual_items": 5.238618137516901e-06, "remove_single_ts_time_rank_from_batch": 5.74472929214636e-07, "normalize_and_clip_actions": 9.256105995036918e-06, "listify_data_for_vector_env": 1.0806018427802366e-05, "get_actions": 3.519170563931192e-05}}, "connector_pipeline_timer": 9.923168037051344e-05}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_return_mean": -0.75, "episode_duration_sec_mean": 0.005186400844249875, "env_reset_timer": 0.0004127725353823509, "module_episode_returns_mean": {"default_policy": -0.75}, "env_to_module_connector": {"connector_pipeline_timer": 4.2214623035142574e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 1.5734071643613896e-06, "numpy_to_tensor": 8.243691280811143e-06, "batch_individual_items": 6.1197584169542734e-06, "add_time_dim_to_batch_and_zero_pad": 2.169888774083622e-06, "add_observations_from_episodes_to_batch": 2.8087401694779517e-06}}}, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_max": 13.5, "num_episodes_lifetime": 340, "rlmodule_inference_timer": 2.7098479139699152e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "sample": 0.10487173534941951, "weights_seq_no": 17.0, "episode_len_max": 20, "env_step_timer": 1.3530444216206041e-05, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": -0.75}, "time_between_sampling": 1.6630591056498272}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "50370_00000", "date": "2025-08-11_19-19-53", "timestamp": 1754932793, "time_this_iter_s": 1.7228670120239258, "time_total_s": 29.979037523269653, "pid": 14120, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x156df18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 29.979037523269653, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 43.43333333333334, "ram_util_percent": 80.23333333333333}}
{"timers": {"training_iteration": 1.645228658719293, "restore_env_runners": 1.4218376446944804e-05, "training_step": 1.6450862276455889, "env_runner_sampling_timer": 1.5256909988186946, "learner_update_timer": 0.11609857877303491, "synch_weights": 0.0007323320716997477, "restore_eval_env_runners": 7.829165016958018e-06, "evaluation_iteration": 0.11687371626728427, "synch_eval_env_connectors": 0.00012860452785594406, "synch_env_connectors": 4.582123015875496e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.00012595251639833997, "timers": {"connectors": {"tensor_to_numpy": 1.5510149270059775e-05, "normalize_and_clip_actions": 1.0934516029190186e-05, "listify_data_for_vector_env": 1.3007640725475732e-05, "get_actions": 5.079004194078839e-05, "un_batch_to_individual_items": 6.083750105446306e-06, "remove_single_ts_time_rank_from_batch": 6.758108436863764e-07}}}, "num_env_steps_sampled": 5000.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.9653820468709186e-06, "numpy_to_tensor": 1.0381752524161104e-05, "batch_individual_items": 7.387651110365065e-06, "add_time_dim_to_batch_and_zero_pad": 2.676115951370644e-06, "add_observations_from_episodes_to_batch": 3.36372941327174e-06}}, "connector_pipeline_timer": 4.9823469202285397e-05}, "env_step_timer": 1.6675751053027772e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "time_between_sampling": 0.0015226113074669422, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "episode_return_mean": 6.700000000000004, "episode_duration_sec_mean": 0.0054733273023739445, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_mean": 20.0, "num_episodes": 250.0, "weights_seq_no": 17.0, "agent_episode_returns_mean": {"default_agent": 6.700000000000004}, "episode_return_max": 9.5, "sample": 0.005563007546587794, "num_episodes_lifetime": -493500.0, "env_reset_timer": 4.2567557982969895e-05, "module_episode_returns_mean": {"default_policy": 6.700000000000004}, "episode_return_min": -10.5, "rlmodule_inference_timer": 3.470119409551127e-05, "num_env_steps_sampled_lifetime": -9870000.0, "num_env_steps_sampled_lifetime_throughput": 3240.061355610258}, "learners": {"__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.0889652582738445, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00885475782872684, "add_time_dim_to_batch_and_zero_pad": 1.1176964147596055e-05, "add_observations_from_episodes_to_batch": 0.0008080854190489931, "add_columns_from_episodes_to_train_batch": 0.03384183811136244, "add_states_from_episodes_to_batch": 3.218773475738887e-06, "numpy_to_tensor": 6.046440618507235e-05, "batch_individual_items": 0.0380686416299457, "general_advantage_estimation": 0.007202866478121275}}}, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 108000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 567000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1975258.6837062256, "num_module_steps_trained_throughput": 377041.2201767707, "num_module_steps_trained_lifetime_throughput": 376662.0378353612}, "default_policy": {"curr_kl_coeff": 2.847657469828846e-06, "num_trainable_parameters": 6003, "mean_kl_loss": 0.00018082500901073217, "weights_seq_no": 18.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "gradients_default_optimizer_global_norm": 0.05914563685655594, "module_train_batch_size_mean": 1000.0, "total_loss": -0.04717446491122246, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.008368968963623047, "entropy": 0.43784546852111816, "policy_loss": -0.11194947361946106, "num_module_steps_trained_lifetime": 108000, "curr_entropy_coeff": 0.0090570820258, "vf_loss_unclipped": 28.636436462402344, "num_module_steps_trained_lifetime_throughput": 377170.2835272451}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_return_min": -14.5, "num_env_steps_sampled_lifetime": 90400, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.535241439099818e-05, "un_batch_to_individual_items": 6.406905124609492e-06, "remove_single_ts_time_rank_from_batch": 6.038355466591895e-07, "normalize_and_clip_actions": 1.09238255450207e-05, "listify_data_for_vector_env": 1.2649779227756785e-05, "get_actions": 4.4989723062748834e-05}}, "connector_pipeline_timer": 0.00012022555020134757}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_return_mean": 0.05, "episode_duration_sec_mean": 0.005318657901370898, "env_reset_timer": 0.000409399811120857, "module_episode_returns_mean": {"default_policy": 0.05}, "env_to_module_connector": {"connector_pipeline_timer": 4.915764069044516e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7943193037552365e-06, "numpy_to_tensor": 1.0173699102081236e-05, "batch_individual_items": 6.990378008247507e-06, "add_time_dim_to_batch_and_zero_pad": 2.6482474811169266e-06, "add_observations_from_episodes_to_batch": 3.0813285343974084e-06}}}, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_max": 13.5, "num_episodes_lifetime": 360, "rlmodule_inference_timer": 3.264640392983313e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "sample": 0.10500133758516021, "weights_seq_no": 18.0, "episode_len_max": 20, "env_step_timer": 1.683619212064197e-05, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": 0.05}, "time_between_sampling": 1.6655362308433295}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "50370_00000", "date": "2025-08-11_19-19-55", "timestamp": 1754932795, "time_this_iter_s": 2.019932270050049, "time_total_s": 31.998969793319702, "pid": 14120, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x156df18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 31.998969793319702, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 52.43333333333334, "ram_util_percent": 80.03333333333333}}
{"timers": {"training_iteration": 1.644814604632532, "restore_env_runners": 1.4137852057680991e-05, "training_step": 1.644671927038449, "env_runner_sampling_timer": 1.524619010910529, "learner_update_timer": 0.11675854173555086, "synch_weights": 0.0007306012510752119, "restore_eval_env_runners": 7.824203378007223e-06, "evaluation_iteration": 0.1169388049442017, "synch_eval_env_connectors": 0.0001294164019278746, "synch_env_connectors": 4.582962210858194e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.00010790385329414046, "timers": {"connectors": {"tensor_to_numpy": 1.3465321906020397e-05, "normalize_and_clip_actions": 9.77232980571411e-06, "listify_data_for_vector_env": 1.1384347361258573e-05, "get_actions": 4.1226061062817564e-05, "un_batch_to_individual_items": 5.491520700361889e-06, "remove_single_ts_time_rank_from_batch": 6.157268292475505e-07}}}, "num_env_steps_sampled": 5000.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7677731085819988e-06, "numpy_to_tensor": 8.852755240717815e-06, "batch_individual_items": 6.420513585746805e-06, "add_time_dim_to_batch_and_zero_pad": 2.432737563575215e-06, "add_observations_from_episodes_to_batch": 3.1157499133364967e-06}}, "connector_pipeline_timer": 4.4525384249667036e-05}, "env_step_timer": 1.4415016730499161e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "time_between_sampling": 0.0021594538684964106, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "episode_return_mean": 7.659999999999997, "episode_duration_sec_mean": 0.004696736990008504, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_mean": 20.0, "num_episodes": 250.0, "weights_seq_no": 18.0, "agent_episode_returns_mean": {"default_agent": 7.659999999999997}, "episode_return_max": 9.5, "sample": 0.0054596055374368, "num_episodes_lifetime": -524375.0, "env_reset_timer": 4.388005091759313e-05, "module_episode_returns_mean": {"default_policy": 7.659999999999997}, "episode_return_min": -10.5, "rlmodule_inference_timer": 2.978873982032386e-05, "num_env_steps_sampled_lifetime": -10487500.0, "num_env_steps_sampled_lifetime_throughput": 3560.5228103947798}, "learners": {"__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.08974689277091343, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008842651500715393, "add_time_dim_to_batch_and_zero_pad": 1.1248103931468137e-05, "add_observations_from_episodes_to_batch": 0.000808163724774025, "add_columns_from_episodes_to_train_batch": 0.03384720432003489, "add_states_from_episodes_to_batch": 3.2194951883087543e-06, "numpy_to_tensor": 6.053393140099393e-05, "batch_individual_items": 0.0388753768733524, "general_advantage_estimation": 0.007184446563798868}}}, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 114000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 598500, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1976403.750218815, "num_module_steps_trained_throughput": 377237.92377669824, "num_module_steps_trained_lifetime_throughput": 376866.11843629804}, "default_policy": {"curr_kl_coeff": 1.423828734914423e-06, "num_trainable_parameters": 6003, "mean_kl_loss": 1.3710978237213567e-05, "weights_seq_no": 19.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "gradients_default_optimizer_global_norm": 0.0536673404276371, "module_train_batch_size_mean": 1000.0, "total_loss": 0.16122514009475708, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.009635567665100098, "entropy": 0.44391682744026184, "policy_loss": 0.09650514274835587, "num_module_steps_trained_lifetime": 114000, "curr_entropy_coeff": 0.0090570820258, "vf_loss_unclipped": 28.636056900024414, "num_module_steps_trained_lifetime_throughput": 377336.76326815784}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_return_min": -14.5, "num_env_steps_sampled_lifetime": 95400, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.2953665263292702e-05, "un_batch_to_individual_items": 5.231783832832586e-06, "remove_single_ts_time_rank_from_batch": 5.654651114731845e-07, "normalize_and_clip_actions": 9.359208227800032e-06, "listify_data_for_vector_env": 1.0789852756687e-05, "get_actions": 3.588275052439876e-05}}, "connector_pipeline_timer": 0.0001003100880565597}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_return_mean": -0.55, "episode_duration_sec_mean": 0.0052453212591353805, "env_reset_timer": 0.0004059683128155608, "module_episode_returns_mean": {"default_policy": -0.55}, "env_to_module_connector": {"connector_pipeline_timer": 4.228261274370575e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 1.5883434518599897e-06, "numpy_to_tensor": 8.28539410235898e-06, "batch_individual_items": 6.019610005661671e-06, "add_time_dim_to_batch_and_zero_pad": 2.2077192700828897e-06, "add_observations_from_episodes_to_batch": 2.801097536818336e-06}}}, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_max": 13.5, "num_episodes_lifetime": 380, "rlmodule_inference_timer": 2.693906962755446e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "sample": 0.10492737587887643, "weights_seq_no": 19.0, "episode_len_max": 20, "env_step_timer": 1.3744688325582056e-05, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": -0.55}, "time_between_sampling": 1.6651171789545227}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "50370_00000", "date": "2025-08-11_19-19-57", "timestamp": 1754932797, "time_this_iter_s": 1.7086589336395264, "time_total_s": 33.70762872695923, "pid": 14120, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x156df18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 33.70762872695923, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 45.7, "ram_util_percent": 80.05}}
{"timers": {"training_iteration": 1.6453386319268253, "restore_env_runners": 1.4050223655344896e-05, "training_step": 1.6451955969274608, "env_runner_sampling_timer": 1.5253712578812577, "learner_update_timer": 0.11652771506808084, "synch_weights": 0.0007302456581934526, "restore_eval_env_runners": 7.812210975572423e-06, "evaluation_iteration": 0.11679365272400498, "synch_eval_env_connectors": 0.00012907264793937805, "synch_env_connectors": 4.576302852084721e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "episode_len_max": 20, "module_to_env_connector": {"connector_pipeline_timer": 0.00012028568792855893, "timers": {"connectors": {"tensor_to_numpy": 1.4950277849959108e-05, "normalize_and_clip_actions": 1.0605248557383596e-05, "listify_data_for_vector_env": 1.2718167031903299e-05, "get_actions": 4.704007784441887e-05, "un_batch_to_individual_items": 6.0828591670118615e-06, "remove_single_ts_time_rank_from_batch": 6.502916360193898e-07}}}, "num_env_steps_sampled": 5000.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.02976912290876e-06, "numpy_to_tensor": 1.0206688843225726e-05, "batch_individual_items": 7.116239857841286e-06, "add_time_dim_to_batch_and_zero_pad": 2.730227220430431e-06, "add_observations_from_episodes_to_batch": 3.381457056564471e-06}}, "connector_pipeline_timer": 4.914876774825717e-05}, "env_step_timer": 1.624949111697835e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "time_between_sampling": 0.001929337721117463, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "episode_return_mean": 6.2200000000000015, "episode_duration_sec_mean": 0.005254458344075826, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_mean": 20.0, "num_episodes": 250.0, "weights_seq_no": 19.0, "agent_episode_returns_mean": {"default_agent": 6.2200000000000015}, "episode_return_max": 9.5, "sample": 0.005463339691630712, "num_episodes_lifetime": -555250.0, "env_reset_timer": 4.457186059869582e-05, "module_episode_returns_mean": {"default_policy": 6.2200000000000015}, "episode_return_min": -10.5, "rlmodule_inference_timer": 3.279729636988932e-05, "num_env_steps_sampled_lifetime": -11105000.0, "num_env_steps_sampled_lifetime_throughput": 3297.8335025660967}, "learners": {"__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.08964859842322885, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00883652290572481, "add_time_dim_to_batch_and_zero_pad": 1.1267293277752592e-05, "add_observations_from_episodes_to_batch": 0.0008086845884194603, "add_columns_from_episodes_to_train_batch": 0.03385395519654825, "add_states_from_episodes_to_batch": 3.2193901198872614e-06, "numpy_to_tensor": 6.082901221442051e-05, "batch_individual_items": 0.03879282602407412, "general_advantage_estimation": 0.007167265848503904}}}, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 120000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 630000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1983885.7669236436, "num_module_steps_trained_throughput": 378641.81937355443, "num_module_steps_trained_lifetime_throughput": 378276.9733984621}, "default_policy": {"curr_kl_coeff": 7.119143674572115e-07, "num_trainable_parameters": 6003, "mean_kl_loss": 2.8233316697878763e-05, "weights_seq_no": 20.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "default_optimizer_learning_rate": 0.0002847858517, "gradients_default_optimizer_global_norm": 0.05579276755452156, "module_train_batch_size_mean": 1000.0, "total_loss": 0.2269459366798401, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.01161646842956543, "entropy": 0.4487060010433197, "policy_loss": 0.16226932406425476, "num_module_steps_trained_lifetime": 120000, "curr_entropy_coeff": 0.0090570820258, "vf_loss_unclipped": 28.659807205200195, "num_module_steps_trained_lifetime_throughput": 378702.1417852843}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_return_min": -14.5, "num_env_steps_sampled_lifetime": 100400, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3153054826775413e-05, "un_batch_to_individual_items": 5.448185078837852e-06, "remove_single_ts_time_rank_from_batch": 5.721715657344278e-07, "normalize_and_clip_actions": 9.433688112651257e-06, "listify_data_for_vector_env": 1.097561231442279e-05, "get_actions": 3.712676422204991e-05}}, "connector_pipeline_timer": 0.00010229245250802708}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_return_mean": -0.35, "episode_duration_sec_mean": 0.004673267903272062, "env_reset_timer": 0.00040336822054525375, "module_episode_returns_mean": {"default_policy": -0.35}, "env_to_module_connector": {"connector_pipeline_timer": 4.281277028611945e-05, "timers": {"connectors": {"add_states_from_episodes_to_batch": 1.5659974126011813e-06, "numpy_to_tensor": 8.46415183309362e-06, "batch_individual_items": 6.2444251040449625e-06, "add_time_dim_to_batch_and_zero_pad": 2.209262880828421e-06, "add_observations_from_episodes_to_batch": 2.820809387589564e-06}}}, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_max": 13.5, "num_episodes_lifetime": 400, "rlmodule_inference_timer": 2.7635370261015162e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "sample": 0.10487523837045877, "weights_seq_no": 20.0, "episode_len_max": 20, "env_step_timer": 1.392387262836982e-05, "num_episodes": 20, "agent_episode_returns_mean": {"default_agent": -0.35}, "time_between_sampling": 1.6656164634149242}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "50370_00000", "date": "2025-08-11_19-19-59", "timestamp": 1754932799, "time_this_iter_s": 1.8053197860717773, "time_total_s": 35.512948513031006, "pid": 14120, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x156df18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 35.512948513031006, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 47.23333333333333, "ram_util_percent": 80.39999999999999}}
