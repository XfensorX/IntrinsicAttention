{"timers": {"training_iteration": 1.699480333016254, "restore_env_runners": 9.750016033649445e-06, "training_step": 1.6993505419231951, "env_runner_sampling_timer": 1.58964608295355, "learner_update_timer": 0.1064329999499023, "synch_weights": 0.0008131249342113733}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.3854872734365387e-06, "numpy_to_tensor": 9.858547965646058e-06, "batch_individual_items": 6.854100838690216e-06, "add_time_dim_to_batch_and_zero_pad": 2.6014159664667028e-06, "add_states_from_episodes_to_batch": 1.8242590265049943e-06}}, "connector_pipeline_timer": 4.911830444407894e-05}, "env_to_module_sum_episodes_length_out": 10.191744832559449, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.183383302390888e-05, "un_batch_to_individual_items": 5.828325231962037e-06, "normalize_and_clip_actions": 1.295033765652591e-05, "get_actions": 4.6380736633822035e-05, "remove_single_ts_time_rank_from_batch": 6.274758907425292e-07, "tensor_to_numpy": 1.4273191437081443e-05}}, "connector_pipeline_timer": 0.00011943929667921163}, "episode_len_min": 20, "weights_seq_no": 0.0, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "num_env_steps_sampled": 5000.0, "episode_len_max": 20, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.191744832559449, "num_module_steps_sampled": {"default_policy": 5000.0}, "sample": 0.005918566857753784, "env_reset_timer": 9.045660966734507e-05, "num_episodes_lifetime": 31375.0, "episode_duration_sec_mean": 0.0052822139807976775, "time_between_sampling": 0.0005677303427163497, "num_env_steps_sampled_lifetime": 627500.0, "rlmodule_inference_timer": 5.4613167006299185e-05, "agent_episode_returns_mean": {"default_agent": 0.17999999999999997}, "episode_return_min": -9.5, "module_episode_returns_mean": {"default_policy": 0.17999999999999997}, "env_step_timer": 1.5729520806723863e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_mean": 0.17999999999999997, "episode_len_mean": 20.0, "episode_return_max": 10.5, "num_env_steps_sampled_lifetime_throughput": 3238.952175098028}, "learners": {"__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.08056066604331136, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.875000402331352e-06, "add_observations_from_episodes_to_batch": 0.0008734159637242556, "general_advantage_estimation": 0.007460583001375198, "add_one_ts_to_episodes_and_truncate": 0.00764258299022913, "numpy_to_tensor": 7.858301978558302e-05, "batch_individual_items": 0.029820583062246442, "add_time_dim_to_batch_and_zero_pad": 1.5874975360929966e-05, "add_columns_from_episodes_to_train_batch": 0.034504457958973944}}}, "learner_connector_sum_episodes_length_in": 5000, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime": 31500, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 6000, "num_trainable_parameters": 6003, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250, "num_env_steps_trained_lifetime_throughput": 2355436.0675890613, "num_module_steps_trained_throughput": 451393.50931902125, "num_module_steps_trained_lifetime_throughput": 450495.29182769376}, "default_policy": {"vf_loss": 0.10278083384037018, "total_loss": 0.12544988095760345, "vf_explained_var": -0.010670661926269531, "default_optimizer_learning_rate": 0.0002847858517, "mean_kl_loss": 0.001026108511723578, "gradients_default_optimizer_global_norm": 0.12170831859111786, "vf_loss_unclipped": 28.942136764526367, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.3732481598854065, "entropy": 0.6878411173820496, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 6000, "policy_loss": 0.06217312067747116, "num_trainable_parameters": 6003, "curr_entropy_coeff": 0.0090570820258, "weights_seq_no": 1.0, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime_throughput": 452753.8855878071}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.263227031547189e-07, "listify_data_for_vector_env": 1.0975330391977466e-05, "un_batch_to_individual_items": 5.404735907883726e-06, "normalize_and_clip_actions": 1.1329081050403674e-05, "get_actions": 4.3166144439692235e-05, "tensor_to_numpy": 1.5428843403391735e-05}}, "connector_pipeline_timer": 0.0001123730648315511}, "episode_len_max": 20, "env_reset_timer": 0.0005279579199850559, "rlmodule_inference_timer": 3.1405815996858626e-05, "module_episode_returns_mean": {"default_policy": 2.05}, "env_step_timer": 1.5011013334304309e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_in": 10.216013141322508, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.004536210454534739, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.4216102907099943e-06, "numpy_to_tensor": 8.415524644855124e-06, "batch_individual_items": 6.4351057187832465e-06, "add_time_dim_to_batch_and_zero_pad": 2.712803917965132e-06, "add_states_from_episodes_to_batch": 1.6392668547733635e-06}}, "connector_pipeline_timer": 4.7005728356767e-05}, "num_env_steps_sampled_lifetime": 5400, "episode_return_min": -12.5, "episode_return_mean": 2.05, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "num_episodes": 20, "sample": 0.09997804195154458, "num_episodes_lifetime": 20, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": 2.05}, "episode_len_mean": 20.0, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.216013141322508, "weights_seq_no": 1.0}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "465d7_00000", "date": "2025-08-11_19-23-39", "timestamp": 1754933019, "time_this_iter_s": 1.8113250732421875, "time_total_s": 1.8113250732421875, "pid": 14455, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1614318a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1.8113250732421875, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 36.800000000000004, "ram_util_percent": 77.1}}
{"timers": {"training_iteration": 1.6978567805164493, "restore_env_runners": 9.716675849631429e-06, "training_step": 1.6977264098438898, "env_runner_sampling_timer": 1.5872879812843166, "learner_update_timer": 0.10716884661000221, "synch_weights": 0.0008102336851879954, "restore_eval_env_runners": 8.792034350335598e-06, "evaluation_iteration": 0.11016887496225536, "synch_eval_env_connectors": 0.00012562505435198545, "synch_env_connectors": 4.375004209578037e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.9400786341368727e-06, "numpy_to_tensor": 8.367098200716467e-06, "batch_individual_items": 6.191314712507954e-06, "add_time_dim_to_batch_and_zero_pad": 2.3084459165012126e-06, "add_states_from_episodes_to_batch": 1.72535641555128e-06}}, "connector_pipeline_timer": 4.339038568470904e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0881688202978037e-05, "un_batch_to_individual_items": 5.2515772310926975e-06, "normalize_and_clip_actions": 9.317008776732636e-06, "get_actions": 3.6912251005452326e-05, "remove_single_ts_time_rank_from_batch": 5.803644880950435e-07, "tensor_to_numpy": 1.2783428619532268e-05}}, "connector_pipeline_timer": 0.00010145990777290802}, "episode_len_min": 20, "weights_seq_no": 1.0, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "num_env_steps_sampled": 5000.0, "episode_len_max": 20, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "sample": 0.0052476296281421, "env_reset_timer": 4.1194116884834465e-05, "num_episodes_lifetime": 500.0, "episode_duration_sec_mean": 0.0044501701672561445, "time_between_sampling": 0.0015464129276845724, "num_env_steps_sampled_lifetime": 10000.0, "rlmodule_inference_timer": 2.7037371320750097e-05, "agent_episode_returns_mean": {"default_agent": 0.3400000000000001}, "episode_return_min": -9.5, "module_episode_returns_mean": {"default_policy": 0.3400000000000001}, "env_step_timer": 1.3576512778355286e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_mean": 0.3400000000000001, "episode_len_mean": 20.0, "episode_return_max": 10.5, "num_env_steps_sampled_lifetime_throughput": 3783.9788894283365}, "learners": {"__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.08142564396257512, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.867500927299261e-06, "add_observations_from_episodes_to_batch": 0.0008728730538859963, "general_advantage_estimation": 0.007438218421302736, "add_one_ts_to_episodes_and_truncate": 0.0076414200803264975, "numpy_to_tensor": 7.832885952666402e-05, "batch_individual_items": 0.030701592231635003, "add_time_dim_to_batch_and_zero_pad": 1.5821225242689253e-05, "add_columns_from_episodes_to_train_batch": 0.03451345254899934}}}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime": 63000, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 12000, "num_trainable_parameters": 6003, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 2355199.0360579332, "num_module_steps_trained_throughput": 451315.62757788436, "num_module_steps_trained_lifetime_throughput": 450426.93164471386}, "default_policy": {"vf_loss": 0.10278083384037018, "total_loss": 0.060141224414110184, "vf_explained_var": -0.010760307312011719, "default_optimizer_learning_rate": 0.0002847858517, "mean_kl_loss": 4.524777614278719e-05, "gradients_default_optimizer_global_norm": 0.019594253972172737, "vf_loss_unclipped": 28.860502243041992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.18662407994270325, "entropy": 0.6892082095146179, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 12000, "policy_loss": -0.0023740576580166817, "num_trainable_parameters": 6003, "curr_entropy_coeff": 0.0090570820258, "weights_seq_no": 2.0, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime_throughput": 452649.90901362925}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.643388679369382e-07, "listify_data_for_vector_env": 1.076778770049819e-05, "un_batch_to_individual_items": 5.281681519546919e-06, "normalize_and_clip_actions": 9.219795591163458e-06, "get_actions": 3.437762199026335e-05, "tensor_to_numpy": 1.2630028081604358e-05}}, "connector_pipeline_timer": 9.810199287185192e-05}, "episode_len_max": 20, "env_reset_timer": 0.0005234483408275991, "rlmodule_inference_timer": 2.636427263543357e-05, "module_episode_returns_mean": {"default_policy": 2.05}, "env_step_timer": 1.345658411690253e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_in": 10.366003441359926, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.0044625396258197725, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7658844099888357e-06, "numpy_to_tensor": 8.171078259931969e-06, "batch_individual_items": 5.96821404856417e-06, "add_time_dim_to_batch_and_zero_pad": 2.144150016004933e-06, "add_states_from_episodes_to_batch": 1.5768002473805887e-06}}, "connector_pipeline_timer": 4.179649687165079e-05}, "num_env_steps_sampled_lifetime": 10400, "episode_return_min": -12.5, "episode_return_mean": 2.05, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "num_episodes": 20, "sample": 0.0999342977826018, "num_episodes_lifetime": 40, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "agent_episode_returns_mean": {"default_agent": 2.05}, "episode_len_mean": 20.0, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.366003441359926, "weights_seq_no": 2.0, "time_between_sampling": 1.5753793749026954}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "465d7_00000", "date": "2025-08-11_19-23-41", "timestamp": 1754933021, "time_this_iter_s": 1.6398930549621582, "time_total_s": 3.4512181282043457, "pid": 14455, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1614318a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3.4512181282043457, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 39.85, "ram_util_percent": 77.0}}
{"timers": {"training_iteration": 1.6954688710414103, "restore_env_runners": 9.677418728824704e-06, "training_step": 1.6953382078259367, "env_runner_sampling_timer": 1.5850577456319006, "learner_update_timer": 0.10701332022473216, "synch_weights": 0.0008077330184634774, "restore_eval_env_runners": 8.776204194873572e-06, "evaluation_iteration": 0.11007451121346094, "synch_eval_env_connectors": 0.00012655505444854497, "synch_env_connectors": 4.375004209578037e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.9748697011472234e-06, "numpy_to_tensor": 8.420353977010693e-06, "batch_individual_items": 6.256032768948821e-06, "add_time_dim_to_batch_and_zero_pad": 2.3174321449153984e-06, "add_states_from_episodes_to_batch": 1.7329433262346275e-06}}, "connector_pipeline_timer": 4.369741066073131e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.095114092042707e-05, "un_batch_to_individual_items": 5.365895897204449e-06, "normalize_and_clip_actions": 9.376615656961671e-06, "get_actions": 3.681793093441715e-05, "remove_single_ts_time_rank_from_batch": 5.883330052445899e-07, "tensor_to_numpy": 1.2816340161420614e-05}}, "connector_pipeline_timer": 0.00010189498905464889}, "episode_len_min": 20, "weights_seq_no": 2.0, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "num_env_steps_sampled": 5000.0, "episode_len_max": 20, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "sample": 0.004829594984152589, "env_reset_timer": 3.3321402679780106e-05, "num_episodes_lifetime": -30375.0, "episode_duration_sec_mean": 0.004487537338398398, "time_between_sampling": 0.0018100623150652684, "num_env_steps_sampled_lifetime": -607500.0, "rlmodule_inference_timer": 2.674247329144709e-05, "agent_episode_returns_mean": {"default_agent": 1.3000000000000003}, "episode_return_min": -9.5, "module_episode_returns_mean": {"default_policy": 1.3000000000000003}, "env_step_timer": 1.3623724753641141e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_mean": 1.3000000000000003, "episode_len_mean": 20.0, "episode_return_max": 10.5, "num_env_steps_sampled_lifetime_throughput": 3778.254447241115}, "learners": {"__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.0813999100230285, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.857155586592853e-06, "add_observations_from_episodes_to_batch": 0.000872660154197365, "general_advantage_estimation": 0.007417871237592771, "add_one_ts_to_episodes_and_truncate": 0.007641480468818918, "numpy_to_tensor": 7.808641090523452e-05, "batch_individual_items": 0.030698812969331628, "add_time_dim_to_batch_and_zero_pad": 1.5762592328246685e-05, "add_columns_from_episodes_to_train_batch": 0.03451193802414927}}}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime": 94500, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 18000, "num_trainable_parameters": 6003, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 2355673.6821878185, "num_module_steps_trained_throughput": 451352.22981405526, "num_module_steps_trained_lifetime_throughput": 450478.8017029563}, "default_policy": {"vf_loss": 0.10278083384037018, "total_loss": 0.3532428741455078, "vf_explained_var": -0.010493040084838867, "default_optimizer_learning_rate": 0.0002847858517, "mean_kl_loss": 0.0007080155191943049, "gradients_default_optimizer_global_norm": 0.044358815997838974, "vf_loss_unclipped": 29.159080505371094, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.09331203997135162, "entropy": 0.684884786605835, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 18000, "policy_loss": 0.29057320952415466, "num_trainable_parameters": 6003, "curr_entropy_coeff": 0.0090570820258, "weights_seq_no": 3.0, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime_throughput": 452641.53372353164}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.808387189859654e-07, "listify_data_for_vector_env": 1.0942381390830297e-05, "un_batch_to_individual_items": 5.353178884581546e-06, "normalize_and_clip_actions": 9.347184216437656e-06, "get_actions": 3.533723437884299e-05, "tensor_to_numpy": 1.2840467635827916e-05}}, "connector_pipeline_timer": 9.979597989015472e-05}, "episode_len_max": 20, "env_reset_timer": 0.0005190242663840763, "rlmodule_inference_timer": 2.7377652853296867e-05, "module_episode_returns_mean": {"default_policy": 1.3833333333333333}, "env_step_timer": 1.3952114037187968e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_in": 10.368205581254823, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.004451294483927389, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.835975223254388e-06, "numpy_to_tensor": 8.447558354266975e-06, "batch_individual_items": 6.175687657322422e-06, "add_time_dim_to_batch_and_zero_pad": 2.210648307366924e-06, "add_states_from_episodes_to_batch": 1.6048635114647576e-06}}, "connector_pipeline_timer": 4.259136222691021e-05}, "num_env_steps_sampled_lifetime": 15400, "episode_return_min": -12.5, "episode_return_mean": 1.3833333333333333, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "num_episodes": 20, "sample": 0.0999010360550019, "num_episodes_lifetime": 60, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "agent_episode_returns_mean": {"default_agent": 1.3833333333333333}, "episode_len_mean": 20.0, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.368205581254823, "weights_seq_no": 3.0, "time_between_sampling": 1.574398549493635}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "465d7_00000", "date": "2025-08-11_19-23-43", "timestamp": 1754933023, "time_this_iter_s": 1.5626842975616455, "time_total_s": 5.013902425765991, "pid": 14455, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1614318a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5.013902425765991, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 39.06666666666666, "ram_util_percent": 77.16666666666667}}
{"timers": {"training_iteration": 1.6939218052404024, "restore_env_runners": 9.640643834252841e-06, "training_step": 1.693790727416969, "env_runner_sampling_timer": 1.5836774940062068, "learner_update_timer": 0.10684743743287027, "synch_weights": 0.0008056848575868643, "restore_eval_env_runners": 8.759691822342574e-06, "evaluation_iteration": 0.10998990068145796, "synch_eval_env_connectors": 0.0001263378331903368, "synch_env_connectors": 4.3741741683334115e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.028920066737964e-06, "numpy_to_tensor": 8.397698988731233e-06, "batch_individual_items": 6.239969505001197e-06, "add_time_dim_to_batch_and_zero_pad": 2.316144578918789e-06, "add_states_from_episodes_to_batch": 1.7355123210267335e-06}}, "connector_pipeline_timer": 4.3719005662349264e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0907283489862293e-05, "un_batch_to_individual_items": 5.320080174510626e-06, "normalize_and_clip_actions": 9.364337410165937e-06, "get_actions": 3.701435598915456e-05, "remove_single_ts_time_rank_from_batch": 5.940089911963104e-07, "tensor_to_numpy": 1.2858613625690324e-05}}, "connector_pipeline_timer": 0.00010199924544729312}, "episode_len_min": 20, "weights_seq_no": 3.0, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "num_env_steps_sampled": 5000.0, "episode_len_max": 20, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "sample": 0.004800292572283032, "env_reset_timer": 3.423336464256284e-05, "num_episodes_lifetime": -61250.0, "episode_duration_sec_mean": 0.004487709465436638, "time_between_sampling": 0.0017665802957884638, "num_env_steps_sampled_lifetime": -1225000.0, "rlmodule_inference_timer": 2.664992378377344e-05, "agent_episode_returns_mean": {"default_agent": 2.259999999999999}, "episode_return_min": -9.5, "module_episode_returns_mean": {"default_policy": 2.259999999999999}, "env_step_timer": 1.3663547474401498e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_mean": 2.259999999999999, "episode_len_mean": 20.0, "episode_return_max": 10.5, "num_env_steps_sampled_lifetime_throughput": 3764.019013957841}, "learners": {"__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.08135900634266145, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.855663474882022e-06, "add_observations_from_episodes_to_batch": 0.0008723398029273374, "general_advantage_estimation": 0.007397065865268465, "add_one_ts_to_episodes_and_truncate": 0.007641918574118521, "numpy_to_tensor": 7.784095715940931e-05, "batch_individual_items": 0.030692571929424768, "add_time_dim_to_batch_and_zero_pad": 1.5700386223499663e-05, "add_columns_from_episodes_to_train_batch": 0.03449901197313959}}}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime": 126000, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 24000, "num_trainable_parameters": 6003, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 2356017.9708101656, "num_module_steps_trained_throughput": 451348.09724294394, "num_module_steps_trained_lifetime_throughput": 450494.28594910103}, "default_policy": {"vf_loss": 0.10278083384037018, "total_loss": 0.15174606442451477, "vf_explained_var": -0.010841846466064453, "default_optimizer_learning_rate": 0.0002847858517, "mean_kl_loss": 0.0009349097963422537, "gradients_default_optimizer_global_norm": 0.05304211378097534, "vf_loss_unclipped": 28.754053115844727, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.04665601998567581, "entropy": 0.6782488226890564, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 24000, "policy_loss": 0.0890611782670021, "num_trainable_parameters": 6003, "curr_entropy_coeff": 0.0090570820258, "weights_seq_no": 4.0, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime_throughput": 452578.2698367053}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.740409884382156e-07, "listify_data_for_vector_env": 1.0694386528177478e-05, "un_batch_to_individual_items": 5.330794575964102e-06, "normalize_and_clip_actions": 9.325031987647294e-06, "get_actions": 3.3596711730596444e-05, "tensor_to_numpy": 1.2495652053953671e-05}}, "connector_pipeline_timer": 9.725049601104875e-05}, "episode_len_max": 20, "env_reset_timer": 0.0005147211038159439, "rlmodule_inference_timer": 2.6298120923401458e-05, "module_episode_returns_mean": {"default_policy": 0.55}, "env_step_timer": 1.3382770014501348e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_in": 10.368237912813044, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.0044399213657015935, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.743859994364331e-06, "numpy_to_tensor": 8.151342399434715e-06, "batch_individual_items": 5.94747409512488e-06, "add_time_dim_to_batch_and_zero_pad": 2.1412357953341243e-06, "add_states_from_episodes_to_batch": 1.5749019154266804e-06}}, "connector_pipeline_timer": 4.175941531482655e-05}, "num_env_steps_sampled_lifetime": 20400, "episode_return_min": -12.5, "episode_return_mean": 0.55, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "num_episodes": 20, "sample": 0.09986223027478497, "num_episodes_lifetime": 80, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "agent_episode_returns_mean": {"default_agent": 0.55}, "episode_len_mean": 20.0, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.368237912813044, "weights_seq_no": 4.0, "time_between_sampling": 1.5742294985778977}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "465d7_00000", "date": "2025-08-11_19-23-44", "timestamp": 1754933024, "time_this_iter_s": 1.6436998844146729, "time_total_s": 6.657602310180664, "pid": 14455, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1614318a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6.657602310180664, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 41.75, "ram_util_percent": 77.4}}
{"timers": {"training_iteration": 1.6925415584384282, "restore_env_runners": 9.59756841899245e-06, "training_step": 1.6924100209722976, "env_runner_sampling_timer": 1.5824494015661104, "learner_update_timer": 0.10669613889796384, "synch_weights": 0.0008033255099029792, "restore_eval_env_runners": 8.774174843216315e-06, "evaluation_iteration": 0.10989882334577351, "synch_eval_env_connectors": 0.00012611112515022976, "synch_env_connectors": 4.373341950122267e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.976477305589711e-06, "numpy_to_tensor": 8.422042247169604e-06, "batch_individual_items": 6.203649129360047e-06, "add_time_dim_to_batch_and_zero_pad": 2.3302798854966605e-06, "add_states_from_episodes_to_batch": 1.7257944772726413e-06}}, "connector_pipeline_timer": 4.360759290669582e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0944393507363115e-05, "un_batch_to_individual_items": 5.31409425839652e-06, "normalize_and_clip_actions": 9.414791571223321e-06, "get_actions": 3.751233873900556e-05, "remove_single_ts_time_rank_from_batch": 5.869370185583374e-07, "tensor_to_numpy": 1.2927593365328394e-05}}, "connector_pipeline_timer": 0.00010261850032851535}, "episode_len_min": 20, "weights_seq_no": 4.0, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "num_env_steps_sampled": 5000.0, "episode_len_max": 20, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "sample": 0.004855644842016806, "env_reset_timer": 3.520394121105632e-05, "num_episodes_lifetime": -92125.0, "episode_duration_sec_mean": 0.00485498381452635, "time_between_sampling": 0.0015661647281860914, "num_env_steps_sampled_lifetime": -1842500.0, "rlmodule_inference_timer": 4.511259111776234e-05, "agent_episode_returns_mean": {"default_agent": 1.1400000000000001}, "episode_return_min": -9.5, "module_episode_returns_mean": {"default_policy": 1.1400000000000001}, "env_step_timer": 1.3744720506554495e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_mean": 1.1400000000000001, "episode_len_mean": 20.0, "episode_return_max": 10.5, "num_env_steps_sampled_lifetime_throughput": 3745.0486658378236}, "learners": {"__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.08133078127913634, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.850436546772253e-06, "add_observations_from_episodes_to_batch": 0.000871838075184794, "general_advantage_estimation": 0.007375342706895698, "add_one_ts_to_episodes_and_truncate": 0.007642073978434471, "numpy_to_tensor": 7.773546772918431e-05, "batch_individual_items": 0.030686245790062686, "add_time_dim_to_batch_and_zero_pad": 1.5645882559673628e-05, "add_columns_from_episodes_to_train_batch": 0.034499883943297324}}}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime": 157500, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 30000, "num_trainable_parameters": 6003, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 2355478.557100842, "num_module_steps_trained_throughput": 451170.0400187382, "num_module_steps_trained_lifetime_throughput": 450336.79723396833}, "default_policy": {"vf_loss": 0.10278083384037018, "total_loss": 0.2631865441799164, "vf_explained_var": -0.010644197463989258, "default_optimizer_learning_rate": 0.0002847858517, "mean_kl_loss": 0.0014776266179978848, "gradients_default_optimizer_global_norm": 0.051883306354284286, "vf_loss_unclipped": 29.06502914428711, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.023328009992837906, "entropy": 0.6661638617515564, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 30000, "policy_loss": 0.20041051506996155, "num_trainable_parameters": 6003, "curr_entropy_coeff": 0.0090570820258, "weights_seq_no": 5.0, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime_throughput": 452334.5763469846}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.832634863357678e-07, "listify_data_for_vector_env": 1.0707205304987592e-05, "un_batch_to_individual_items": 5.2335390559371e-06, "normalize_and_clip_actions": 9.193763027305719e-06, "get_actions": 3.39612823282042e-05, "tensor_to_numpy": 1.2579102412004095e-05}}, "connector_pipeline_timer": 9.741451886239188e-05}, "episode_len_max": 20, "env_reset_timer": 0.0005104288923032569, "rlmodule_inference_timer": 2.635788062863686e-05, "module_episode_returns_mean": {"default_policy": 0.65}, "env_step_timer": 1.336059201558372e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_in": 10.368238387501162, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.0044264429213944825, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.762540711741534e-06, "numpy_to_tensor": 8.07573950036484e-06, "batch_individual_items": 5.965797422583142e-06, "add_time_dim_to_batch_and_zero_pad": 2.1550978856829573e-06, "add_states_from_episodes_to_batch": 1.5731128455737017e-06}}, "connector_pipeline_timer": 4.1555042417427045e-05}, "num_env_steps_sampled_lifetime": 25400, "episode_return_min": -12.5, "episode_return_mean": 0.65, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "num_episodes": 20, "sample": 0.09981629130185217, "num_episodes_lifetime": 100, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "agent_episode_returns_mean": {"default_agent": 0.65}, "episode_len_mean": 20.0, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.368238387501162, "weights_seq_no": 5.0, "time_between_sampling": 1.5742087885918197}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "465d7_00000", "date": "2025-08-11_19-23-46", "timestamp": 1754933026, "time_this_iter_s": 1.6580040454864502, "time_total_s": 8.315606355667114, "pid": 14455, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1614318a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8.315606355667114, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 41.5, "ram_util_percent": 77.05}}
{"timers": {"training_iteration": 1.6910739149334335, "restore_env_runners": 9.558253236088914e-06, "training_step": 1.690942042842206, "env_runner_sampling_timer": 1.58023723046952, "learner_update_timer": 0.10744230209953753, "synch_weights": 0.000801263084901744, "restore_eval_env_runners": 8.745183251097334e-06, "evaluation_iteration": 0.1098000934423387, "synch_eval_env_connectors": 0.00012581626339819746, "synch_env_connectors": 4.370448189671151e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.950298140049778e-06, "numpy_to_tensor": 8.371022683983242e-06, "batch_individual_items": 6.195807057664556e-06, "add_time_dim_to_batch_and_zero_pad": 2.3332740156767955e-06, "add_states_from_episodes_to_batch": 1.7316208757024066e-06}}, "connector_pipeline_timer": 4.3558454051197525e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0907382517048141e-05, "un_batch_to_individual_items": 5.27296356177012e-06, "normalize_and_clip_actions": 9.321229595024798e-06, "get_actions": 3.731040566660149e-05, "remove_single_ts_time_rank_from_batch": 5.863073578747978e-07, "tensor_to_numpy": 1.2818266705898148e-05}}, "connector_pipeline_timer": 0.00010207298725461966}, "episode_len_min": 20, "weights_seq_no": 5.0, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "num_env_steps_sampled": 5000.0, "episode_len_max": 20, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "sample": 0.005066934023915339, "env_reset_timer": 3.386225187073913e-05, "num_episodes_lifetime": -123000.0, "episode_duration_sec_mean": 0.004479027803521604, "time_between_sampling": 0.001501137610217204, "num_env_steps_sampled_lifetime": -2460000.0, "rlmodule_inference_timer": 2.7078074051092946e-05, "agent_episode_returns_mean": {"default_agent": 2.58}, "episode_return_min": -9.5, "module_episode_returns_mean": {"default_policy": 2.58}, "env_step_timer": 1.370987602830902e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_mean": 2.58, "episode_len_mean": 20.0, "episode_return_max": 10.5, "num_env_steps_sampled_lifetime_throughput": 3770.347768924837}, "learners": {"__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.08220275304617813, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.838182672223286e-06, "add_observations_from_episodes_to_batch": 0.0008715288644011637, "general_advantage_estimation": 0.007353705950239684, "add_one_ts_to_episodes_and_truncate": 0.007644007409196062, "numpy_to_tensor": 7.759936356911177e-05, "batch_individual_items": 0.031581059171418555, "add_time_dim_to_batch_and_zero_pad": 1.5593584014975108e-05, "add_columns_from_episodes_to_train_batch": 0.034497900524813434}}}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime": 189000, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 36000, "num_trainable_parameters": 6003, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 2355746.7348142415, "num_module_steps_trained_throughput": 451138.9656902071, "num_module_steps_trained_lifetime_throughput": 450328.44059431227}, "default_policy": {"vf_loss": 0.10278083384037018, "total_loss": 0.0240169670432806, "vf_explained_var": -0.010707616806030273, "default_optimizer_learning_rate": 0.0002847858517, "mean_kl_loss": 0.0018115785205736756, "gradients_default_optimizer_global_norm": 0.05181848257780075, "vf_loss_unclipped": 28.573688507080078, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.011664004996418953, "entropy": 0.6465494632720947, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 36000, "policy_loss": -0.03891005367040634, "num_trainable_parameters": 6003, "curr_entropy_coeff": 0.0090570820258, "weights_seq_no": 6.0, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime_throughput": 452233.6710346748}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.812963741464515e-07, "listify_data_for_vector_env": 1.0870148477084004e-05, "un_batch_to_individual_items": 5.278396958258237e-06, "normalize_and_clip_actions": 9.269165190181294e-06, "get_actions": 3.470617935420198e-05, "tensor_to_numpy": 1.26557619632104e-05}}, "connector_pipeline_timer": 9.858978888358788e-05}, "episode_len_max": 20, "env_reset_timer": 0.0005061241927049669, "rlmodule_inference_timer": 2.653302096490792e-05, "module_episode_returns_mean": {"default_policy": 0.45}, "env_step_timer": 1.3706559682921982e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_in": 10.368238394470474, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.004411660843761638, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.781492840010675e-06, "numpy_to_tensor": 8.194252350481611e-06, "batch_individual_items": 6.149629122495239e-06, "add_time_dim_to_batch_and_zero_pad": 2.168517177424762e-06, "add_states_from_episodes_to_batch": 1.5748527200080165e-06}}, "connector_pipeline_timer": 4.19919891207436e-05}, "num_env_steps_sampled_lifetime": 30400, "episode_return_min": -12.5, "episode_return_mean": 0.45, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "num_episodes": 20, "sample": 0.09979301130794214, "num_episodes_lifetime": 120, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "agent_episode_returns_mean": {"default_agent": 0.45}, "episode_len_mean": 20.0, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.368238394470474, "weights_seq_no": 6.0, "time_between_sampling": 1.574120556535634}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "465d7_00000", "date": "2025-08-11_19-23-48", "timestamp": 1754933028, "time_this_iter_s": 1.6502516269683838, "time_total_s": 9.965857982635498, "pid": 14455, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1614318a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9.965857982635498, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 41.53333333333333, "ram_util_percent": 76.96666666666667}}
{"timers": {"training_iteration": 1.6888816712040466, "restore_env_runners": 9.519331205014413e-06, "training_step": 1.68874918574335, "env_runner_sampling_timer": 1.5781813914946563, "learner_update_timer": 0.10730608949838699, "synch_weights": 0.0008002108737578642, "restore_eval_env_runners": 8.72107066688596e-06, "evaluation_iteration": 0.1097253066774604, "synch_eval_env_connectors": 0.00012562685046209443, "synch_env_connectors": 4.370914009182015e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.9859856878148183e-06, "numpy_to_tensor": 8.500951669295944e-06, "batch_individual_items": 6.320724933207235e-06, "add_time_dim_to_batch_and_zero_pad": 2.351491663440226e-06, "add_states_from_episodes_to_batch": 1.7594599738485714e-06}}, "connector_pipeline_timer": 4.389193916172029e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1078142783322322e-05, "un_batch_to_individual_items": 5.388529938157774e-06, "normalize_and_clip_actions": 9.441243060908045e-06, "get_actions": 3.74280855761357e-05, "remove_single_ts_time_rank_from_batch": 5.893564956267192e-07, "tensor_to_numpy": 1.2988449500722266e-05}}, "connector_pipeline_timer": 0.0001028258301559717}, "episode_len_min": 20, "weights_seq_no": 6.0, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "num_env_steps_sampled": 5000.0, "episode_len_max": 20, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "sample": 0.0048488986613255125, "env_reset_timer": 3.41766078263831e-05, "num_episodes_lifetime": -153875.0, "episode_duration_sec_mean": 0.00452381818834692, "time_between_sampling": 0.0018237664111161464, "num_env_steps_sampled_lifetime": -3077500.0, "rlmodule_inference_timer": 2.7089713016555223e-05, "agent_episode_returns_mean": {"default_agent": 3.7}, "episode_return_min": -9.5, "module_episode_returns_mean": {"default_policy": 3.7}, "env_step_timer": 1.3830240083891556e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_mean": 3.7, "episode_len_mean": 20.0, "episode_return_max": 10.5, "num_env_steps_sampled_lifetime_throughput": 3746.6336242791504}, "learners": {"__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.08218810092535672, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.828140991446602e-06, "add_observations_from_episodes_to_batch": 0.0008729873260999532, "general_advantage_estimation": 0.007331063471518746, "add_one_ts_to_episodes_and_truncate": 0.007663703585171604, "numpy_to_tensor": 7.74400393554362e-05, "batch_individual_items": 0.031565575249525885, "add_time_dim_to_batch_and_zero_pad": 1.5542228715035366e-05, "add_columns_from_episodes_to_train_batch": 0.034500873609070566}}}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime": 220500, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 42000, "num_trainable_parameters": 6003, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 2356308.3685626634, "num_module_steps_trained_throughput": 451159.0769744965, "num_module_steps_trained_lifetime_throughput": 450372.65132070147}, "default_policy": {"vf_loss": 0.10278083384037018, "total_loss": 0.24163073301315308, "vf_explained_var": -0.010732293128967285, "default_optimizer_learning_rate": 0.0002847858517, "mean_kl_loss": 0.00035054117324762046, "gradients_default_optimizer_global_norm": 0.12011439353227615, "vf_loss_unclipped": 28.70351791381836, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.0058320024982094765, "entropy": 0.6365110874176025, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 42000, "policy_loss": 0.17865099012851715, "num_trainable_parameters": 6003, "curr_entropy_coeff": 0.0090570820258, "weights_seq_no": 7.0, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime_throughput": 452179.03966543695}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.763586490365413e-07, "listify_data_for_vector_env": 1.0820193478096178e-05, "un_batch_to_individual_items": 5.381060539966606e-06, "normalize_and_clip_actions": 9.339905045623206e-06, "get_actions": 3.5118521794997135e-05, "tensor_to_numpy": 1.2766828889159295e-05}}, "connector_pipeline_timer": 9.94480228279842e-05}, "episode_len_max": 20, "env_reset_timer": 0.0005019312914992712, "rlmodule_inference_timer": 2.694533825176074e-05, "module_episode_returns_mean": {"default_policy": 0.25}, "env_step_timer": 1.378803795732613e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_in": 10.368238394572801, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.0044497670966666195, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.788982720886764e-06, "numpy_to_tensor": 8.217056048117317e-06, "batch_individual_items": 6.1234614086865826e-06, "add_time_dim_to_batch_and_zero_pad": 2.173713694893691e-06, "add_states_from_episodes_to_batch": 1.5900395404623801e-06}}, "connector_pipeline_timer": 4.234587569669604e-05}, "num_env_steps_sampled_lifetime": 35400, "episode_return_min": -12.5, "episode_return_mean": 0.25, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "num_episodes": 20, "sample": 0.0997976582747884, "num_episodes_lifetime": 140, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "agent_episode_returns_mean": {"default_agent": 0.25}, "episode_len_mean": 20.0, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.368238394572801, "weights_seq_no": 7.0, "time_between_sampling": 1.5732783955601157}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "465d7_00000", "date": "2025-08-11_19-23-49", "timestamp": 1754933029, "time_this_iter_s": 1.5793390274047852, "time_total_s": 11.545197010040283, "pid": 14455, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1614318a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11.545197010040283, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 41.25, "ram_util_percent": 77.25}}
{"timers": {"training_iteration": 1.6874066407428712, "restore_env_runners": 9.48705804610529e-06, "training_step": 1.6872738938860536, "env_runner_sampling_timer": 1.5768271109098726, "learner_update_timer": 0.10718638027358078, "synch_weights": 0.0007983616849795625, "restore_eval_env_runners": 8.69593959473453e-06, "evaluation_iteration": 0.10968098694133345, "synch_eval_env_connectors": 0.00012620225248202594, "synch_env_connectors": 4.362614917530294e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.0512605737338816e-06, "numpy_to_tensor": 8.396696400026554e-06, "batch_individual_items": 6.206452193663482e-06, "add_time_dim_to_batch_and_zero_pad": 2.3267963712673308e-06, "add_states_from_episodes_to_batch": 1.727957435514846e-06}}, "connector_pipeline_timer": 4.357109204495672e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0924276208656398e-05, "un_batch_to_individual_items": 5.300356722702411e-06, "normalize_and_clip_actions": 9.35911338568032e-06, "get_actions": 3.731467581245378e-05, "remove_single_ts_time_rank_from_batch": 5.870851955389302e-07, "tensor_to_numpy": 1.2866156469352093e-05}}, "connector_pipeline_timer": 0.00010220338049667899}, "episode_len_min": 20, "weights_seq_no": 7.0, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "num_env_steps_sampled": 5000.0, "episode_len_max": 20, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "sample": 0.005062298183703808, "env_reset_timer": 3.3397166305250765e-05, "num_episodes_lifetime": -184750.0, "episode_duration_sec_mean": 0.004819612985476851, "time_between_sampling": 0.0015300803463546271, "num_env_steps_sampled_lifetime": -3695000.0, "rlmodule_inference_timer": 4.18743894352578e-05, "agent_episode_returns_mean": {"default_agent": 5.14}, "episode_return_min": -9.5, "module_episode_returns_mean": {"default_policy": 5.14}, "env_step_timer": 1.3653154814123765e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_mean": 5.14, "episode_len_mean": 20.0, "episode_return_max": 10.5, "num_env_steps_sampled_lifetime_throughput": 3763.211388282971}, "learners": {"__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.08217789949588639, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.8219506291469496e-06, "add_observations_from_episodes_to_batch": 0.0008761907835182661, "general_advantage_estimation": 0.007310880757058624, "add_one_ts_to_episodes_and_truncate": 0.007666474458972106, "numpy_to_tensor": 7.738188888603494e-05, "batch_individual_items": 0.03155366908697861, "add_time_dim_to_batch_and_zero_pad": 1.5500976098153904e-05, "add_columns_from_episodes_to_train_batch": 0.03451728070295502}}}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime": 252000, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 48000, "num_trainable_parameters": 6003, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 2354111.9162686556, "num_module_steps_trained_throughput": 450654.5163174492, "num_module_steps_trained_lifetime_throughput": 449892.645548858}, "default_policy": {"vf_loss": 0.10278083384037018, "total_loss": -0.16482774913311005, "vf_explained_var": -0.009645938873291016, "default_optimizer_learning_rate": 0.0002847858517, "mean_kl_loss": 0.0007228472968563437, "gradients_default_optimizer_global_norm": 0.016537001356482506, "vf_loss_unclipped": 28.108274459838867, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.0029160012491047382, "entropy": 0.6174891591072083, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 48000, "policy_loss": -0.22797994315624237, "num_trainable_parameters": 6003, "curr_entropy_coeff": 0.0090570820258, "weights_seq_no": 8.0, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime_throughput": 451599.16303531744}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.811836726329656e-07, "listify_data_for_vector_env": 1.0731408822207845e-05, "un_batch_to_individual_items": 5.3469948726134245e-06, "normalize_and_clip_actions": 9.308538060811963e-06, "get_actions": 3.4186733743076905e-05, "tensor_to_numpy": 1.2563237137347234e-05}}, "connector_pipeline_timer": 9.804556713031611e-05}, "episode_len_max": 20, "env_reset_timer": 0.000497782818742592, "rlmodule_inference_timer": 2.6852578168054163e-05, "module_episode_returns_mean": {"default_policy": 0.45}, "env_step_timer": 1.3673314509571121e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_in": 10.3682383945743, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.0044654796051327135, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.733042888878279e-06, "numpy_to_tensor": 8.341057136480502e-06, "batch_individual_items": 6.033298753041504e-06, "add_time_dim_to_batch_and_zero_pad": 2.148759638745619e-06, "add_states_from_episodes_to_batch": 1.5906559236199398e-06}}, "connector_pipeline_timer": 4.204090208851449e-05}, "num_env_steps_sampled_lifetime": 40400, "episode_return_min": -12.5, "episode_return_mean": 0.45, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "num_episodes": 20, "sample": 0.09978368711250926, "num_episodes_lifetime": 160, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "agent_episode_returns_mean": {"default_agent": 0.45}, "episode_len_mean": 20.0, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.3682383945743, "weights_seq_no": 8.0, "time_between_sampling": 1.5731274066038217}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "465d7_00000", "date": "2025-08-11_19-23-51", "timestamp": 1754933031, "time_this_iter_s": 1.6470389366149902, "time_total_s": 13.192235946655273, "pid": 14455, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1614318a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13.192235946655273, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 38.85, "ram_util_percent": 77.0}}
{"timers": {"training_iteration": 1.6861395055855193, "restore_env_runners": 9.444277501395699e-06, "training_step": 1.686006347447127, "env_runner_sampling_timer": 1.57473712147121, "learner_update_timer": 0.1080046873011469, "synch_weights": 0.0007979997373402603, "restore_eval_env_runners": 8.682320687384936e-06, "evaluation_iteration": 0.10961900374199494, "synch_eval_env_connectors": 0.00012590606967474285, "synch_env_connectors": 4.361068250582555e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.9678958260215277e-06, "numpy_to_tensor": 8.418198532529824e-06, "batch_individual_items": 6.2149480032106395e-06, "add_time_dim_to_batch_and_zero_pad": 2.341362878576541e-06, "add_states_from_episodes_to_batch": 1.7422899322980562e-06}}, "connector_pipeline_timer": 4.369017488020229e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0959777198029086e-05, "un_batch_to_individual_items": 5.298404025711572e-06, "normalize_and_clip_actions": 9.402523594377817e-06, "get_actions": 3.7288357173531216e-05, "remove_single_ts_time_rank_from_batch": 5.870789090515921e-07, "tensor_to_numpy": 1.2869005604323739e-05}}, "connector_pipeline_timer": 0.0001022870146318951}, "episode_len_min": 20, "weights_seq_no": 8.0, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "num_env_steps_sampled": 5000.0, "episode_len_max": 20, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "sample": 0.004888424420910166, "env_reset_timer": 3.432263123466291e-05, "num_episodes_lifetime": -215625.0, "episode_duration_sec_mean": 0.004504063676577062, "time_between_sampling": 0.0015111127007616787, "num_env_steps_sampled_lifetime": -4312500.0, "rlmodule_inference_timer": 2.712102180923258e-05, "agent_episode_returns_mean": {"default_agent": 5.460000000000001}, "episode_return_min": -9.5, "module_episode_returns_mean": {"default_policy": 5.460000000000001}, "env_step_timer": 1.3722399284306327e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_mean": 5.460000000000001, "episode_len_mean": 20.0, "episode_return_max": 10.5, "num_env_steps_sampled_lifetime_throughput": 3758.9814619456674}, "learners": {"__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.08306842175100904, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.820811731163795e-06, "add_observations_from_episodes_to_batch": 0.0008758792857790582, "general_advantage_estimation": 0.007295247368504593, "add_one_ts_to_episodes_and_truncate": 0.00857533929430308, "numpy_to_tensor": 7.734265067790254e-05, "batch_individual_items": 0.0315558507257154, "add_time_dim_to_batch_and_zero_pad": 1.5444305851979234e-05, "add_columns_from_episodes_to_train_batch": 0.034513199976268984}}}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime": 283500, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 54000, "num_trainable_parameters": 6003, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 2343677.4109989535, "num_module_steps_trained_throughput": 448579.48104829027, "num_module_steps_trained_lifetime_throughput": 447842.85662151274}, "default_policy": {"vf_loss": 0.10278083384037018, "total_loss": -0.11885840445756912, "vf_explained_var": -0.009606122970581055, "default_optimizer_learning_rate": 0.0002847858517, "mean_kl_loss": 0.00022714240185450763, "gradients_default_optimizer_global_norm": 0.059866879135370255, "vf_loss_unclipped": 28.079132080078125, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.0014580006245523691, "entropy": 0.6061604619026184, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 54000, "policy_loss": -0.18210962414741516, "num_trainable_parameters": 6003, "curr_entropy_coeff": 0.0090570820258, "weights_seq_no": 9.0, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime_throughput": 449450.5684149496}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.767325589875898e-07, "listify_data_for_vector_env": 1.0684942853861427e-05, "un_batch_to_individual_items": 5.36001792632701e-06, "normalize_and_clip_actions": 9.271042790000633e-06, "get_actions": 3.440081742056242e-05, "tensor_to_numpy": 1.257059303697627e-05}}, "connector_pipeline_timer": 9.813705614894308e-05}, "episode_len_max": 20, "env_reset_timer": 0.0004936012399243254, "rlmodule_inference_timer": 2.6478497271067222e-05, "module_episode_returns_mean": {"default_policy": 0.85}, "env_step_timer": 1.3629800387178646e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.004471625476144254, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.8009954196928077e-06, "numpy_to_tensor": 8.128256383145853e-06, "batch_individual_items": 6.080156945024137e-06, "add_time_dim_to_batch_and_zero_pad": 2.1889150591031373e-06, "add_states_from_episodes_to_batch": 1.6081858271434576e-06}}, "connector_pipeline_timer": 4.203384534838534e-05}, "num_env_steps_sampled_lifetime": 45400, "episode_return_min": -12.5, "episode_return_mean": 0.85, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "num_episodes": 20, "sample": 0.0997543802413388, "num_episodes_lifetime": 180, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "agent_episode_returns_mean": {"default_agent": 0.85}, "episode_len_mean": 20.0, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "weights_seq_no": 9.0, "time_between_sampling": 1.5731977146274088}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "465d7_00000", "date": "2025-08-11_19-23-53", "timestamp": 1754933033, "time_this_iter_s": 1.6654720306396484, "time_total_s": 14.857707977294922, "pid": 14455, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1614318a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 14.857707977294922, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 46.833333333333336, "ram_util_percent": 77.23333333333333}}
{"timers": {"training_iteration": 1.6846669909494418, "restore_env_runners": 9.408175100762091e-06, "training_step": 1.6845334573026012, "env_runner_sampling_timer": 1.5725285010961505, "learner_update_timer": 0.10874264333755736, "synch_weights": 0.0007957105807382796, "restore_eval_env_runners": 8.672167447313088e-06, "evaluation_iteration": 0.10954828453507512, "synch_eval_env_connectors": 0.00012684284874813368, "synch_env_connectors": 4.3537069709872e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.0135890321736916e-06, "numpy_to_tensor": 8.350214095063292e-06, "batch_individual_items": 6.1574289156591116e-06, "add_time_dim_to_batch_and_zero_pad": 2.317885398127455e-06, "add_states_from_episodes_to_batch": 1.7247393201593996e-06}}, "connector_pipeline_timer": 4.338241734436187e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.083937921712888e-05, "un_batch_to_individual_items": 5.23497799308568e-06, "normalize_and_clip_actions": 9.308608152987507e-06, "get_actions": 3.682114533071804e-05, "remove_single_ts_time_rank_from_batch": 5.812260993485072e-07, "tensor_to_numpy": 1.2781813027015917e-05}}, "connector_pipeline_timer": 0.0001013417119998144}, "episode_len_min": 20, "weights_seq_no": 9.0, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "num_env_steps_sampled": 5000.0, "episode_len_max": 20, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "sample": 0.004785290667229871, "env_reset_timer": 3.287606823288008e-05, "num_episodes_lifetime": -246500.0, "episode_duration_sec_mean": 0.004451640326995403, "time_between_sampling": 0.0018493590203392562, "num_env_steps_sampled_lifetime": -4930000.0, "rlmodule_inference_timer": 2.6397673645238802e-05, "agent_episode_returns_mean": {"default_agent": 6.179999999999998}, "episode_return_min": -9.5, "module_episode_returns_mean": {"default_policy": 6.179999999999998}, "env_step_timer": 1.3599281689654803e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_mean": 6.179999999999998, "episode_len_mean": 20.0, "episode_return_max": 10.5, "num_env_steps_sampled_lifetime_throughput": 3801.6837328798483}, "learners": {"__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.08392480587316903, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.81802413967122e-06, "add_observations_from_episodes_to_batch": 0.0008758329934878842, "general_advantage_estimation": 0.007276161554110635, "add_one_ts_to_episodes_and_truncate": 0.008568166740686653, "numpy_to_tensor": 7.738255516045451e-05, "batch_individual_items": 0.0324384276384398, "add_time_dim_to_batch_and_zero_pad": 1.5429032654090668e-05, "add_columns_from_episodes_to_train_batch": 0.03451368297720315}}}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime": 315000, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 60000, "num_trainable_parameters": 6003, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 2336355.5418872004, "num_module_steps_trained_throughput": 447100.39440986444, "num_module_steps_trained_lifetime_throughput": 446387.5083628026}, "default_policy": {"vf_loss": 0.10278083384037018, "total_loss": -0.14074070751667023, "vf_explained_var": -0.009058833122253418, "default_optimizer_learning_rate": 0.0002847858517, "mean_kl_loss": 0.00011014497431460768, "gradients_default_optimizer_global_norm": 0.0812729150056839, "vf_loss_unclipped": 27.982223510742188, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.0007290003122761846, "entropy": 0.5978839993476868, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 60000, "policy_loss": -0.20406639575958252, "num_trainable_parameters": 6003, "curr_entropy_coeff": 0.0090570820258, "weights_seq_no": 10.0, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime_throughput": 447900.56453259254}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.798294811415061e-07, "listify_data_for_vector_env": 1.076151394828788e-05, "un_batch_to_individual_items": 5.278820562286747e-06, "normalize_and_clip_actions": 9.296619148487214e-06, "get_actions": 3.4249283041106595e-05, "tensor_to_numpy": 1.2542815812613701e-05}}, "connector_pipeline_timer": 9.814613161910216e-05}, "episode_len_max": 20, "env_reset_timer": 0.0004894248177093982, "rlmodule_inference_timer": 2.64205230606445e-05, "module_episode_returns_mean": {"default_policy": 0.25}, "env_step_timer": 1.3583662882533558e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.004479527571238578, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7793366275995407e-06, "numpy_to_tensor": 8.220370290975426e-06, "batch_individual_items": 6.0188356212454695e-06, "add_time_dim_to_batch_and_zero_pad": 2.200654464644774e-06, "add_states_from_episodes_to_batch": 1.6161271225972774e-06}}, "connector_pipeline_timer": 4.213520871909687e-05}, "num_env_steps_sampled_lifetime": 50400, "episode_return_min": -12.5, "episode_return_mean": 0.25, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "num_episodes": 20, "sample": 0.09971691477964766, "num_episodes_lifetime": 200, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "agent_episode_returns_mean": {"default_agent": 0.25}, "episode_len_mean": 20.0, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "weights_seq_no": 10.0, "time_between_sampling": 1.5730380445618637}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "465d7_00000", "date": "2025-08-11_19-23-54", "timestamp": 1754933034, "time_this_iter_s": 1.6420331001281738, "time_total_s": 16.499741077423096, "pid": 14455, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1614318a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16.499741077423096, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 47.400000000000006, "ram_util_percent": 77.8}}
{"timers": {"training_iteration": 1.6825098181203462, "restore_env_runners": 9.369512863710182e-06, "training_step": 1.6823756552292406, "env_runner_sampling_timer": 1.5705182910846798, "learner_update_timer": 0.10859419774432832, "synch_weights": 0.0007934922252638633, "restore_eval_env_runners": 8.65253592280882e-06, "evaluation_iteration": 0.10946246626948465, "synch_eval_env_connectors": 0.00012654234031999058, "synch_env_connectors": 4.3510095603274344e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.982000997797666e-06, "numpy_to_tensor": 8.463642206384742e-06, "batch_individual_items": 6.264133104556768e-06, "add_time_dim_to_batch_and_zero_pad": 2.3329738575966516e-06, "add_states_from_episodes_to_batch": 1.7501720312430289e-06}}, "connector_pipeline_timer": 4.379764978718789e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.095662692866143e-05, "un_batch_to_individual_items": 5.311412156686607e-06, "normalize_and_clip_actions": 9.40558275313299e-06, "get_actions": 3.734342647753873e-05, "remove_single_ts_time_rank_from_batch": 5.906768974356066e-07, "tensor_to_numpy": 1.2938412481925939e-05}}, "connector_pipeline_timer": 0.0001025057393692993}, "episode_len_min": 20, "weights_seq_no": 10.0, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "num_env_steps_sampled": 5000.0, "episode_len_max": 20, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "sample": 0.00479995917857806, "env_reset_timer": 3.2871243297156474e-05, "num_episodes_lifetime": -277375.0, "episode_duration_sec_mean": 0.004528302198741584, "time_between_sampling": 0.0018362850818194184, "num_env_steps_sampled_lifetime": -5547500.0, "rlmodule_inference_timer": 2.7591406010282405e-05, "agent_episode_returns_mean": {"default_agent": 4.740000000000002}, "episode_return_min": -9.5, "module_episode_returns_mean": {"default_policy": 4.740000000000002}, "env_step_timer": 1.3778117965549593e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_mean": 4.740000000000002, "episode_len_mean": 20.0, "episode_return_max": 10.5, "num_env_steps_sampled_lifetime_throughput": 3761.5694789187446}, "learners": {"__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.08388597656458747, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.8102643860211046e-06, "add_observations_from_episodes_to_batch": 0.0008751775832265524, "general_advantage_estimation": 0.007262558278433172, "add_one_ts_to_episodes_and_truncate": 0.008558128414103958, "numpy_to_tensor": 7.725872990165778e-05, "batch_individual_items": 0.03241945503217956, "add_time_dim_to_batch_and_zero_pad": 1.536015159256131e-05, "add_columns_from_episodes_to_train_batch": 0.034518990727393756}}}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime": 346500, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 66000, "num_trainable_parameters": 6003, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 2330072.042220355, "num_module_steps_trained_throughput": 445820.8171917205, "num_module_steps_trained_lifetime_throughput": 445131.61482845497}, "default_policy": {"vf_loss": 0.10278083384037018, "total_loss": -0.018643252551555634, "vf_explained_var": -0.010197997093200684, "default_optimizer_learning_rate": 0.0002847858517, "mean_kl_loss": 0.0002990176435559988, "gradients_default_optimizer_global_norm": 0.032687243074178696, "vf_loss_unclipped": 28.26639175415039, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.0003645001561380923, "entropy": 0.5904799699783325, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 66000, "policy_loss": -0.08203604817390442, "num_trainable_parameters": 6003, "curr_entropy_coeff": 0.0090570820258, "weights_seq_no": 11.0, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime_throughput": 446551.44917104125}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.601147586896831e-07, "listify_data_for_vector_env": 1.0750366523176764e-05, "un_batch_to_individual_items": 5.36042140849949e-06, "normalize_and_clip_actions": 9.275387172732163e-06, "get_actions": 3.44290123572195e-05, "tensor_to_numpy": 1.2651675013221476e-05}}, "connector_pipeline_timer": 9.82766185617685e-05}, "episode_len_max": 20, "env_reset_timer": 0.0004853013996159426, "rlmodule_inference_timer": 2.6511229977351796e-05, "module_episode_returns_mean": {"default_policy": 0.45}, "env_step_timer": 1.3576857774884464e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.004477826707297936, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7783054159282867e-06, "numpy_to_tensor": 8.12520015936645e-06, "batch_individual_items": 5.99290622599954e-06, "add_time_dim_to_batch_and_zero_pad": 2.152241168999854e-06, "add_states_from_episodes_to_batch": 1.598522983994143e-06}}, "connector_pipeline_timer": 4.1888543215487934e-05}, "num_env_steps_sampled_lifetime": 55400, "episode_return_min": -12.5, "episode_return_mean": 0.45, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "num_episodes": 20, "sample": 0.09969179063179523, "num_episodes_lifetime": 220, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "agent_episode_returns_mean": {"default_agent": 0.45}, "episode_len_mean": 20.0, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "weights_seq_no": 11.0, "time_between_sampling": 1.5721747636968328}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "465d7_00000", "date": "2025-08-11_19-23-56", "timestamp": 1754933036, "time_this_iter_s": 1.5735118389129639, "time_total_s": 18.07325291633606, "pid": 14455, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1614318a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 18.07325291633606, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 40.0, "ram_util_percent": 77.75}}
{"timers": {"training_iteration": 1.6811799932691587, "restore_env_runners": 9.329567853313796e-06, "training_step": 1.6810456299265377, "env_runner_sampling_timer": 1.5693548285830121, "learner_update_timer": 0.1084292436865565, "synch_weights": 0.0007912748028913448, "restore_eval_env_runners": 8.638090274243097e-06, "evaluation_iteration": 0.10939045702672338, "synch_eval_env_connectors": 0.0001264939971969754, "synch_env_connectors": 4.345419427502848e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.054791086664445e-06, "numpy_to_tensor": 8.432105984280673e-06, "batch_individual_items": 6.2721746243085e-06, "add_time_dim_to_batch_and_zero_pad": 2.3405620448840877e-06, "add_states_from_episodes_to_batch": 1.7420757235835461e-06}}, "connector_pipeline_timer": 4.389155747256108e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0969639613042922e-05, "un_batch_to_individual_items": 5.333617163764384e-06, "normalize_and_clip_actions": 9.383256142213733e-06, "get_actions": 3.735832682203896e-05, "remove_single_ts_time_rank_from_batch": 5.869897736747556e-07, "tensor_to_numpy": 1.2930860472458375e-05}}, "connector_pipeline_timer": 0.00010250976899140632}, "episode_len_min": 20, "weights_seq_no": 11.0, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "num_env_steps_sampled": 5000.0, "episode_len_max": 20, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "sample": 0.004830872283207082, "env_reset_timer": 3.373596879595332e-05, "num_episodes_lifetime": -308250.0, "episode_duration_sec_mean": 0.004512110004667191, "time_between_sampling": 0.0018158458235963335, "num_env_steps_sampled_lifetime": -6165000.0, "rlmodule_inference_timer": 2.702201794093116e-05, "agent_episode_returns_mean": {"default_agent": 5.619999999999999}, "episode_return_min": -9.5, "module_episode_returns_mean": {"default_policy": 5.619999999999999}, "env_step_timer": 1.3736295644679226e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_mean": 5.619999999999999, "episode_len_mean": 20.0, "episode_return_max": 10.5, "num_env_steps_sampled_lifetime_throughput": 3743.5762954551155}, "learners": {"__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.08382346554858293, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.8429923164200555e-06, "add_observations_from_episodes_to_batch": 0.0008752524671537935, "general_advantage_estimation": 0.007244205196214115, "add_one_ts_to_episodes_and_truncate": 0.008548552130118337, "numpy_to_tensor": 7.711780166149519e-05, "batch_individual_items": 0.032393332572230205, "add_time_dim_to_batch_and_zero_pad": 1.530364045503936e-05, "add_columns_from_episodes_to_train_batch": 0.03451110832100562}}}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime": 378000, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 72000, "num_trainable_parameters": 6003, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 2322254.7980399923, "num_module_steps_trained_throughput": 444251.04710883787, "num_module_steps_trained_lifetime_throughput": 443585.05249625235}, "default_policy": {"vf_loss": 0.10278083384037018, "total_loss": 0.02147681638598442, "vf_explained_var": -0.009987235069274902, "default_optimizer_learning_rate": 0.0002847858517, "mean_kl_loss": 0.0009873730596154928, "gradients_default_optimizer_global_norm": 0.07592751830816269, "vf_loss_unclipped": 28.210323333740234, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 0.00018225007806904614, "entropy": 0.5664700865745544, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 72000, "policy_loss": -0.04213358461856842, "num_trainable_parameters": 6003, "curr_entropy_coeff": 0.0090570820258, "weights_seq_no": 12.0, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime_throughput": 444913.2516761374}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.870793931534275e-07, "listify_data_for_vector_env": 1.123224653231296e-05, "un_batch_to_individual_items": 5.569732792461257e-06, "normalize_and_clip_actions": 9.677136432153468e-06, "get_actions": 3.6734195934350034e-05, "tensor_to_numpy": 1.3207584059792156e-05}}, "connector_pipeline_timer": 0.00010334892874134764}, "episode_len_max": 20, "env_reset_timer": 0.00048112838614102583, "rlmodule_inference_timer": 2.7643665192058753e-05, "module_episode_returns_mean": {"default_policy": 0.45}, "env_step_timer": 1.426473041975902e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.00446464337175712, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.9006889475998745e-06, "numpy_to_tensor": 8.634839141291627e-06, "batch_individual_items": 6.309005095260825e-06, "add_time_dim_to_batch_and_zero_pad": 2.257013598980312e-06, "add_states_from_episodes_to_batch": 1.6307283033648016e-06}}, "connector_pipeline_timer": 4.364814623053468e-05}, "num_env_steps_sampled_lifetime": 60400, "episode_return_min": -12.5, "episode_return_mean": 0.45, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "num_episodes": 20, "sample": 0.09967788272625937, "num_episodes_lifetime": 240, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "agent_episode_returns_mean": {"default_agent": 0.45}, "episode_len_mean": 20.0, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "weights_seq_no": 12.0, "time_between_sampling": 1.5721151652298124}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "465d7_00000", "date": "2025-08-11_19-23-58", "timestamp": 1754933038, "time_this_iter_s": 1.6549599170684814, "time_total_s": 19.72821283340454, "pid": 14455, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1614318a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 19.72821283340454, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 40.7, "ram_util_percent": 77.80000000000001}}
{"timers": {"training_iteration": 1.6798630341661003, "restore_env_runners": 9.291272593577793e-06, "training_step": 1.6797282244572453, "env_runner_sampling_timer": 1.5682064469665955, "learner_update_timer": 0.10825816749900972, "synch_weights": 0.0007900049750603504, "restore_eval_env_runners": 8.61836878477877e-06, "evaluation_iteration": 0.10932814828702893, "synch_eval_env_connectors": 0.0001266173972492832, "synch_env_connectors": 4.3428048922779265e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.9626871129947723e-06, "numpy_to_tensor": 8.409399509029437e-06, "batch_individual_items": 6.2412651269098165e-06, "add_time_dim_to_batch_and_zero_pad": 2.329405984163398e-06, "add_states_from_episodes_to_batch": 1.7296662650523272e-06}}, "connector_pipeline_timer": 4.3623319779534e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.095836123201956e-05, "un_batch_to_individual_items": 5.279240999332683e-06, "normalize_and_clip_actions": 9.34396888893941e-06, "get_actions": 3.713159505243027e-05, "remove_single_ts_time_rank_from_batch": 5.829534388527863e-07, "tensor_to_numpy": 1.2865441313311195e-05}}, "connector_pipeline_timer": 0.00010199806223852283}, "episode_len_min": 20, "weights_seq_no": 12.0, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "num_env_steps_sampled": 5000.0, "episode_len_max": 20, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "sample": 0.0047967998073515815, "env_reset_timer": 3.392813263361515e-05, "num_episodes_lifetime": -339125.0, "episode_duration_sec_mean": 0.004485486497171225, "time_between_sampling": 0.0016876388393093909, "num_env_steps_sampled_lifetime": -6782500.0, "rlmodule_inference_timer": 2.6698330339281205e-05, "agent_episode_returns_mean": {"default_agent": 6.419999999999999}, "episode_return_min": -9.5, "module_episode_returns_mean": {"default_policy": 6.419999999999999}, "env_step_timer": 1.3723825968506107e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_mean": 6.419999999999999, "episode_len_mean": 20.0, "episode_return_max": 10.5, "num_env_steps_sampled_lifetime_throughput": 3759.667719055439}, "learners": {"__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.08376163547319847, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.829561419464971e-06, "add_observations_from_episodes_to_batch": 0.0008747191121678726, "general_advantage_estimation": 0.007224256894369694, "add_one_ts_to_episodes_and_truncate": 0.008541006188313313, "numpy_to_tensor": 7.702579412487823e-05, "batch_individual_items": 0.03236792465697939, "add_time_dim_to_batch_and_zero_pad": 1.5230184400336641e-05, "add_columns_from_episodes_to_train_batch": 0.03450346973760944}}}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime": 409500, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 78000, "num_trainable_parameters": 6003, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 2315951.7536093043, "num_module_steps_trained_throughput": 442973.0768927463, "num_module_steps_trained_lifetime_throughput": 442328.5990036826}, "default_policy": {"vf_loss": 0.10278083384037018, "total_loss": 0.0764087438583374, "vf_explained_var": -0.010016202926635742, "default_optimizer_learning_rate": 0.0002847858517, "mean_kl_loss": 0.00015232563600875437, "gradients_default_optimizer_global_norm": 0.03824322298169136, "vf_loss_unclipped": 28.251325607299805, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 9.112503903452307e-05, "entropy": 0.5557562112808228, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 78000, "policy_loss": 0.012701627798378468, "num_trainable_parameters": 6003, "curr_entropy_coeff": 0.0090570820258, "weights_seq_no": 13.0, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime_throughput": 443565.2002570501}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.587102763775418e-07, "listify_data_for_vector_env": 1.0591246370743372e-05, "un_batch_to_individual_items": 5.281944549383872e-06, "normalize_and_clip_actions": 9.17677081719012e-06, "get_actions": 3.391798609702429e-05, "tensor_to_numpy": 1.2479304824482225e-05}}, "connector_pipeline_timer": 9.720383624858901e-05}, "episode_len_max": 20, "env_reset_timer": 0.00047707627220461984, "rlmodule_inference_timer": 2.614096750510967e-05, "module_episode_returns_mean": {"default_policy": 0.85}, "env_step_timer": 1.3438706587331684e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.004435332952998579, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.718543880065347e-06, "numpy_to_tensor": 8.037147967431423e-06, "batch_individual_items": 5.925019001052234e-06, "add_time_dim_to_batch_and_zero_pad": 2.1346831729897093e-06, "add_states_from_episodes_to_batch": 1.568437167254797e-06}}, "connector_pipeline_timer": 4.1349228693270674e-05}, "num_env_steps_sampled_lifetime": 65400, "episode_return_min": -12.5, "episode_return_mean": 0.85, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "num_episodes": 20, "sample": 0.09963130389907612, "num_episodes_lifetime": 260, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "agent_episode_returns_mean": {"default_agent": 0.85}, "episode_len_mean": 20.0, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "weights_seq_no": 13.0, "time_between_sampling": 1.572057487327979}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "465d7_00000", "date": "2025-08-11_19-23-59", "timestamp": 1754933039, "time_this_iter_s": 1.6518499851226807, "time_total_s": 21.38006281852722, "pid": 14455, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1614318a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 21.38006281852722, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 41.699999999999996, "ram_util_percent": 77.6}}
{"timers": {"training_iteration": 1.678489369655192, "restore_env_runners": 9.252938862974138e-06, "training_step": 1.6783541326329334, "env_runner_sampling_timer": 1.5661270391666113, "learner_update_timer": 0.10896417707409838, "synch_weights": 0.000787424925073489, "restore_eval_env_runners": 8.598844510209085e-06, "evaluation_iteration": 0.10923459346424262, "synch_eval_env_connectors": 0.00012641038268045723, "synch_env_connectors": 4.3364667648892085e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.9482161081406333e-06, "numpy_to_tensor": 8.416147018351317e-06, "batch_individual_items": 6.191793624006191e-06, "add_time_dim_to_batch_and_zero_pad": 2.312165025520588e-06, "add_states_from_episodes_to_batch": 1.731971624663159e-06}}, "connector_pipeline_timer": 4.343952530697659e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0919446869703542e-05, "un_batch_to_individual_items": 5.241609939739157e-06, "normalize_and_clip_actions": 9.337273045164416e-06, "get_actions": 3.719447206320274e-05, "remove_single_ts_time_rank_from_batch": 5.787480044775735e-07, "tensor_to_numpy": 1.2802634800696433e-05}}, "connector_pipeline_timer": 0.00010183678371650928}, "episode_len_min": 20, "weights_seq_no": 13.0, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "num_env_steps_sampled": 5000.0, "episode_len_max": 20, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "sample": 0.004800484858413947, "env_reset_timer": 3.35552738284092e-05, "num_episodes_lifetime": -370000.0, "episode_duration_sec_mean": 0.004482885998208077, "time_between_sampling": 0.001676403797067987, "num_env_steps_sampled_lifetime": -7400000.0, "rlmodule_inference_timer": 2.719437698748515e-05, "agent_episode_returns_mean": {"default_agent": 6.74}, "episode_return_min": -9.5, "module_episode_returns_mean": {"default_policy": 6.74}, "env_step_timer": 1.3602439041949946e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_mean": 6.74, "episode_len_mean": 20.0, "episode_return_max": 10.5, "num_env_steps_sampled_lifetime_throughput": 3781.588545988594}, "learners": {"__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.08457950786959667, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.817096036877281e-06, "add_observations_from_episodes_to_batch": 0.0008742427605082506, "general_advantage_estimation": 0.007205954745464995, "add_one_ts_to_episodes_and_truncate": 0.0085311027863533, "numpy_to_tensor": 7.678928646436732e-05, "batch_individual_items": 0.033215852489859636, "add_time_dim_to_batch_and_zero_pad": 1.5155382564379902e-05, "add_columns_from_episodes_to_train_batch": 0.034503075039326835}}}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime": 441000, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 84000, "num_trainable_parameters": 6003, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 2311337.5130335796, "num_module_steps_trained_throughput": 442018.6404047689, "num_module_steps_trained_lifetime_throughput": 441395.1672725481}, "default_policy": {"vf_loss": 0.10278083384037018, "total_loss": -0.13544487953186035, "vf_explained_var": -0.008661389350891113, "default_optimizer_learning_rate": 0.0002847858517, "mean_kl_loss": 5.350949504645541e-05, "gradients_default_optimizer_global_norm": 0.028520269319415092, "vf_loss_unclipped": 27.92440414428711, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 4.5562519517261535e-05, "entropy": 0.5543418526649475, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 84000, "policy_loss": -0.1991647630929947, "num_trainable_parameters": 6003, "curr_entropy_coeff": 0.0090570820258, "weights_seq_no": 14.0, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime_throughput": 442540.5656229432}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.743885111608813e-07, "listify_data_for_vector_env": 1.0634314719979822e-05, "un_batch_to_individual_items": 5.223356529837188e-06, "normalize_and_clip_actions": 9.190291074434222e-06, "get_actions": 3.405263379133952e-05, "tensor_to_numpy": 1.2432462617968966e-05}}, "connector_pipeline_timer": 9.725456810154472e-05}, "episode_len_max": 20, "env_reset_timer": 0.0004730117593305818, "rlmodule_inference_timer": 2.6140337886688234e-05, "module_episode_returns_mean": {"default_policy": 1.25}, "env_step_timer": 1.3375337335535656e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.004427665848052129, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.746426924333151e-06, "numpy_to_tensor": 8.10717192718664e-06, "batch_individual_items": 5.928821450994436e-06, "add_time_dim_to_batch_and_zero_pad": 2.1467401506493108e-06, "add_states_from_episodes_to_batch": 1.5904596103622297e-06}}, "connector_pipeline_timer": 4.159373323829981e-05}, "num_env_steps_sampled_lifetime": 70400, "episode_return_min": -12.5, "episode_return_mean": 1.25, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "num_episodes": 20, "sample": 0.09959281877971382, "num_episodes_lifetime": 280, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "agent_episode_returns_mean": {"default_agent": 1.25}, "episode_len_mean": 20.0, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "weights_seq_no": 14.0, "time_between_sampling": 1.571929717874282}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "465d7_00000", "date": "2025-08-11_19-24-01", "timestamp": 1754933041, "time_this_iter_s": 1.6455721855163574, "time_total_s": 23.02563500404358, "pid": 14455, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1614318a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 23.02563500404358, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 41.5, "ram_util_percent": 77.8}}
{"timers": {"training_iteration": 1.6772859742991106, "restore_env_runners": 9.2150001112087e-06, "training_step": 1.6771504454669186, "env_runner_sampling_timer": 1.5641488179450127, "learner_update_timer": 0.10973988196326359, "synch_weights": 0.0007851690049826695, "restore_eval_env_runners": 8.583686639366155e-06, "evaluation_iteration": 0.10914950419929102, "synch_eval_env_connectors": 0.0001261104491754748, "synch_env_connectors": 4.332691455734002e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.056607947844817e-06, "numpy_to_tensor": 8.44563672321107e-06, "batch_individual_items": 6.2749002630077025e-06, "add_time_dim_to_batch_and_zero_pad": 2.3430927185979105e-06, "add_states_from_episodes_to_batch": 1.7514343253929195e-06}}, "connector_pipeline_timer": 4.3846928334620615e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1011273843320051e-05, "un_batch_to_individual_items": 5.349426290241019e-06, "normalize_and_clip_actions": 9.392318114918069e-06, "get_actions": 3.724925157348097e-05, "remove_single_ts_time_rank_from_batch": 5.919845263767505e-07, "tensor_to_numpy": 1.288679717631859e-05}}, "connector_pipeline_timer": 0.00010235248073359834}, "episode_len_min": 20, "weights_seq_no": 14.0, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "num_env_steps_sampled": 5000.0, "episode_len_max": 20, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "sample": 0.00480507140737558, "env_reset_timer": 3.337863495142782e-05, "num_episodes_lifetime": -400875.0, "episode_duration_sec_mean": 0.004502744368277489, "time_between_sampling": 0.0018173129804767139, "num_env_steps_sampled_lifetime": -8017500.0, "rlmodule_inference_timer": 2.672847774320115e-05, "agent_episode_returns_mean": {"default_agent": 5.299999999999998}, "episode_return_min": -9.5, "module_episode_returns_mean": {"default_policy": 5.299999999999998}, "env_step_timer": 1.376281759758418e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_mean": 5.299999999999998, "episode_len_mean": 20.0, "episode_return_max": 10.5, "num_env_steps_sampled_lifetime_throughput": 3759.720096010334}, "learners": {"__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.08546524112102935, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.8122559473007783e-06, "add_observations_from_episodes_to_batch": 0.0008736707431953912, "general_advantage_estimation": 0.007186508538095717, "add_one_ts_to_episodes_and_truncate": 0.008520394678120474, "numpy_to_tensor": 7.67038935579259e-05, "batch_individual_items": 0.034134539794451614, "add_time_dim_to_batch_and_zero_pad": 1.5122578187765669e-05, "add_columns_from_episodes_to_train_batch": 0.034501489699187045}}}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime": 472500, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 90000, "num_trainable_parameters": 6003, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 2307744.125344959, "num_module_steps_trained_throughput": 441260.39875909535, "num_module_steps_trained_lifetime_throughput": 440657.9444323897}, "default_policy": {"vf_loss": 0.10278083384037018, "total_loss": 0.11288011074066162, "vf_explained_var": -0.010147690773010254, "default_optimizer_learning_rate": 0.0002847858517, "mean_kl_loss": 8.566788892494515e-05, "gradients_default_optimizer_global_norm": 0.03713970631361008, "vf_loss_unclipped": 28.36760139465332, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 2.2781259758630767e-05, "entropy": 0.5600871443748474, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 90000, "policy_loss": 0.049212247133255005, "num_trainable_parameters": 6003, "curr_entropy_coeff": 0.0090570820258, "weights_seq_no": 15.0, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime_throughput": 441715.72833972116}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.654072608091928e-07, "listify_data_for_vector_env": 1.0784993076682096e-05, "un_batch_to_individual_items": 5.44472679974142e-06, "normalize_and_clip_actions": 9.32657455368745e-06, "get_actions": 3.509519594495074e-05, "tensor_to_numpy": 1.2749609614300544e-05}}, "connector_pipeline_timer": 9.981991218559071e-05}, "episode_len_max": 20, "env_reset_timer": 0.00046903539136489603, "rlmodule_inference_timer": 2.6908814787315814e-05, "module_episode_returns_mean": {"default_policy": 2.25}, "env_step_timer": 1.3713285247584551e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.0044372546067461376, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.9010166245874953e-06, "numpy_to_tensor": 8.073302468314908e-06, "batch_individual_items": 5.98676601925046e-06, "add_time_dim_to_batch_and_zero_pad": 2.2430592968298927e-06, "add_states_from_episodes_to_batch": 1.6224133634830745e-06}}, "connector_pipeline_timer": 4.3014104297355656e-05}, "num_env_steps_sampled_lifetime": 75400, "episode_return_min": -12.5, "episode_return_mean": 2.25, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "num_episodes": 20, "sample": 0.09956788142201775, "num_episodes_lifetime": 300, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "agent_episode_returns_mean": {"default_agent": 2.25}, "episode_len_mean": 20.0, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "weights_seq_no": 15.0, "time_between_sampling": 1.571961271105507}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "465d7_00000", "date": "2025-08-11_19-24-03", "timestamp": 1754933043, "time_this_iter_s": 1.6625442504882812, "time_total_s": 24.68817925453186, "pid": 14455, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1614318a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 24.68817925453186, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 39.833333333333336, "ram_util_percent": 77.43333333333334}}
{"timers": {"training_iteration": 1.6752326391457197, "restore_env_runners": 9.191190560621896e-06, "training_step": 1.6750966247624541, "env_runner_sampling_timer": 1.5622615718455934, "learner_update_timer": 0.10957302564362209, "synch_weights": 0.0007842660651661205, "restore_eval_env_runners": 8.562009749290973e-06, "evaluation_iteration": 0.10907772540730981, "synch_eval_env_connectors": 0.00012580434380648868, "synch_env_connectors": 4.32728450395535e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.0045824242240497e-06, "numpy_to_tensor": 8.472257103535549e-06, "batch_individual_items": 6.275281728363093e-06, "add_time_dim_to_batch_and_zero_pad": 2.341303377999397e-06, "add_states_from_episodes_to_batch": 1.7586948797640567e-06}}, "connector_pipeline_timer": 4.394774578390118e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0981666678978523e-05, "un_batch_to_individual_items": 5.351487899033983e-06, "normalize_and_clip_actions": 9.41226076270668e-06, "get_actions": 3.7604434369565376e-05, "remove_single_ts_time_rank_from_batch": 5.919086749681973e-07, "tensor_to_numpy": 1.2971526313739927e-05}}, "connector_pipeline_timer": 0.00010289042644059842}, "episode_len_min": 20, "weights_seq_no": 15.0, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "num_env_steps_sampled": 5000.0, "episode_len_max": 20, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "sample": 0.0048120172783351015, "env_reset_timer": 3.393637205457874e-05, "num_episodes_lifetime": -431750.0, "episode_duration_sec_mean": 0.004528405189979822, "time_between_sampling": 0.0018602122560114718, "num_env_steps_sampled_lifetime": -8635000.0, "rlmodule_inference_timer": 2.7198227505085788e-05, "agent_episode_returns_mean": {"default_agent": 7.2200000000000015}, "episode_return_min": -9.5, "module_episode_returns_mean": {"default_policy": 7.2200000000000015}, "env_step_timer": 1.3800293502565066e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_mean": 7.2200000000000015, "episode_len_mean": 20.0, "episode_return_max": 10.5, "num_env_steps_sampled_lifetime_throughput": 3747.1704256551225}, "learners": {"__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.08539828204060432, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.8037133569507765e-06, "add_observations_from_episodes_to_batch": 0.0008731148757043428, "general_advantage_estimation": 0.007168520532341305, "add_one_ts_to_episodes_and_truncate": 0.00851289073159557, "numpy_to_tensor": 7.648518475799011e-05, "batch_individual_items": 0.034098562315425004, "add_time_dim_to_batch_and_zero_pad": 1.505302241076248e-05, "add_columns_from_episodes_to_train_batch": 0.03449745814247903}}}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime": 504000, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 96000, "num_trainable_parameters": 6003, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 2302714.7657071818, "num_module_steps_trained_throughput": 440232.5831983892, "num_module_steps_trained_lifetime_throughput": 439650.20295629307}, "default_policy": {"vf_loss": 0.10278083384037018, "total_loss": 0.11603890359401703, "vf_explained_var": -0.009708046913146973, "default_optimizer_learning_rate": 0.0002847858517, "mean_kl_loss": 0.0002683716011233628, "gradients_default_optimizer_global_norm": 0.02891549840569496, "vf_loss_unclipped": 28.182588577270508, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 1.1390629879315384e-05, "entropy": 0.5402327179908752, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 96000, "policy_loss": 0.05219123512506485, "num_trainable_parameters": 6003, "curr_entropy_coeff": 0.0090570820258, "weights_seq_no": 16.0, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime_throughput": 440628.02631817723}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.258795857823942e-07, "listify_data_for_vector_env": 1.1808778479832917e-05, "un_batch_to_individual_items": 5.8381406172483e-06, "normalize_and_clip_actions": 1.0064095018900692e-05, "get_actions": 4.012465841186768e-05, "tensor_to_numpy": 1.4039790131031225e-05}}, "connector_pipeline_timer": 0.00011001294544747254}, "episode_len_max": 20, "env_reset_timer": 0.00046507378805265794, "rlmodule_inference_timer": 3.0422040736128996e-05, "module_episode_returns_mean": {"default_policy": 1.65}, "env_step_timer": 1.5592405468007743e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.00453914919635281, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.108796085901223e-06, "numpy_to_tensor": 9.181730807844567e-06, "batch_individual_items": 6.7567621641812e-06, "add_time_dim_to_batch_and_zero_pad": 2.411045714273085e-06, "add_states_from_episodes_to_batch": 1.7285582430320281e-06}}, "connector_pipeline_timer": 4.621101149251134e-05}, "num_env_steps_sampled_lifetime": 80400, "episode_return_min": -12.5, "episode_return_mean": 1.65, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "num_episodes": 20, "sample": 0.09965893302815419, "num_episodes_lifetime": 320, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "agent_episode_returns_mean": {"default_agent": 1.65}, "episode_len_mean": 20.0, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "weights_seq_no": 16.0, "time_between_sampling": 1.571124705063872}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "465d7_00000", "date": "2025-08-11_19-24-04", "timestamp": 1754933044, "time_this_iter_s": 1.5880281925201416, "time_total_s": 26.276207447052002, "pid": 14455, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1614318a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 26.276207447052002, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 43.95, "ram_util_percent": 77.95}}
{"timers": {"training_iteration": 1.674217461914385, "restore_env_runners": 9.16761910554096e-06, "training_step": 1.6740810081047883, "env_runner_sampling_timer": 1.5614347661276426, "learner_update_timer": 0.10938489704776903, "synch_weights": 0.0007829463237986391, "restore_eval_env_runners": 8.547639321215801e-06, "evaluation_iteration": 0.1091234448233152, "synch_eval_env_connectors": 0.0001255046301335499, "synch_env_connectors": 4.3315126026808406e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.0896616335888674e-06, "numpy_to_tensor": 8.642806761798305e-06, "batch_individual_items": 6.3571473368350214e-06, "add_time_dim_to_batch_and_zero_pad": 2.378472183970788e-06, "add_states_from_episodes_to_batch": 1.768698981075361e-06}}, "connector_pipeline_timer": 4.4582490644547676e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1165927095985197e-05, "un_batch_to_individual_items": 5.421334248896825e-06, "normalize_and_clip_actions": 9.571116064286019e-06, "get_actions": 3.833718212017736e-05, "remove_single_ts_time_rank_from_batch": 5.977313894143165e-07, "tensor_to_numpy": 1.3170802739043592e-05}}, "connector_pipeline_timer": 0.0001045756400456277}, "episode_len_min": 20, "weights_seq_no": 16.0, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "num_env_steps_sampled": 5000.0, "episode_len_max": 20, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "sample": 0.005137109995299599, "env_reset_timer": 3.601282444852008e-05, "num_episodes_lifetime": -462625.0, "episode_duration_sec_mean": 0.0049391353093087694, "time_between_sampling": 0.001579112004973286, "num_env_steps_sampled_lifetime": -9252500.0, "rlmodule_inference_timer": 4.3247564419196704e-05, "agent_episode_returns_mean": {"default_agent": 7.299999999999996}, "episode_return_min": -9.5, "module_episode_returns_mean": {"default_policy": 7.299999999999996}, "env_step_timer": 1.4033442811721917e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_mean": 7.299999999999996, "episode_len_mean": 20.0, "episode_return_max": 10.5, "num_env_steps_sampled_lifetime_throughput": 3677.2485281277573}, "learners": {"__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.08532624838035319, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.7935961100150226e-06, "add_observations_from_episodes_to_batch": 0.0008747820668931223, "general_advantage_estimation": 0.007149513247338895, "add_one_ts_to_episodes_and_truncate": 0.008503340994650088, "numpy_to_tensor": 7.632616290181046e-05, "batch_individual_items": 0.03405742544227157, "add_time_dim_to_batch_and_zero_pad": 1.4989992270846415e-05, "add_columns_from_episodes_to_train_batch": 0.03449427398082465}}}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime": 535500, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 102000, "num_trainable_parameters": 6003, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 2301209.3505941965, "num_module_steps_trained_throughput": 439881.75732529815, "num_module_steps_trained_lifetime_throughput": 439317.5254777034}, "default_policy": {"vf_loss": 0.10278083384037018, "total_loss": 0.005944760516285896, "vf_explained_var": -0.00909113883972168, "default_optimizer_learning_rate": 0.0002847858517, "mean_kl_loss": 1.595735375303775e-05, "gradients_default_optimizer_global_norm": 0.05952993407845497, "vf_loss_unclipped": 28.024700164794922, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 5.695314939657692e-06, "entropy": 0.5353696346282959, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 102000, "policy_loss": -0.057946957647800446, "num_trainable_parameters": 6003, "curr_entropy_coeff": 0.0090570820258, "weights_seq_no": 17.0, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime_throughput": 440221.53638008254}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.76218311589908e-07, "listify_data_for_vector_env": 1.0861512772528028e-05, "un_batch_to_individual_items": 5.4163375995509465e-06, "normalize_and_clip_actions": 9.301538721874357e-06, "get_actions": 3.449342544800538e-05, "tensor_to_numpy": 1.276243288319141e-05}}, "connector_pipeline_timer": 9.894925228620777e-05}, "episode_len_max": 20, "env_reset_timer": 0.00046119554965148483, "rlmodule_inference_timer": 2.659602264032964e-05, "module_episode_returns_mean": {"default_policy": 1.45}, "env_step_timer": 1.3609421898392342e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.004528435029787943, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.78917542228596e-06, "numpy_to_tensor": 8.210553286320703e-06, "batch_individual_items": 6.224738142914901e-06, "add_time_dim_to_batch_and_zero_pad": 2.17718059379013e-06, "add_states_from_episodes_to_batch": 1.5947380435218936e-06}}, "connector_pipeline_timer": 4.2073152858663846e-05}, "num_env_steps_sampled_lifetime": 85400, "episode_return_min": -12.5, "episode_return_mean": 1.45, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "num_episodes": 20, "sample": 0.09963612911851955, "num_episodes_lifetime": 340, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "agent_episode_returns_mean": {"default_agent": 1.45}, "episode_len_mean": 20.0, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "weights_seq_no": 17.0, "time_between_sampling": 1.5713422084239093}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "465d7_00000", "date": "2025-08-11_19-24-06", "timestamp": 1754933046, "time_this_iter_s": 1.6781947612762451, "time_total_s": 27.954402208328247, "pid": 14455, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1614318a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 27.954402208328247, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 43.8, "ram_util_percent": 77.69999999999999}}
{"timers": {"training_iteration": 1.6729080827152973, "restore_env_runners": 9.134273975640153e-06, "training_step": 1.672771065104317, "env_runner_sampling_timer": 1.5594315476359515, "learner_update_timer": 0.11007574473659741, "synch_weights": 0.0007824981111768158, "restore_eval_env_runners": 8.52049282500503e-06, "evaluation_iteration": 0.10905279412529646, "synch_eval_env_connectors": 0.00012520958415720876, "synch_env_connectors": 4.3269474806773455e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.9622756446501386e-06, "numpy_to_tensor": 8.404029789551857e-06, "batch_individual_items": 6.272032835444484e-06, "add_time_dim_to_batch_and_zero_pad": 2.3197941011052586e-06, "add_states_from_episodes_to_batch": 1.737130252328286e-06}}, "connector_pipeline_timer": 4.3546571534635665e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0911925606491634e-05, "un_batch_to_individual_items": 5.271919698859631e-06, "normalize_and_clip_actions": 9.336617387272035e-06, "get_actions": 3.6907699638625115e-05, "remove_single_ts_time_rank_from_batch": 5.832429776948568e-07, "tensor_to_numpy": 1.2835565961769883e-05}}, "connector_pipeline_timer": 0.00010159270742823855}, "episode_len_min": 20, "weights_seq_no": 17.0, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "num_env_steps_sampled": 5000.0, "episode_len_max": 20, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "sample": 0.00492923941024206, "env_reset_timer": 3.4454284863025596e-05, "num_episodes_lifetime": -493500.0, "episode_duration_sec_mean": 0.004480692205019295, "time_between_sampling": 0.001486361896767741, "num_env_steps_sampled_lifetime": -9870000.0, "rlmodule_inference_timer": 2.694083478080144e-05, "agent_episode_returns_mean": {"default_agent": 6.980000000000003}, "episode_return_min": -9.5, "module_episode_returns_mean": {"default_policy": 6.980000000000003}, "env_step_timer": 1.3648278208287884e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_mean": 6.980000000000003, "episode_len_mean": 20.0, "episode_return_max": 10.5, "num_env_steps_sampled_lifetime_throughput": 3776.951923524209}, "learners": {"__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.0861325808966416, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.7810701212100375e-06, "add_observations_from_episodes_to_batch": 0.000873838416242253, "general_advantage_estimation": 0.007130713115642526, "add_one_ts_to_episodes_and_truncate": 0.00849312341515223, "numpy_to_tensor": 7.609707181284202e-05, "batch_individual_items": 0.03490145493785608, "add_time_dim_to_batch_and_zero_pad": 1.491551317853675e-05, "add_columns_from_episodes_to_train_batch": 0.03448753999090673}}}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime": 567000, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 108000, "num_trainable_parameters": 6003, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 2302203.72151857, "num_module_steps_trained_throughput": 440010.63572418975, "num_module_steps_trained_lifetime_throughput": 439463.0676474932}, "default_policy": {"vf_loss": 0.10278083384037018, "total_loss": 0.06610782444477081, "vf_explained_var": -0.009521961212158203, "default_optimizer_learning_rate": 0.0002847858517, "mean_kl_loss": 2.4402635972364806e-05, "gradients_default_optimizer_global_norm": 0.08836914598941803, "vf_loss_unclipped": 28.1092586517334, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 2.847657469828846e-06, "entropy": 0.5365307331085205, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 108000, "policy_loss": 0.00222662091255188, "num_trainable_parameters": 6003, "curr_entropy_coeff": 0.0090570820258, "weights_seq_no": 18.0, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime_throughput": 440297.72915285354}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.707230512725757e-07, "listify_data_for_vector_env": 1.0755860393024492e-05, "un_batch_to_individual_items": 5.317762310291706e-06, "normalize_and_clip_actions": 9.333023792942877e-06, "get_actions": 3.4026129526932456e-05, "tensor_to_numpy": 1.2515666678678184e-05}}, "connector_pipeline_timer": 9.784753645567592e-05}, "episode_len_max": 20, "env_reset_timer": 0.00045735817514027765, "rlmodule_inference_timer": 2.644523746653655e-05, "module_episode_returns_mean": {"default_policy": 1.45}, "env_step_timer": 1.352625754441688e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.004551953782793134, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.73613085874218e-06, "numpy_to_tensor": 8.197359588600278e-06, "batch_individual_items": 5.9731118537788e-06, "add_time_dim_to_batch_and_zero_pad": 2.1382635822451565e-06, "add_states_from_episodes_to_batch": 1.5943441947883085e-06}}, "connector_pipeline_timer": 4.188674037774237e-05}, "num_env_steps_sampled_lifetime": 90400, "episode_return_min": -12.5, "episode_return_mean": 1.45, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "num_episodes": 20, "sample": 0.09961658032807381, "num_episodes_lifetime": 360, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "agent_episode_returns_mean": {"default_agent": 1.45}, "episode_len_mean": 20.0, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "weights_seq_no": 18.0, "time_between_sampling": 1.5712271525897212}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "465d7_00000", "date": "2025-08-11_19-24-07", "timestamp": 1754933047, "time_this_iter_s": 1.648284912109375, "time_total_s": 29.602687120437622, "pid": 14455, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1614318a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 29.602687120437622, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 40.13333333333333, "ram_util_percent": 77.5}}
{"timers": {"training_iteration": 1.671930502298405, "restore_env_runners": 9.100011996481935e-06, "training_step": 1.6717931407026356, "env_runner_sampling_timer": 1.5576783609093647, "learner_update_timer": 0.11085126812901924, "synch_weights": 0.0007813860403186022, "restore_eval_env_runners": 8.512787904801606e-06, "evaluation_iteration": 0.10898764701385831, "synch_eval_env_connectors": 0.00012517831833333746, "synch_env_connectors": 4.324507187541715e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.9969554100565425e-06, "numpy_to_tensor": 8.463833804405678e-06, "batch_individual_items": 6.2458076406579305e-06, "add_time_dim_to_batch_and_zero_pad": 2.3378971905702474e-06, "add_states_from_episodes_to_batch": 1.745217944253982e-06}}, "connector_pipeline_timer": 4.374828252949673e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0970462712135075e-05, "un_batch_to_individual_items": 5.3050270697827515e-06, "normalize_and_clip_actions": 9.444747830967073e-06, "get_actions": 3.751255314403644e-05, "remove_single_ts_time_rank_from_batch": 5.849126976770964e-07, "tensor_to_numpy": 1.2869110580322297e-05}}, "connector_pipeline_timer": 0.00010255763647674055}, "episode_len_min": 20, "weights_seq_no": 18.0, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "num_env_steps_sampled": 5000.0, "episode_len_max": 20, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "sample": 0.004829988560691796, "env_reset_timer": 3.4305479037420053e-05, "num_episodes_lifetime": -524375.0, "episode_duration_sec_mean": 0.0045611790292896335, "time_between_sampling": 0.0018145092486874992, "num_env_steps_sampled_lifetime": -10487500.0, "rlmodule_inference_timer": 2.758002759488679e-05, "agent_episode_returns_mean": {"default_agent": 7.2200000000000015}, "episode_return_min": -9.5, "module_episode_returns_mean": {"default_policy": 7.2200000000000015}, "env_step_timer": 1.3794756542034355e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_mean": 7.2200000000000015, "episode_len_mean": 20.0, "episode_return_max": 10.5, "num_env_steps_sampled_lifetime_throughput": 3759.229816323947}, "learners": {"__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.0869996138383724, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.77491973092199e-06, "add_observations_from_episodes_to_batch": 0.0008732212825099524, "general_advantage_estimation": 0.007114130564163087, "add_one_ts_to_episodes_and_truncate": 0.008486709681079013, "numpy_to_tensor": 7.612777068511227e-05, "batch_individual_items": 0.03579588455858186, "add_time_dim_to_batch_and_zero_pad": 1.4882608058821323e-05, "add_columns_from_episodes_to_train_batch": 0.03448409834099751}}}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime": 598500, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 114000, "num_trainable_parameters": 6003, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 2299381.12826975, "num_module_steps_trained_throughput": 439412.6097590767, "num_module_steps_trained_lifetime_throughput": 438882.2224938069}, "default_policy": {"vf_loss": 0.10278083384037018, "total_loss": -0.04619554802775383, "vf_explained_var": -0.008934259414672852, "default_optimizer_learning_rate": 0.0002847858517, "mean_kl_loss": 2.036566183960531e-05, "gradients_default_optimizer_global_norm": 0.020102325826883316, "vf_loss_unclipped": 27.963809967041016, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 1.423828734914423e-06, "entropy": 0.5288645625114441, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 114000, "policy_loss": -0.1101461872458458, "num_trainable_parameters": 6003, "curr_entropy_coeff": 0.0090570820258, "weights_seq_no": 19.0, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime_throughput": 439646.89758129185}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.611054597104695e-07, "listify_data_for_vector_env": 1.0685908145934287e-05, "un_batch_to_individual_items": 5.29452046931056e-06, "normalize_and_clip_actions": 9.253655815074077e-06, "get_actions": 3.451812533282141e-05, "tensor_to_numpy": 1.2554816278017427e-05}}, "connector_pipeline_timer": 9.825482427055308e-05}, "episode_len_max": 20, "env_reset_timer": 0.00045355292287140047, "rlmodule_inference_timer": 2.643704196260035e-05, "module_episode_returns_mean": {"default_policy": 0.65}, "env_step_timer": 1.3492015145580955e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.004557894634781405, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.79979004463074e-06, "numpy_to_tensor": 8.048551151059741e-06, "batch_individual_items": 5.970579581847062e-06, "add_time_dim_to_batch_and_zero_pad": 2.190725108742827e-06, "add_states_from_episodes_to_batch": 1.5934660726073915e-06}}, "connector_pipeline_timer": 4.193619344294854e-05}, "num_env_steps_sampled_lifetime": 95400, "episode_return_min": -12.5, "episode_return_mean": 0.65, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "num_episodes": 20, "sample": 0.09958636202545595, "num_episodes_lifetime": 380, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "agent_episode_returns_mean": {"default_agent": 0.65}, "episode_len_mean": 20.0, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "weights_seq_no": 19.0, "time_between_sampling": 1.5714632331534413}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "465d7_00000", "date": "2025-08-11_19-24-09", "timestamp": 1754933049, "time_this_iter_s": 1.6790440082550049, "time_total_s": 31.281731128692627, "pid": 14455, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1614318a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 31.281731128692627, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 43.2, "ram_util_percent": 77.9}}
{"timers": {"training_iteration": 1.6697096185248663, "restore_env_runners": 9.066511732273875e-06, "training_step": 1.6695719455461944, "env_runner_sampling_timer": 1.555663509800723, "learner_update_timer": 0.11064659252667848, "synch_weights": 0.0007789384303223669, "restore_eval_env_runners": 8.509739812560887e-06, "evaluation_iteration": 0.10891192263378491, "synch_eval_env_connectors": 0.0001249840344711817, "synch_env_connectors": 4.317092423418191e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.014024080570868e-06, "numpy_to_tensor": 8.41374690510556e-06, "batch_individual_items": 6.274228600421255e-06, "add_time_dim_to_batch_and_zero_pad": 2.3268578974163347e-06, "add_states_from_episodes_to_batch": 1.7339455206190322e-06}}, "connector_pipeline_timer": 4.375698156625786e-05}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0998088246840898e-05, "un_batch_to_individual_items": 5.36127493527481e-06, "normalize_and_clip_actions": 9.503963360497955e-06, "get_actions": 3.705950898260618e-05, "remove_single_ts_time_rank_from_batch": 5.932159285292112e-07, "tensor_to_numpy": 1.2856653575395276e-05}}, "connector_pipeline_timer": 0.00010226868171000289}, "episode_len_min": 20, "weights_seq_no": 19.0, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "num_env_steps_sampled": 5000.0, "episode_len_max": 20, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "sample": 0.004835201505700176, "env_reset_timer": 3.348681285686508e-05, "num_episodes_lifetime": -555250.0, "episode_duration_sec_mean": 0.004471462485380471, "time_between_sampling": 0.0018630493154646313, "num_env_steps_sampled_lifetime": -11105000.0, "rlmodule_inference_timer": 2.7073676255839433e-05, "agent_episode_returns_mean": {"default_agent": 6.980000000000003}, "episode_return_min": -9.5, "module_episode_returns_mean": {"default_policy": 6.980000000000003}, "env_step_timer": 1.3705673250262916e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_mean": 6.980000000000003, "episode_len_mean": 20.0, "episode_return_max": 10.5, "num_env_steps_sampled_lifetime_throughput": 3771.714234937589}, "learners": {"__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.08690724312058513, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.7688413219157876e-06, "add_observations_from_episodes_to_batch": 0.0008726665696701752, "general_advantage_estimation": 0.007094083008456263, "add_one_ts_to_episodes_and_truncate": 0.00847725258454963, "numpy_to_tensor": 7.598733356125775e-05, "batch_individual_items": 0.03573607988315529, "add_time_dim_to_batch_and_zero_pad": 1.4842951610429536e-05, "add_columns_from_episodes_to_train_batch": 0.03448233485817114}}}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_env_steps_trained_lifetime": 630000, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 120000, "num_trainable_parameters": 6003, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 2299131.0647408003, "num_module_steps_trained_throughput": 439307.16945353546, "num_module_steps_trained_lifetime_throughput": 438793.2562882903}, "default_policy": {"vf_loss": 0.10278083384037018, "total_loss": 0.06485634297132492, "vf_explained_var": -0.009521126747131348, "default_optimizer_learning_rate": 0.0002847858517, "mean_kl_loss": 0.0004883734509348869, "gradients_default_optimizer_global_norm": 0.08865606784820557, "vf_loss_unclipped": 28.101835250854492, "diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_kl_coeff": 7.119143674572115e-07, "entropy": 0.5163688063621521, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 120000, "policy_loss": 0.0007925351383164525, "num_trainable_parameters": 6003, "curr_entropy_coeff": 0.0090570820258, "weights_seq_no": 20.0, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime_throughput": 439492.17710910947}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.806881152568169e-07, "listify_data_for_vector_env": 1.0818877800443424e-05, "un_batch_to_individual_items": 5.3390196068656425e-06, "normalize_and_clip_actions": 9.401410205486094e-06, "get_actions": 3.512998398295344e-05, "tensor_to_numpy": 1.2832680451372177e-05}}, "connector_pipeline_timer": 9.938826962889892e-05}, "episode_len_max": 20, "env_reset_timer": 0.00044972822326945527, "rlmodule_inference_timer": 2.7066894847156384e-05, "module_episode_returns_mean": {"default_policy": 0.05}, "env_step_timer": 1.3803419871404432e-05, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.0045551358431112025, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.791294809936456e-06, "numpy_to_tensor": 8.329363378910176e-06, "batch_individual_items": 6.031468316554003e-06, "add_time_dim_to_batch_and_zero_pad": 2.178026338500246e-06, "add_states_from_episodes_to_batch": 1.5761568024323293e-06}}, "connector_pipeline_timer": 4.205687278956084e-05}, "num_env_steps_sampled_lifetime": 100400, "episode_return_min": -12.5, "episode_return_mean": 0.05, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "num_episodes": 20, "sample": 0.09956424840532246, "num_episodes_lifetime": 400, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "agent_episode_returns_mean": {"default_agent": 0.05}, "episode_len_mean": 20.0, "episode_return_max": 14.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "weights_seq_no": 20.0, "time_between_sampling": 1.5704126212426575}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "465d7_00000", "date": "2025-08-11_19-24-11", "timestamp": 1754933051, "time_this_iter_s": 1.5544440746307373, "time_total_s": 32.836175203323364, "pid": 14455, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1614318a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 32.836175203323364, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 41.35, "ram_util_percent": 77.6}}
