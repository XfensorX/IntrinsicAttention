{"timers": {"training_iteration": 4.867642041994259, "restore_env_runners": 2.8999987989664078e-05, "training_step": 4.867346707964316, "env_runner_sampling_timer": 4.677847874932922, "learner_update_timer": 0.18481975002214313, "synch_weights": 0.0013251249911263585}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.7038193279765726e-06, "numpy_to_tensor": 2.956367960768253e-05, "add_time_dim_to_batch_and_zero_pad": 7.534456672971407e-06, "batch_individual_items": 1.9340998439793443e-05, "add_observations_from_episodes_to_batch": 8.577407781230506e-06}}, "connector_pipeline_timer": 0.00012712616086843508}, "env_step_timer": 4.5910222263397194e-05, "module_episode_returns_mean": {"default_policy": 0.17999999999999997}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.4017561054103285e-05, "remove_single_ts_time_rank_from_batch": 1.5633711194643876e-06, "listify_data_for_vector_env": 3.095157345363416e-05, "get_actions": 0.00015493724361295762, "tensor_to_numpy": 4.303850527941502e-05, "normalize_and_clip_actions": 2.821612248723148e-05}}, "connector_pipeline_timer": 0.0003379715935463708}, "episode_return_min": -9.5, "episode_return_mean": 0.17999999999999997, "env_to_module_sum_episodes_length_out": 10.191744832559449, "env_to_module_sum_episodes_length_in": 10.191744832559449, "env_reset_timer": 0.00023806922563887565, "num_episodes": 250.0, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "episode_return_max": 10.5, "episode_len_max": 20, "time_between_sampling": 0.0014584626813370194, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "episode_duration_sec_mean": 0.016009760679677132, "agent_episode_returns_mean": {"default_agent": 0.17999999999999997}, "weights_seq_no": 0.0, "num_env_steps_sampled_lifetime": 627500.0, "sample": 0.013596627868719877, "rlmodule_inference_timer": 0.00018490747462951483, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "num_episodes_lifetime": 31375.0, "num_env_steps_sampled_lifetime_throughput": 1554.856031853686}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04270637489389628, "add_one_ts_to_episodes_and_truncate": 0.017786582931876183, "general_advantage_estimation": 0.013567541958764195, "add_columns_from_episodes_to_train_batch": 0.05370266700629145, "numpy_to_tensor": 9.14999982342124e-05, "add_time_dim_to_batch_and_zero_pad": 1.9291997887194157e-05, "add_states_from_episodes_to_batch": 3.917026333510876e-06, "add_observations_from_episodes_to_batch": 0.0025037500308826566}}, "connector_pipeline_timer": 0.1306881670607254}, "num_module_steps_trained_lifetime": 6000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 31500, "learner_connector_sum_episodes_length_out": 5250, "learner_connector_sum_episodes_length_in": 5000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1332792.585733864, "num_module_steps_trained_throughput": 254900.55797168188, "num_module_steps_trained_lifetime_throughput": 254540.78495423417}, "default_policy": {"mean_kl_loss": 0.001026108511723578, "num_module_steps_trained_lifetime": 6000, "weights_seq_no": 1.0, "num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "vf_loss": 0.10278083384037018, "gradients_default_optimizer_global_norm": 0.12170831859111786, "curr_kl_coeff": 0.3732481598854065, "entropy": 0.6878411173820496, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 28.942136764526367, "total_loss": 0.12544988095760345, "policy_loss": 0.06217312067747116, "module_train_batch_size_mean": 1000.0, "vf_explained_var": -0.010670661926269531, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime_throughput": 255419.9520518464}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 5.183757258729537e-06, "batch_individual_items": 1.0639352972201005e-05, "numpy_to_tensor": 1.5755116073875765e-05, "add_time_dim_to_batch_and_zero_pad": 4.430907087267791e-06, "add_states_from_episodes_to_batch": 2.351567485420164e-06}}, "connector_pipeline_timer": 7.280673242077581e-05}, "weights_seq_no": 1.0, "agent_episode_returns_mean": {"default_agent": 0.05}, "env_step_timer": 2.664324920439484e-05, "env_to_module_sum_episodes_length_in": 10.216013141322508, "num_agent_steps_sampled": {"default_agent": 400}, "num_episodes": 20, "episode_return_max": 14.5, "episode_duration_sec_mean": 0.011567845905665309, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.7005549603213777e-05, "remove_single_ts_time_rank_from_batch": 8.900060206470646e-07, "un_batch_to_individual_items": 9.628441531271536e-06, "get_actions": 7.912418609828378e-05, "listify_data_for_vector_env": 1.8991625177670397e-05, "tensor_to_numpy": 2.7629494934320838e-05}}, "connector_pipeline_timer": 0.00019239560862078668}, "episode_return_min": -12.5, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.25413629098329693, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "num_episodes_lifetime": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.216013141322508, "module_episode_returns_mean": {"default_policy": 0.05}, "env_reset_timer": 0.0009361670818179846, "episode_len_min": 20, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 5400, "rlmodule_inference_timer": 5.826172911136883e-05, "episode_return_mean": 0.05}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "49f87_00000", "date": "2025-08-11_19-31-47", "timestamp": 1754933507, "time_this_iter_s": 5.140068054199219, "time_total_s": 5.140068054199219, "pid": 24466, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16fe2d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5.140068054199219, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 65.4625, "ram_util_percent": 80.3125}}
{"timers": {"training_iteration": 4.846337214075029, "restore_env_runners": 2.8862488688901065e-05, "training_step": 4.846041739635402, "env_runner_sampling_timer": 4.655341209103354, "learner_update_timer": 0.1860167383519001, "synch_weights": 0.001325132071506232, "restore_eval_env_runners": 1.1875061318278313e-05, "evaluation_iteration": 0.27062841691076756, "synch_eval_env_connectors": 0.00015483296010643244, "synch_env_connectors": 4.499917849898338e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.9017182471695378e-06, "numpy_to_tensor": 1.7344460585193732e-05, "add_time_dim_to_batch_and_zero_pad": 4.0804944813548966e-06, "batch_individual_items": 1.200204358220161e-05, "add_observations_from_episodes_to_batch": 5.044226022180674e-06}}, "connector_pipeline_timer": 7.789914962800972e-05}, "env_step_timer": 2.6644043426042297e-05, "module_episode_returns_mean": {"default_policy": 0.3400000000000001}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 8.998368479787973e-06, "remove_single_ts_time_rank_from_batch": 9.664834962542376e-07, "listify_data_for_vector_env": 1.986645356784668e-05, "get_actions": 8.656970645144846e-05, "tensor_to_numpy": 2.5809340940422344e-05, "normalize_and_clip_actions": 1.6709058799445312e-05}}, "connector_pipeline_timer": 0.00020149722012860236}, "episode_return_min": -9.5, "episode_return_mean": 0.3400000000000001, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_reset_timer": 0.00010472093023733414, "num_episodes": 250.0, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "episode_return_max": 10.5, "episode_len_max": 20, "time_between_sampling": 0.003187310461698142, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "episode_duration_sec_mean": 0.008083544191904365, "agent_episode_returns_mean": {"default_agent": 0.3400000000000001}, "weights_seq_no": 1.0, "num_env_steps_sampled_lifetime": 10000.0, "sample": 0.01286453687677211, "rlmodule_inference_timer": 5.673839309115236e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "num_episodes_lifetime": 500.0, "num_env_steps_sampled_lifetime_throughput": 2235.969769237175}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04437805780442432, "add_one_ts_to_episodes_and_truncate": 0.01768594710272737, "general_advantage_estimation": 0.013522229460068046, "add_columns_from_episodes_to_train_batch": 0.05357778783654794, "numpy_to_tensor": 9.139249799773097e-05, "add_time_dim_to_batch_and_zero_pad": 1.938949804753065e-05, "add_states_from_episodes_to_batch": 4.1661853902041914e-06, "add_observations_from_episodes_to_batch": 0.0024868508602958173}}, "connector_pipeline_timer": 0.13207203955971636}, "num_module_steps_trained_lifetime": 12000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 63000, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1326964.8920494488, "num_module_steps_trained_throughput": 253775.06555213296, "num_module_steps_trained_lifetime_throughput": 253419.11875222775}, "default_policy": {"mean_kl_loss": 4.524777614278719e-05, "num_module_steps_trained_lifetime": 12000, "weights_seq_no": 2.0, "num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "vf_loss": 0.10278083384037018, "gradients_default_optimizer_global_norm": 0.019594253972172737, "curr_kl_coeff": 0.18662407994270325, "entropy": 0.6892082095146179, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 28.860502243041992, "total_loss": 0.060141224414110184, "policy_loss": -0.0023740576580166817, "module_train_batch_size_mean": 1000.0, "vf_explained_var": -0.010760307312011719, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime_throughput": 254278.3420917543}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.2308901414746325e-06, "batch_individual_items": 1.1136732017010431e-05, "numpy_to_tensor": 1.4862414950273084e-05, "add_time_dim_to_batch_and_zero_pad": 3.966598733757367e-06, "add_states_from_episodes_to_batch": 2.830278065155297e-06}}, "connector_pipeline_timer": 6.879481561455074e-05}, "weights_seq_no": 2.0, "agent_episode_returns_mean": {"default_agent": 1.05}, "env_step_timer": 2.330869429892019e-05, "env_to_module_sum_episodes_length_in": 10.366003441359926, "num_agent_steps_sampled": {"default_agent": 400}, "num_episodes": 20, "episode_return_max": 14.5, "episode_duration_sec_mean": 0.009143470862181858, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.3590391856958367e-05, "remove_single_ts_time_rank_from_batch": 8.680409802721647e-07, "un_batch_to_individual_items": 8.10167540803253e-06, "get_actions": 7.270057951392335e-05, "listify_data_for_vector_env": 1.844000000880253e-05, "tensor_to_numpy": 2.309385092620562e-05}}, "connector_pipeline_timer": 0.00017527268195750622}, "episode_return_min": -12.5, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.2530487518233713, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "num_episodes_lifetime": 40, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "env_to_module_sum_episodes_length_out": 10.366003441359926, "module_episode_returns_mean": {"default_policy": 1.05}, "env_reset_timer": 0.0009284012508578599, "episode_len_min": 20, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 10400, "rlmodule_inference_timer": 4.984816471098319e-05, "episode_return_mean": 1.05, "time_between_sampling": 2.7726297499611974}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "49f87_00000", "date": "2025-08-11_19-31-50", "timestamp": 1754933510, "time_this_iter_s": 2.8938193321228027, "time_total_s": 8.033887386322021, "pid": 24466, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16fe2d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8.033887386322021, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 75.9, "ram_util_percent": 80.625}}
{"timers": {"training_iteration": 4.825837608185038, "restore_env_runners": 2.8906363423448054e-05, "training_step": 4.825540443489363, "env_runner_sampling_timer": 4.635306556172856, "learner_update_timer": 0.18552701221841852, "synch_weights": 0.0013259474201826379, "restore_eval_env_runners": 1.1851310264319181e-05, "evaluation_iteration": 0.26945764107163994, "synch_eval_env_connectors": 0.0001545058807823807, "synch_env_connectors": 4.766578786075115e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.861192805321785e-06, "numpy_to_tensor": 1.8273741723597055e-05, "add_time_dim_to_batch_and_zero_pad": 4.490764371357835e-06, "batch_individual_items": 1.318324675769033e-05, "add_observations_from_episodes_to_batch": 5.02038872175592e-06}}, "connector_pipeline_timer": 7.885179492133432e-05}, "env_step_timer": 2.847424438946415e-05, "module_episode_returns_mean": {"default_policy": 1.3000000000000003}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 9.54578843124712e-06, "remove_single_ts_time_rank_from_batch": 1.0398017636296586e-06, "listify_data_for_vector_env": 2.044257713177559e-05, "get_actions": 8.761504121642186e-05, "tensor_to_numpy": 2.5356229883318628e-05, "normalize_and_clip_actions": 1.7568077944209628e-05}}, "connector_pipeline_timer": 0.00020526351481452986}, "episode_return_min": -9.5, "episode_return_mean": 1.3000000000000003, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_reset_timer": 8.220572632949955e-05, "num_episodes": 250.0, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "episode_return_max": 10.5, "episode_len_max": 20, "time_between_sampling": 0.0030350558271975813, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "episode_duration_sec_mean": 0.008941325844731184, "agent_episode_returns_mean": {"default_agent": 1.3000000000000003}, "weights_seq_no": 2.0, "num_env_steps_sampled_lifetime": -607500.0, "sample": 0.009350941688856874, "rlmodule_inference_timer": 5.944720525336559e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "num_episodes_lifetime": -30375.0, "num_env_steps_sampled_lifetime_throughput": 2237.0833372108964}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.044283178476779726, "add_one_ts_to_episodes_and_truncate": 0.017605978881695773, "general_advantage_estimation": 0.013444354666164145, "add_columns_from_episodes_to_train_batch": 0.053498705368139776, "numpy_to_tensor": 9.123690358828753e-05, "add_time_dim_to_batch_and_zero_pad": 1.9330182671546935e-05, "add_states_from_episodes_to_batch": 4.1603631572797895e-06, "add_observations_from_episodes_to_batch": 0.0024737161011085845}}, "connector_pipeline_timer": 0.13172537625388941}, "num_module_steps_trained_lifetime": 18000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 94500, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1314420.302479948, "num_module_steps_trained_throughput": 251370.73802377205, "num_module_steps_trained_lifetime_throughput": 251019.3686607016}, "default_policy": {"mean_kl_loss": 0.0007080155191943049, "num_module_steps_trained_lifetime": 18000, "weights_seq_no": 3.0, "num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "vf_loss": 0.10278083384037018, "gradients_default_optimizer_global_norm": 0.044358815997838974, "curr_kl_coeff": 0.09331203997135162, "entropy": 0.684884786605835, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 29.159080505371094, "total_loss": 0.3532428741455078, "policy_loss": 0.29057320952415466, "module_train_batch_size_mean": 1000.0, "vf_explained_var": -0.010493040084838867, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime_throughput": 251863.13117946463}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.264021937644684e-06, "batch_individual_items": 9.79291563162861e-06, "numpy_to_tensor": 1.3112826345515856e-05, "add_time_dim_to_batch_and_zero_pad": 3.7963920040418608e-06, "add_states_from_episodes_to_batch": 2.1738565955664857e-06}}, "connector_pipeline_timer": 6.322415265435052e-05}, "weights_seq_no": 3.0, "agent_episode_returns_mean": {"default_agent": 0.38333333333333336}, "env_step_timer": 2.147603565231988e-05, "env_to_module_sum_episodes_length_in": 10.368205581254823, "num_agent_steps_sampled": {"default_agent": 400}, "num_episodes": 20, "episode_return_max": 14.5, "episode_duration_sec_mean": 0.009026768126447374, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.3302978306598459e-05, "remove_single_ts_time_rank_from_batch": 7.852481801409617e-07, "un_batch_to_individual_items": 8.372315223320523e-06, "get_actions": 5.5865026455965004e-05, "listify_data_for_vector_env": 1.6017410761356172e-05, "tensor_to_numpy": 1.946170196264122e-05}}, "connector_pipeline_timer": 0.00014938358903701773}, "episode_return_min": -12.5, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.2524326868055505, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "num_episodes_lifetime": 60, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "env_to_module_sum_episodes_length_out": 10.368205581254823, "module_episode_returns_mean": {"default_policy": 0.38333333333333336}, "env_reset_timer": 0.0009206855681026354, "episode_len_min": 20, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 15400, "rlmodule_inference_timer": 4.1679714346929643e-05, "episode_return_mean": 0.38333333333333336, "time_between_sampling": 2.773307173711946}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "49f87_00000", "date": "2025-08-11_19-31-53", "timestamp": 1754933513, "time_this_iter_s": 3.002357006072998, "time_total_s": 11.03624439239502, "pid": 24466, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16fe2d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11.03624439239502, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 77.75, "ram_util_percent": 80.525}}
{"timers": {"training_iteration": 4.8121471612730495, "restore_env_runners": 2.8697299234219824e-05, "training_step": 4.811845670724061, "env_runner_sampling_timer": 4.621781263521369, "learner_update_timer": 0.18531260875698014, "synch_weights": 0.0013329779468106572, "restore_eval_env_runners": 1.1828216980211436e-05, "evaluation_iteration": 0.2687632138315588, "synch_eval_env_connectors": 0.0001547274920041673, "synch_env_connectors": 4.775993758812546e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.038315424542664e-06, "numpy_to_tensor": 2.215089782650331e-05, "add_time_dim_to_batch_and_zero_pad": 4.843656395244865e-06, "batch_individual_items": 1.3929177971974655e-05, "add_observations_from_episodes_to_batch": 6.45958914105698e-06}}, "connector_pipeline_timer": 9.067952199454781e-05}, "env_step_timer": 3.179224594521279e-05, "module_episode_returns_mean": {"default_policy": 2.259999999999999}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.107326330069457e-05, "remove_single_ts_time_rank_from_batch": 1.161780774778304e-06, "listify_data_for_vector_env": 2.3518888943613944e-05, "get_actions": 0.00011019208779544061, "tensor_to_numpy": 2.877393374589216e-05, "normalize_and_clip_actions": 1.805142911879203e-05}}, "connector_pipeline_timer": 0.00024323807850167354}, "episode_return_min": -9.5, "episode_return_mean": 2.259999999999999, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_reset_timer": 9.761503203473582e-05, "num_episodes": 250.0, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "episode_return_max": 10.5, "episode_len_max": 20, "time_between_sampling": 0.0030525198349602984, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "episode_duration_sec_mean": 0.010528570650145412, "agent_episode_returns_mean": {"default_agent": 2.259999999999999}, "weights_seq_no": 3.0, "num_env_steps_sampled_lifetime": -1225000.0, "sample": 0.01030594812242973, "rlmodule_inference_timer": 6.903393402179227e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "num_episodes_lifetime": -61250.0, "num_env_steps_sampled_lifetime_throughput": 2123.9602859192764}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04427716336154682, "add_one_ts_to_episodes_and_truncate": 0.01767922284333978, "general_advantage_estimation": 0.013412317369582597, "add_columns_from_episodes_to_train_batch": 0.05353401706441188, "numpy_to_tensor": 9.136286492669023e-05, "add_time_dim_to_batch_and_zero_pad": 2.0253550581634044e-05, "add_states_from_episodes_to_batch": 4.956679759314283e-06, "add_observations_from_episodes_to_batch": 0.0024703880996237277}}, "connector_pipeline_timer": 0.1317933699914982}, "num_module_steps_trained_lifetime": 24000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 126000, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1305577.8080242863, "num_module_steps_trained_throughput": 249653.9738296733, "num_module_steps_trained_lifetime_throughput": 249317.75808627342}, "default_policy": {"mean_kl_loss": 0.0009349097963422537, "num_module_steps_trained_lifetime": 24000, "weights_seq_no": 4.0, "num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "vf_loss": 0.10278083384037018, "gradients_default_optimizer_global_norm": 0.05304211378097534, "curr_kl_coeff": 0.04665601998567581, "entropy": 0.6782488226890564, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 28.754053115844727, "total_loss": 0.15174606442451477, "policy_loss": 0.0890611782670021, "module_train_batch_size_mean": 1000.0, "vf_explained_var": -0.010841846466064453, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime_throughput": 250128.35858438708}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 1.2076896486842888e-05, "batch_individual_items": 2.049229567144603e-05, "numpy_to_tensor": 3.152472540364898e-05, "add_time_dim_to_batch_and_zero_pad": 5.97407191948309e-06, "add_states_from_episodes_to_batch": 3.3593180957532718e-06}}, "connector_pipeline_timer": 0.00012234216080907897}, "weights_seq_no": 4.0, "agent_episode_returns_mean": {"default_agent": 1.05}, "env_step_timer": 3.367282508359597e-05, "env_to_module_sum_episodes_length_in": 10.368237912813044, "num_agent_steps_sampled": {"default_agent": 400}, "num_episodes": 20, "episode_return_max": 14.5, "episode_duration_sec_mean": 0.008982218784512951, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 2.42361815220063e-05, "remove_single_ts_time_rank_from_batch": 5.237295158052436e-06, "un_batch_to_individual_items": 9.982614651088417e-06, "get_actions": 0.00010382968811495287, "listify_data_for_vector_env": 2.3364536464224404e-05, "tensor_to_numpy": 3.4991893474423717e-05}}, "connector_pipeline_timer": 0.00025816343358816575}, "episode_return_min": -12.5, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.25186290785752646, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "num_episodes_lifetime": 80, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "env_to_module_sum_episodes_length_out": 10.368237912813044, "module_episode_returns_mean": {"default_policy": 1.05}, "env_reset_timer": 0.0009134828825134319, "episode_len_min": 20, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 20400, "rlmodule_inference_timer": 6.841555013682934e-05, "episode_return_mean": 1.05, "time_between_sampling": 2.7804553269749626}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "49f87_00000", "date": "2025-08-11_19-31-56", "timestamp": 1754933516, "time_this_iter_s": 3.675614833831787, "time_total_s": 14.711859226226807, "pid": 24466, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16fe2d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 14.711859226226807, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 85.7, "ram_util_percent": 81.19999999999999}}
{"timers": {"training_iteration": 4.79529059341059, "restore_env_runners": 2.8510325839173744e-05, "training_step": 4.7949857281864245, "env_runner_sampling_timer": 4.604463540055774, "learner_update_timer": 0.1857603501694268, "synch_weights": 0.0013280064964114198, "restore_eval_env_runners": 1.2210354220354928e-05, "evaluation_iteration": 0.26820431336333417, "synch_eval_env_connectors": 0.00016139896651043092, "synch_env_connectors": 4.782824458088725e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.762206053224495e-06, "numpy_to_tensor": 1.8430208713587498e-05, "add_time_dim_to_batch_and_zero_pad": 4.631590612921242e-06, "batch_individual_items": 1.4009610008681044e-05, "add_observations_from_episodes_to_batch": 5.139467799072528e-06}}, "connector_pipeline_timer": 8.024425482108954e-05}, "env_step_timer": 2.6738299260144284e-05, "module_episode_returns_mean": {"default_policy": 1.1400000000000001}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 8.869642642871024e-06, "remove_single_ts_time_rank_from_batch": 1.0948834922839025e-06, "listify_data_for_vector_env": 1.9361614918101352e-05, "get_actions": 8.621713104031767e-05, "tensor_to_numpy": 2.5203578853628637e-05, "normalize_and_clip_actions": 1.6373310844025105e-05}}, "connector_pipeline_timer": 0.00020005496086738473}, "episode_return_min": -9.5, "episode_return_mean": 1.1400000000000001, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_reset_timer": 9.451516476979821e-05, "num_episodes": 250.0, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "episode_return_max": 10.5, "episode_len_max": 20, "time_between_sampling": 0.0031012192193524573, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "episode_duration_sec_mean": 0.009788064332678911, "agent_episode_returns_mean": {"default_agent": 1.1400000000000001}, "weights_seq_no": 4.0, "num_env_steps_sampled_lifetime": -1842500.0, "sample": 0.010259841945179047, "rlmodule_inference_timer": 0.00011160361837312161, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "num_episodes_lifetime": -92125.0, "num_env_steps_sampled_lifetime_throughput": 2328.636207624272}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04458169880824119, "add_one_ts_to_episodes_and_truncate": 0.01760775353445953, "general_advantage_estimation": 0.013413953356507862, "add_columns_from_episodes_to_train_batch": 0.05381513022352089, "numpy_to_tensor": 9.248298633836908e-05, "add_time_dim_to_batch_and_zero_pad": 2.01930953194946e-05, "add_states_from_episodes_to_batch": 4.940032886427361e-06, "add_observations_from_episodes_to_batch": 0.0024634875590792823}}, "connector_pipeline_timer": 0.13230268088138697}, "num_module_steps_trained_lifetime": 30000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 157500, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1290484.8094297955, "num_module_steps_trained_throughput": 246742.545972581, "num_module_steps_trained_lifetime_throughput": 246420.41621680514}, "default_policy": {"mean_kl_loss": 0.0014776266179978848, "num_module_steps_trained_lifetime": 30000, "weights_seq_no": 5.0, "num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "vf_loss": 0.10278083384037018, "gradients_default_optimizer_global_norm": 0.051883306354284286, "curr_kl_coeff": 0.023328009992837906, "entropy": 0.6661638617515564, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 29.06502914428711, "total_loss": 0.2631865441799164, "policy_loss": 0.20041051506996155, "module_train_batch_size_mean": 1000.0, "vf_explained_var": -0.010644197463989258, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime_throughput": 247193.7440617145}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.977286543270724e-06, "batch_individual_items": 1.4720778630459008e-05, "numpy_to_tensor": 2.0449723781938226e-05, "add_time_dim_to_batch_and_zero_pad": 1.6203308331590922e-05, "add_states_from_episodes_to_batch": 2.4758793314176833e-06}}, "connector_pipeline_timer": 9.731071834058493e-05}, "weights_seq_no": 5.0, "agent_episode_returns_mean": {"default_agent": 1.65}, "env_step_timer": 3.2520512738753454e-05, "env_to_module_sum_episodes_length_in": 10.368238387501162, "num_agent_steps_sampled": {"default_agent": 400}, "num_episodes": 20, "episode_return_max": 14.5, "episode_duration_sec_mean": 0.008970244999509304, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.5765141355492665e-05, "remove_single_ts_time_rank_from_batch": 9.435253061291308e-07, "un_batch_to_individual_items": 8.496680050095707e-06, "get_actions": 0.00010173009577945201, "listify_data_for_vector_env": 2.891067520508086e-05, "tensor_to_numpy": 3.458518599324325e-05}}, "connector_pipeline_timer": 0.0002461307209070858}, "episode_return_min": -12.5, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.25132593252819546, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "num_episodes_lifetime": 100, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 10.368238387501162, "module_episode_returns_mean": {"default_policy": 1.65}, "env_reset_timer": 0.000905209303552399, "episode_len_min": 20, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 25400, "rlmodule_inference_timer": 7.057527110251427e-05, "episode_return_mean": 1.65, "time_between_sampling": 2.7844290107856473}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "49f87_00000", "date": "2025-08-11_19-32-00", "timestamp": 1754933520, "time_this_iter_s": 3.3399171829223633, "time_total_s": 18.05177640914917, "pid": 24466, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16fe2d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 18.05177640914917, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 91.38, "ram_util_percent": 81.5}}
{"timers": {"training_iteration": 4.781288752066849, "restore_env_runners": 2.829564220895512e-05, "training_step": 4.780982002574942, "env_runner_sampling_timer": 4.589258038405631, "learner_update_timer": 0.18695922249753125, "synch_weights": 0.0013231176816050343, "restore_eval_env_runners": 1.2253250770389566e-05, "evaluation_iteration": 0.2676215714789553, "synch_eval_env_connectors": 0.00016280830720038968, "synch_env_connectors": 4.784156075608916e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.8523878169699064e-06, "numpy_to_tensor": 2.15283218248024e-05, "add_time_dim_to_batch_and_zero_pad": 5.39653987076984e-06, "batch_individual_items": 1.3349628378258715e-05, "add_observations_from_episodes_to_batch": 5.982300609012408e-06}}, "connector_pipeline_timer": 8.712712025383035e-05}, "env_step_timer": 4.10935710738398e-05, "module_episode_returns_mean": {"default_policy": 2.58}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.042614384020806e-05, "remove_single_ts_time_rank_from_batch": 1.177470086452562e-06, "listify_data_for_vector_env": 2.5621647945815092e-05, "get_actions": 9.781860697709172e-05, "tensor_to_numpy": 2.8481727559730636e-05, "normalize_and_clip_actions": 1.8515554084790072e-05}}, "connector_pipeline_timer": 0.0002324921666127407}, "episode_return_min": -9.5, "episode_return_mean": 2.58, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_reset_timer": 9.055986352071546e-05, "num_episodes": 250.0, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "episode_return_max": 10.5, "episode_len_max": 20, "time_between_sampling": 0.003244590633630284, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "episode_duration_sec_mean": 0.010373622802551838, "agent_episode_returns_mean": {"default_agent": 2.58}, "weights_seq_no": 5.0, "num_env_steps_sampled_lifetime": -2460000.0, "sample": 0.012068142488518247, "rlmodule_inference_timer": 8.121878560801241e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "num_episodes_lifetime": -123000.0, "num_env_steps_sampled_lifetime_throughput": 2122.4609159524653}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04630676557023612, "add_one_ts_to_episodes_and_truncate": 0.01751777974904207, "general_advantage_estimation": 0.013349685072085817, "add_columns_from_episodes_to_train_batch": 0.05378657017173324, "numpy_to_tensor": 9.230107714936903e-05, "add_time_dim_to_batch_and_zero_pad": 2.1231584754357485e-05, "add_states_from_episodes_to_batch": 4.961053349889419e-06, "add_observations_from_episodes_to_batch": 0.002454493934136094}}, "connector_pipeline_timer": 0.1338362807426822}, "num_module_steps_trained_lifetime": 36000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 189000, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1283168.5001906594, "num_module_steps_trained_throughput": 245313.24729298762, "num_module_steps_trained_lifetime_throughput": 245003.39266420552}, "default_policy": {"mean_kl_loss": 0.0018115785205736756, "num_module_steps_trained_lifetime": 36000, "weights_seq_no": 6.0, "num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "vf_loss": 0.10278083384037018, "gradients_default_optimizer_global_norm": 0.05181848257780075, "curr_kl_coeff": 0.011664004996418953, "entropy": 0.6465494632720947, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 28.573688507080078, "total_loss": 0.0240169670432806, "policy_loss": -0.03891005367040634, "module_train_batch_size_mean": 1000.0, "vf_explained_var": -0.010707616806030273, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime_throughput": 245733.02124547987}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.843260327381552e-06, "batch_individual_items": 1.2131443367766984e-05, "numpy_to_tensor": 1.761024823792054e-05, "add_time_dim_to_batch_and_zero_pad": 3.981161242375365e-06, "add_states_from_episodes_to_batch": 2.719269578120647e-06}}, "connector_pipeline_timer": 7.487125173288278e-05}, "weights_seq_no": 6.0, "agent_episode_returns_mean": {"default_agent": 1.65}, "env_step_timer": 2.8253113093550802e-05, "env_to_module_sum_episodes_length_in": 10.368238394470474, "num_agent_steps_sampled": {"default_agent": 400}, "num_episodes": 20, "episode_return_max": 14.5, "episode_duration_sec_mean": 0.008311709159752354, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.496114484169394e-05, "remove_single_ts_time_rank_from_batch": 9.34485974162804e-07, "un_batch_to_individual_items": 8.821412418182022e-06, "get_actions": 7.777824655441217e-05, "listify_data_for_vector_env": 1.929982585813614e-05, "tensor_to_numpy": 2.457324563493026e-05}}, "connector_pipeline_timer": 0.00018909363088978438}, "episode_return_min": -12.5, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.25064534028336616, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "num_episodes_lifetime": 120, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "env_to_module_sum_episodes_length_out": 10.368238394470474, "module_episode_returns_mean": {"default_policy": 1.65}, "env_reset_timer": 0.0009000638805433561, "episode_len_min": 20, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 30400, "rlmodule_inference_timer": 5.323011439445317e-05, "episode_return_mean": 1.65, "time_between_sampling": 2.7910333056781456}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "49f87_00000", "date": "2025-08-11_19-32-03", "timestamp": 1754933523, "time_this_iter_s": 3.5921647548675537, "time_total_s": 21.643941164016724, "pid": 24466, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16fe2d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 21.643941164016724, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 88.34, "ram_util_percent": 81.66}}
{"timers": {"training_iteration": 4.762991659546078, "restore_env_runners": 2.8073094861514782e-05, "training_step": 4.762685898798686, "env_runner_sampling_timer": 4.571120288441591, "learner_update_timer": 0.18679584777200578, "synch_weights": 0.0013221969256504518, "restore_eval_env_runners": 1.223488785680963e-05, "evaluation_iteration": 0.2668840957640617, "synch_eval_env_connectors": 0.00016244564354265273, "synch_env_connectors": 4.775894560120766e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.7704239304115318e-06, "numpy_to_tensor": 1.8800909539160136e-05, "add_time_dim_to_batch_and_zero_pad": 4.654691402909962e-06, "batch_individual_items": 1.3540122023140828e-05, "add_observations_from_episodes_to_batch": 5.661649822490652e-06}}, "connector_pipeline_timer": 8.093087248197367e-05}, "env_step_timer": 2.8359204807045235e-05, "module_episode_returns_mean": {"default_policy": 3.7}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 9.711226477451307e-06, "remove_single_ts_time_rank_from_batch": 9.95938543847683e-07, "listify_data_for_vector_env": 2.144452777910081e-05, "get_actions": 9.387338758884995e-05, "tensor_to_numpy": 2.705356252940002e-05, "normalize_and_clip_actions": 1.777546863999112e-05}}, "connector_pipeline_timer": 0.00021606723848297744}, "episode_return_min": -9.5, "episode_return_mean": 3.7, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_reset_timer": 8.877879527814833e-05, "num_episodes": 250.0, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "episode_return_max": 10.5, "episode_len_max": 20, "time_between_sampling": 0.0032377199305213475, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "episode_duration_sec_mean": 0.009313335896469653, "agent_episode_returns_mean": {"default_agent": 3.7}, "weights_seq_no": 6.0, "num_env_steps_sampled_lifetime": -3077500.0, "sample": 0.010008269163932871, "rlmodule_inference_timer": 6.158599609654496e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "num_episodes_lifetime": -153875.0, "num_env_steps_sampled_lifetime_throughput": 2207.7015689705377}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04634083166500225, "add_one_ts_to_episodes_and_truncate": 0.017430451952260943, "general_advantage_estimation": 0.013327227801443754, "add_columns_from_episodes_to_train_batch": 0.05379404322083278, "numpy_to_tensor": 9.257348642328096e-05, "add_time_dim_to_batch_and_zero_pad": 2.115884854937797e-05, "add_states_from_episodes_to_batch": 4.947693383454214e-06, "add_observations_from_episodes_to_batch": 0.0024387248241322704}}, "connector_pipeline_timer": 0.1337507270951787}, "num_module_steps_trained_lifetime": 42000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 220500, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1269030.5529392008, "num_module_steps_trained_throughput": 242577.82227161794, "num_module_steps_trained_lifetime_throughput": 242286.12357828638}, "default_policy": {"mean_kl_loss": 0.00035054117324762046, "num_module_steps_trained_lifetime": 42000, "weights_seq_no": 7.0, "num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "vf_loss": 0.10278083384037018, "gradients_default_optimizer_global_norm": 0.12011439353227615, "curr_kl_coeff": 0.0058320024982094765, "entropy": 0.6365110874176025, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 28.70351791381836, "total_loss": 0.24163073301315308, "policy_loss": 0.17865099012851715, "module_train_batch_size_mean": 1000.0, "vf_explained_var": -0.010732293128967285, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime_throughput": 242965.8672190953}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.7503764755110023e-06, "batch_individual_items": 8.488241806097287e-06, "numpy_to_tensor": 1.1489701350959546e-05, "add_time_dim_to_batch_and_zero_pad": 3.109559950537162e-06, "add_states_from_episodes_to_batch": 1.947307562509011e-06}}, "connector_pipeline_timer": 5.466836084113783e-05}, "weights_seq_no": 7.0, "agent_episode_returns_mean": {"default_agent": 0.85}, "env_step_timer": 1.8664845709928712e-05, "env_to_module_sum_episodes_length_in": 10.368238394572801, "num_agent_steps_sampled": {"default_agent": 400}, "num_episodes": 20, "episode_return_max": 14.5, "episode_duration_sec_mean": 0.008615667916601524, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.2688516223662566e-05, "remove_single_ts_time_rank_from_batch": 7.503635392548764e-07, "un_batch_to_individual_items": 6.957364320673959e-06, "get_actions": 5.3026441677951656e-05, "listify_data_for_vector_env": 1.4695892181956974e-05, "tensor_to_numpy": 1.7182411812452356e-05}}, "connector_pipeline_timer": 0.0001374128656985072}, "episode_return_min": -12.5, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.24993588688032015, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "num_episodes_lifetime": 140, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "env_to_module_sum_episodes_length_out": 10.368238394572801, "module_episode_returns_mean": {"default_policy": 0.85}, "env_reset_timer": 0.0008921019923715199, "episode_len_min": 20, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 35400, "rlmodule_inference_timer": 3.568917081534066e-05, "episode_return_mean": 0.85, "time_between_sampling": 2.7929423922021086}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "49f87_00000", "date": "2025-08-11_19-32-07", "timestamp": 1754933527, "time_this_iter_s": 3.1375858783721924, "time_total_s": 24.781527042388916, "pid": 24466, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16fe2d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 24.781527042388916, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 84.88, "ram_util_percent": 81.42}}
{"timers": {"training_iteration": 4.7472157158708335, "restore_env_runners": 2.7869454139013433e-05, "training_step": 4.746910185640705, "env_runner_sampling_timer": 4.555932871807444, "learner_update_timer": 0.18619686721527615, "synch_weights": 0.001319389536277165, "restore_eval_env_runners": 1.2180868951387853e-05, "evaluation_iteration": 0.26608735438736275, "synch_eval_env_connectors": 0.00016372368650730546, "synch_env_connectors": 4.775216298972807e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.949485317126847e-06, "numpy_to_tensor": 2.0652685440573012e-05, "add_time_dim_to_batch_and_zero_pad": 4.931742986579915e-06, "batch_individual_items": 1.3370276350190333e-05, "add_observations_from_episodes_to_batch": 6.052319303062588e-06}}, "connector_pipeline_timer": 8.578294251292673e-05}, "env_step_timer": 3.210901675891193e-05, "module_episode_returns_mean": {"default_policy": 5.14}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 9.738898762708487e-06, "remove_single_ts_time_rank_from_batch": 1.053646024661224e-06, "listify_data_for_vector_env": 2.174006051586909e-05, "get_actions": 0.00010210543915730369, "tensor_to_numpy": 2.8689116011564548e-05, "normalize_and_clip_actions": 1.8399609760798915e-05}}, "connector_pipeline_timer": 0.00022946780365386954}, "episode_return_min": -9.5, "episode_return_mean": 5.14, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_reset_timer": 9.009312924502121e-05, "num_episodes": 250.0, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "episode_return_max": 10.5, "episode_len_max": 20, "time_between_sampling": 0.0027077080478009204, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "episode_duration_sec_mean": 0.010341943854466079, "agent_episode_returns_mean": {"default_agent": 5.14}, "weights_seq_no": 7.0, "num_env_steps_sampled_lifetime": -3695000.0, "sample": 0.010645549486364803, "rlmodule_inference_timer": 8.505446053771653e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "num_episodes_lifetime": -184750.0, "num_env_steps_sampled_lifetime_throughput": 2189.5390793611978}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04623682126773512, "add_one_ts_to_episodes_and_truncate": 0.017386649932843983, "general_advantage_estimation": 0.013273059683387977, "add_columns_from_episodes_to_train_batch": 0.053676893617854556, "numpy_to_tensor": 9.237692241977081e-05, "add_time_dim_to_batch_and_zero_pad": 2.1053509999809196e-05, "add_states_from_episodes_to_batch": 4.932377361656568e-06, "add_observations_from_episodes_to_batch": 0.002428729656374906}}, "connector_pipeline_timer": 0.13341986524362898}, "num_module_steps_trained_lifetime": 48000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 252000, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1258234.2581838064, "num_module_steps_trained_throughput": 240475.5183482006, "num_module_steps_trained_lifetime_throughput": 240201.9191266013}, "default_policy": {"mean_kl_loss": 0.0007228472968563437, "num_module_steps_trained_lifetime": 48000, "weights_seq_no": 8.0, "num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "vf_loss": 0.10278083384037018, "gradients_default_optimizer_global_norm": 0.016537001356482506, "curr_kl_coeff": 0.0029160012491047382, "entropy": 0.6174891591072083, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 28.108274459838867, "total_loss": -0.16482774913311005, "policy_loss": -0.22797994315624237, "module_train_batch_size_mean": 1000.0, "vf_explained_var": -0.009645938873291016, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime_throughput": 240831.1492546862}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.6259198044945378e-06, "batch_individual_items": 8.247825752699472e-06, "numpy_to_tensor": 1.1409303200859089e-05, "add_time_dim_to_batch_and_zero_pad": 2.993721085912403e-06, "add_states_from_episodes_to_batch": 1.937877579659105e-06}}, "connector_pipeline_timer": 5.503049656176823e-05}, "weights_seq_no": 8.0, "agent_episode_returns_mean": {"default_agent": 1.05}, "env_step_timer": 1.892451983180878e-05, "env_to_module_sum_episodes_length_in": 10.3682383945743, "num_agent_steps_sampled": {"default_agent": 400}, "num_episodes": 20, "episode_return_max": 14.5, "episode_duration_sec_mean": 0.008353746626526118, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.156885359249258e-05, "remove_single_ts_time_rank_from_batch": 7.188071193194435e-07, "un_batch_to_individual_items": 6.675616221303363e-06, "get_actions": 5.340573869371302e-05, "listify_data_for_vector_env": 1.3628509965824405e-05, "tensor_to_numpy": 1.9826390937379524e-05}}, "connector_pipeline_timer": 0.0001370585741630083}, "episode_return_min": -12.5, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.24908435218158484, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "num_episodes_lifetime": 160, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "env_to_module_sum_episodes_length_out": 10.3682383945743, "module_episode_returns_mean": {"default_policy": 1.05}, "env_reset_timer": 0.000884853472959436, "episode_len_min": 20, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 40400, "rlmodule_inference_timer": 3.699456757778661e-05, "episode_return_mean": 1.05, "time_between_sampling": 2.7970929957795567}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "49f87_00000", "date": "2025-08-11_19-32-10", "timestamp": 1754933530, "time_this_iter_s": 3.358910083770752, "time_total_s": 28.140437126159668, "pid": 24466, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16fe2d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 28.140437126159668, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 83.05, "ram_util_percent": 81.125}}
{"timers": {"training_iteration": 4.7340821353812315, "restore_env_runners": 2.765408953269715e-05, "training_step": 4.733777254194104, "env_runner_sampling_timer": 4.540654643088926, "learner_update_timer": 0.1883447339628341, "synch_weights": 0.0013177281408349702, "restore_eval_env_runners": 1.2126139934463873e-05, "evaluation_iteration": 0.2651628187643728, "synch_eval_env_connectors": 0.00016416103004900253, "synch_env_connectors": 4.787883688011258e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.0956332250580906e-06, "numpy_to_tensor": 2.1339774730332584e-05, "add_time_dim_to_batch_and_zero_pad": 4.88403835158026e-06, "batch_individual_items": 1.4499799780662929e-05, "add_observations_from_episodes_to_batch": 5.463526434053477e-06}}, "connector_pipeline_timer": 8.750420967349322e-05}, "env_step_timer": 3.2216676266415986e-05, "module_episode_returns_mean": {"default_policy": 5.460000000000001}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.1294817308539737e-05, "remove_single_ts_time_rank_from_batch": 1.5632453779391138e-06, "listify_data_for_vector_env": 2.283166348660364e-05, "get_actions": 0.00010874044684679626, "tensor_to_numpy": 2.8608053966523536e-05, "normalize_and_clip_actions": 1.9390076538565906e-05}}, "connector_pipeline_timer": 0.00024192786871362563}, "episode_return_min": -9.5, "episode_return_mean": 5.460000000000001, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_reset_timer": 9.237901833512929e-05, "num_episodes": 250.0, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "episode_return_max": 10.5, "episode_len_max": 20, "time_between_sampling": 0.0026001822087746342, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "episode_duration_sec_mean": 0.010185015968978403, "agent_episode_returns_mean": {"default_agent": 5.460000000000001}, "weights_seq_no": 8.0, "num_env_steps_sampled_lifetime": -4312500.0, "sample": 0.010522204213710503, "rlmodule_inference_timer": 6.689029196107673e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "num_episodes_lifetime": -215625.0, "num_env_steps_sampled_lifetime_throughput": 2042.8969691073132}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04622531721572401, "add_one_ts_to_episodes_and_truncate": 0.019716997182713785, "general_advantage_estimation": 0.01320706241657664, "add_columns_from_episodes_to_train_batch": 0.053828328020908145, "numpy_to_tensor": 9.23285731326473e-05, "add_time_dim_to_batch_and_zero_pad": 2.096464520926531e-05, "add_states_from_episodes_to_batch": 4.918474113859066e-06, "add_observations_from_episodes_to_batch": 0.0024279461103738245}}, "connector_pipeline_timer": 0.1358218890916399}, "num_module_steps_trained_lifetime": 54000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 283500, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1248662.1916217692, "num_module_steps_trained_throughput": 238621.0492846025, "num_module_steps_trained_lifetime_throughput": 238362.57416497916}, "default_policy": {"mean_kl_loss": 0.00022714240185450763, "num_module_steps_trained_lifetime": 54000, "weights_seq_no": 9.0, "num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "vf_loss": 0.10278083384037018, "gradients_default_optimizer_global_norm": 0.059866879135370255, "curr_kl_coeff": 0.0014580006245523691, "entropy": 0.6061604619026184, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 28.079132080078125, "total_loss": -0.11885840445756912, "policy_loss": -0.18210962414741516, "module_train_batch_size_mean": 1000.0, "vf_explained_var": -0.009606122970581055, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime_throughput": 238950.32982547503}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.081953666949038e-06, "batch_individual_items": 9.393983837028326e-06, "numpy_to_tensor": 1.0973602185499631e-05, "add_time_dim_to_batch_and_zero_pad": 2.7277322273468205e-06, "add_states_from_episodes_to_batch": 1.7645710480154747e-06}}, "connector_pipeline_timer": 5.5203817069465655e-05}, "weights_seq_no": 9.0, "agent_episode_returns_mean": {"default_agent": 0.65}, "env_step_timer": 1.7494976343317648e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "num_episodes": 20, "episode_return_max": 14.5, "episode_duration_sec_mean": 0.007760641203494742, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.245784809980246e-05, "remove_single_ts_time_rank_from_batch": 6.353344901623329e-07, "un_batch_to_individual_items": 6.3416877852140815e-06, "get_actions": 4.9357665441998097e-05, "listify_data_for_vector_env": 1.308319598101289e-05, "tensor_to_numpy": 1.5996668089441256e-05}}, "connector_pipeline_timer": 0.00012623378375504685}, "episode_return_min": -12.5, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.24789975116020083, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "num_episodes_lifetime": 180, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 0.65}, "env_reset_timer": 0.0008829495184662916, "episode_len_min": 20, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 45400, "rlmodule_inference_timer": 3.7913065447787504e-05, "episode_return_mean": 0.65, "time_between_sampling": 2.8038189674917198}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "49f87_00000", "date": "2025-08-11_19-32-14", "timestamp": 1754933534, "time_this_iter_s": 3.5822861194610596, "time_total_s": 31.722723245620728, "pid": 24466, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16fe2d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 31.722723245620728, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 85.56, "ram_util_percent": 81.08}}
{"timers": {"training_iteration": 4.720424845276827, "restore_env_runners": 2.7460458465422105e-05, "training_step": 4.72012006332265, "env_runner_sampling_timer": 4.526066263737742, "learner_update_timer": 0.189261854542827, "synch_weights": 0.0013168854387956737, "restore_eval_env_runners": 1.2098627793786466e-05, "evaluation_iteration": 0.26400068390673836, "synch_eval_env_connectors": 0.00016486233980040013, "synch_env_connectors": 4.8012544444039504e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.9799751247036106e-06, "numpy_to_tensor": 1.962322928350281e-05, "add_time_dim_to_batch_and_zero_pad": 5.237227532063557e-06, "batch_individual_items": 1.3794103043672653e-05, "add_observations_from_episodes_to_batch": 5.9388144646407395e-06}}, "connector_pipeline_timer": 8.509868247040406e-05}, "env_step_timer": 4.390696450362547e-05, "module_episode_returns_mean": {"default_policy": 6.179999999999998}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 9.79490031820658e-06, "remove_single_ts_time_rank_from_batch": 1.1185140626781368e-06, "listify_data_for_vector_env": 2.4755383281695396e-05, "get_actions": 0.00010764809350550339, "tensor_to_numpy": 2.884707224871071e-05, "normalize_and_clip_actions": 1.780062841198798e-05}}, "connector_pipeline_timer": 0.0002366013149942714}, "episode_return_min": -9.5, "episode_return_mean": 6.179999999999998, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_reset_timer": 0.00010890839385155804, "num_episodes": 250.0, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "episode_return_max": 10.5, "episode_len_max": 20, "time_between_sampling": 0.0037332662047345534, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "episode_duration_sec_mean": 0.010291116482112554, "agent_episode_returns_mean": {"default_agent": 6.179999999999998}, "weights_seq_no": 9.0, "num_env_steps_sampled_lifetime": -4930000.0, "sample": 0.01102365836607035, "rlmodule_inference_timer": 6.730051459720013e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "num_episodes_lifetime": -246500.0, "num_env_steps_sampled_lifetime_throughput": 2097.8599619359284}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04742022571430374, "add_one_ts_to_episodes_and_truncate": 0.01965967263079459, "general_advantage_estimation": 0.013135414292075001, "add_columns_from_episodes_to_train_batch": 0.053796123900376094, "numpy_to_tensor": 9.224570823604096e-05, "add_time_dim_to_batch_and_zero_pad": 2.086499843061371e-05, "add_states_from_episodes_to_batch": 4.902209297426696e-06, "add_observations_from_episodes_to_batch": 0.002416755818785383}}, "connector_pipeline_timer": 0.13684257312031398}, "num_module_steps_trained_lifetime": 60000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 315000, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1235162.6315760803, "num_module_steps_trained_throughput": 236015.41969628667, "num_module_steps_trained_lifetime_throughput": 235770.96689534522}, "default_policy": {"mean_kl_loss": 0.00011014497431460768, "num_module_steps_trained_lifetime": 60000, "weights_seq_no": 10.0, "num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "vf_loss": 0.10278083384037018, "gradients_default_optimizer_global_norm": 0.0812729150056839, "curr_kl_coeff": 0.0007290003122761846, "entropy": 0.5978839993476868, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 27.982223510742188, "total_loss": -0.14074070751667023, "policy_loss": -0.20406639575958252, "module_train_batch_size_mean": 1000.0, "vf_explained_var": -0.009058833122253418, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime_throughput": 236319.97881807023}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.454146114198645e-06, "batch_individual_items": 9.422952124414549e-06, "numpy_to_tensor": 1.2574491229866776e-05, "add_time_dim_to_batch_and_zero_pad": 3.1401816799889234e-06, "add_states_from_episodes_to_batch": 1.853801056049439e-06}}, "connector_pipeline_timer": 5.797309101841489e-05}, "weights_seq_no": 10.0, "agent_episode_returns_mean": {"default_agent": -0.55}, "env_step_timer": 2.4251934735589754e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "num_episodes": 20, "episode_return_max": 14.5, "episode_duration_sec_mean": 0.0072525695723015815, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.3304278195941532e-05, "remove_single_ts_time_rank_from_batch": 8.150380881863893e-07, "un_batch_to_individual_items": 6.922984498085987e-06, "get_actions": 6.27844210040158e-05, "listify_data_for_vector_env": 1.5565322525178705e-05, "tensor_to_numpy": 2.4130858031643018e-05}}, "connector_pipeline_timer": 0.00015823301375727665}, "episode_return_min": -12.5, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.24681300114966104, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "num_episodes_lifetime": 200, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": -0.55}, "env_reset_timer": 0.0008753521036760308, "episode_len_min": 20, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 50400, "rlmodule_inference_timer": 4.269675921613866e-05, "episode_return_mean": -0.55, "time_between_sampling": 2.8106425278164933}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "49f87_00000", "date": "2025-08-11_19-32-17", "timestamp": 1754933537, "time_this_iter_s": 3.5206611156463623, "time_total_s": 35.24338436126709, "pid": 24466, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16fe2d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 35.24338436126709, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 84.31666666666666, "ram_util_percent": 81.21666666666665}}
{"timers": {"training_iteration": 4.708692181403268, "restore_env_runners": 2.725293355335778e-05, "training_step": 4.708386228109614, "env_runner_sampling_timer": 4.51349145027103, "learner_update_timer": 0.19005245724700706, "synch_weights": 0.0013272299241004438, "restore_eval_env_runners": 1.2062231216994489e-05, "evaluation_iteration": 0.26285528747738895, "synch_eval_env_connectors": 0.0001646753864378925, "synch_env_connectors": 4.803241116531361e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.158059928349651e-06, "numpy_to_tensor": 2.339036076128656e-05, "add_time_dim_to_batch_and_zero_pad": 5.241845476168526e-06, "batch_individual_items": 1.5133252152484855e-05, "add_observations_from_episodes_to_batch": 6.263010649947069e-06}}, "connector_pipeline_timer": 9.478159706078627e-05}, "env_step_timer": 3.296259162764589e-05, "module_episode_returns_mean": {"default_policy": 4.740000000000002}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.118354439547398e-05, "remove_single_ts_time_rank_from_batch": 1.419571495436864e-06, "listify_data_for_vector_env": 2.329896246660175e-05, "get_actions": 0.0001098809547592851, "tensor_to_numpy": 3.297080579575953e-05, "normalize_and_clip_actions": 1.9564257474284085e-05}}, "connector_pipeline_timer": 0.00024963145835257627}, "episode_return_min": -9.5, "episode_return_mean": 4.740000000000002, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_reset_timer": 0.0001042143768162152, "num_episodes": 250.0, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "episode_return_max": 10.5, "episode_len_max": 20, "time_between_sampling": 0.003223011433571986, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "episode_duration_sec_mean": 0.010950107536744332, "agent_episode_returns_mean": {"default_agent": 4.740000000000002}, "weights_seq_no": 10.0, "num_env_steps_sampled_lifetime": -5547500.0, "sample": 0.011019932111095952, "rlmodule_inference_timer": 7.287576726195519e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "num_episodes_lifetime": -277375.0, "num_env_steps_sampled_lifetime_throughput": 2013.5475284623526}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.0478310180480485, "add_one_ts_to_episodes_and_truncate": 0.01962866507455142, "general_advantage_estimation": 0.013135971399218401, "add_columns_from_episodes_to_train_batch": 0.054051362661561575, "numpy_to_tensor": 9.896700085826503e-05, "add_time_dim_to_batch_and_zero_pad": 2.2165518261415756e-05, "add_states_from_episodes_to_batch": 4.986936767699394e-06, "add_observations_from_episodes_to_batch": 0.0024068986710766124}}, "connector_pipeline_timer": 0.13747624530915983}, "num_module_steps_trained_lifetime": 66000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 346500, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1215703.3699760884, "num_module_steps_trained_throughput": 232273.0800442609, "num_module_steps_trained_lifetime_throughput": 232041.4620357794}, "default_policy": {"mean_kl_loss": 0.0002990176435559988, "num_module_steps_trained_lifetime": 66000, "weights_seq_no": 11.0, "num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "vf_loss": 0.10278083384037018, "gradients_default_optimizer_global_norm": 0.032687243074178696, "curr_kl_coeff": 0.0003645001561380923, "entropy": 0.5904799699783325, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 28.26639175415039, "total_loss": -0.018643252551555634, "policy_loss": -0.08203604817390442, "module_train_batch_size_mean": 1000.0, "vf_explained_var": -0.010197997093200684, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime_throughput": 232555.17579165625}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 5.451251857851543e-06, "batch_individual_items": 1.1596825751584942e-05, "numpy_to_tensor": 1.8676061960157198e-05, "add_time_dim_to_batch_and_zero_pad": 4.910596612297548e-06, "add_states_from_episodes_to_batch": 2.5002615194963963e-06}}, "connector_pipeline_timer": 8.028813664686987e-05}, "weights_seq_no": 11.0, "agent_episode_returns_mean": {"default_agent": 0.05}, "env_step_timer": 3.228015125302632e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "num_episodes": 20, "episode_return_max": 14.5, "episode_duration_sec_mean": 0.007270234178286046, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.5518455318912534e-05, "remove_single_ts_time_rank_from_batch": 1.1187565117583144e-06, "un_batch_to_individual_items": 9.826797636218197e-06, "get_actions": 9.704743329983207e-05, "listify_data_for_vector_env": 2.2476689875322754e-05, "tensor_to_numpy": 2.7532053026573794e-05}}, "connector_pipeline_timer": 0.00022805649331025647}, "episode_return_min": -12.5, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.2461761357189972, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "num_episodes_lifetime": 220, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 0.05}, "env_reset_timer": 0.0008704356630788231, "episode_len_min": 20, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 55400, "rlmodule_inference_timer": 6.125448384023915e-05, "episode_return_mean": 0.05, "time_between_sampling": 2.8183753500381536}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "49f87_00000", "date": "2025-08-11_19-32-21", "timestamp": 1754933541, "time_this_iter_s": 3.7493810653686523, "time_total_s": 38.99276542663574, "pid": 24466, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16fe2d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 38.99276542663574, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 83.34, "ram_util_percent": 81.13999999999999}}
{"timers": {"training_iteration": 4.693616950419349, "restore_env_runners": 2.7186243969112494e-05, "training_step": 4.693310204157818, "env_runner_sampling_timer": 4.498943789108375, "learner_update_timer": 0.1894819614247722, "synch_weights": 0.001327746374788957, "restore_eval_env_runners": 1.3095359249935438e-05, "evaluation_iteration": 0.2622070975224728, "synch_eval_env_connectors": 0.0001705036324483438, "synch_env_connectors": 4.8010484024886214e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.858465548747981e-06, "numpy_to_tensor": 1.9264543655994704e-05, "add_time_dim_to_batch_and_zero_pad": 4.677676210687151e-06, "batch_individual_items": 1.3111415504928892e-05, "add_observations_from_episodes_to_batch": 5.7963282079420025e-06}}, "connector_pipeline_timer": 8.25918454598437e-05}, "env_step_timer": 2.9743079661746197e-05, "module_episode_returns_mean": {"default_policy": 5.619999999999999}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 9.955607073871296e-06, "remove_single_ts_time_rank_from_batch": 1.0181610128003185e-06, "listify_data_for_vector_env": 2.1449304742709292e-05, "get_actions": 9.191042091558142e-05, "tensor_to_numpy": 2.734707668749648e-05, "normalize_and_clip_actions": 1.7502703463714078e-05}}, "connector_pipeline_timer": 0.00021391473921559314}, "episode_return_min": -9.5, "episode_return_mean": 5.619999999999999, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_reset_timer": 9.642412505598657e-05, "num_episodes": 250.0, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "episode_return_max": 10.5, "episode_len_max": 20, "time_between_sampling": 0.004293738784704637, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "episode_duration_sec_mean": 0.00931062031257898, "agent_episode_returns_mean": {"default_agent": 5.619999999999999}, "weights_seq_no": 11.0, "num_env_steps_sampled_lifetime": -6165000.0, "sample": 0.010572958986206615, "rlmodule_inference_timer": 6.106814071106702e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "num_episodes_lifetime": -308250.0, "num_env_steps_sampled_lifetime_throughput": 2082.5784739546602}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04775202036678011, "add_one_ts_to_episodes_and_truncate": 0.019530796344332024, "general_advantage_estimation": 0.013108246275276422, "add_columns_from_episodes_to_train_batch": 0.0539756636149916, "numpy_to_tensor": 9.898233035317569e-05, "add_time_dim_to_batch_and_zero_pad": 2.2127192763461436e-05, "add_states_from_episodes_to_batch": 5.022896924345744e-06, "add_observations_from_episodes_to_batch": 0.0023922880148257394}}, "connector_pipeline_timer": 0.13717987327694842}, "num_module_steps_trained_lifetime": 72000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 378000, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1203262.800725717, "num_module_steps_trained_throughput": 229891.13622832473, "num_module_steps_trained_lifetime_throughput": 229670.89893921427}, "default_policy": {"mean_kl_loss": 0.0009873730596154928, "num_module_steps_trained_lifetime": 72000, "weights_seq_no": 12.0, "num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "vf_loss": 0.10278083384037018, "gradients_default_optimizer_global_norm": 0.07592751830816269, "curr_kl_coeff": 0.00018225007806904614, "entropy": 0.5664700865745544, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 28.210323333740234, "total_loss": 0.02147681638598442, "policy_loss": -0.04213358461856842, "module_train_batch_size_mean": 1000.0, "vf_explained_var": -0.009987235069274902, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime_throughput": 230154.0935838326}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.637214621831274e-06, "batch_individual_items": 8.553751426088122e-06, "numpy_to_tensor": 1.2373781700076308e-05, "add_time_dim_to_batch_and_zero_pad": 3.6134120928150086e-06, "add_states_from_episodes_to_batch": 1.9732560082589535e-06}}, "connector_pipeline_timer": 6.10117498206835e-05}, "weights_seq_no": 12.0, "agent_episode_returns_mean": {"default_agent": 0.45}, "env_step_timer": 2.122958618118371e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "num_episodes": 20, "episode_return_max": 14.5, "episode_duration_sec_mean": 0.007086116248974577, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.3325404577314552e-05, "remove_single_ts_time_rank_from_batch": 7.566844026227426e-07, "un_batch_to_individual_items": 7.973674738670557e-06, "get_actions": 5.538761925889653e-05, "listify_data_for_vector_env": 1.6273700858620076e-05, "tensor_to_numpy": 1.8434241364184322e-05}}, "connector_pipeline_timer": 0.00014820574878368005}, "episode_return_min": -12.5, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.2453155510218495, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "num_episodes_lifetime": 240, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 0.45}, "env_reset_timer": 0.0008646363064492269, "episode_len_min": 20, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 60400, "rlmodule_inference_timer": 5.264972742025316e-05, "episode_return_mean": 0.45, "time_between_sampling": 2.8226039048770346}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "49f87_00000", "date": "2025-08-11_19-32-24", "timestamp": 1754933544, "time_this_iter_s": 3.376910924911499, "time_total_s": 42.36967635154724, "pid": 24466, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16fe2d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 42.36967635154724, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 82.38, "ram_util_percent": 80.56}}
{"timers": {"training_iteration": 4.676135587585702, "restore_env_runners": 2.6985631198839107e-05, "training_step": 4.675829741285998, "env_runner_sampling_timer": 4.482192498717961, "learner_update_timer": 0.18876467181051076, "synch_weights": 0.001322364330880837, "restore_eval_env_runners": 1.3074815112809967e-05, "evaluation_iteration": 0.2612883165471075, "synch_eval_env_connectors": 0.00017280734608943866, "synch_env_connectors": 4.805957995459823e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.7123558637043377e-06, "numpy_to_tensor": 1.9029013822145824e-05, "add_time_dim_to_batch_and_zero_pad": 4.621626738140707e-06, "batch_individual_items": 1.3340315720769191e-05, "add_observations_from_episodes_to_batch": 5.7027394186931754e-06}}, "connector_pipeline_timer": 8.181778412123267e-05}, "env_step_timer": 2.8847114886833865e-05, "module_episode_returns_mean": {"default_policy": 6.419999999999999}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.0061215000767927e-05, "remove_single_ts_time_rank_from_batch": 1.2231857916139996e-06, "listify_data_for_vector_env": 2.0950388714229934e-05, "get_actions": 9.305541947546575e-05, "tensor_to_numpy": 2.7781316174639137e-05, "normalize_and_clip_actions": 1.7629045209737067e-05}}, "connector_pipeline_timer": 0.0002166278842197123}, "episode_return_min": -9.5, "episode_return_mean": 6.419999999999999, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_reset_timer": 9.128016576101389e-05, "num_episodes": 250.0, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "episode_return_max": 10.5, "episode_len_max": 20, "time_between_sampling": 0.0029874461457978056, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "episode_duration_sec_mean": 0.009070543161127716, "agent_episode_returns_mean": {"default_agent": 6.419999999999999}, "weights_seq_no": 12.0, "num_env_steps_sampled_lifetime": -6782500.0, "sample": 0.010358375740224076, "rlmodule_inference_timer": 5.9100742508378045e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "num_episodes_lifetime": -339125.0, "num_env_steps_sampled_lifetime_throughput": 2174.8934614649297}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04762763974264125, "add_one_ts_to_episodes_and_truncate": 0.01942218130061053, "general_advantage_estimation": 0.013061082153493489, "add_columns_from_episodes_to_train_batch": 0.05381531613907385, "numpy_to_tensor": 9.882709780504697e-05, "add_time_dim_to_batch_and_zero_pad": 2.2015920509267875e-05, "add_states_from_episodes_to_batch": 5.005587879808507e-06, "add_observations_from_episodes_to_batch": 0.002376823464507801}}, "connector_pipeline_timer": 0.13672184079419322}, "num_module_steps_trained_lifetime": 78000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 409500, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1194028.4281810436, "num_module_steps_trained_throughput": 228131.34430071848, "num_module_steps_trained_lifetime_throughput": 227920.71565310616}, "default_policy": {"mean_kl_loss": 0.00015232563600875437, "num_module_steps_trained_lifetime": 78000, "weights_seq_no": 13.0, "num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "vf_loss": 0.10278083384037018, "gradients_default_optimizer_global_norm": 0.03824322298169136, "curr_kl_coeff": 9.112503903452307e-05, "entropy": 0.5557562112808228, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 28.251325607299805, "total_loss": 0.0764087438583374, "policy_loss": 0.012701627798378468, "module_train_batch_size_mean": 1000.0, "vf_explained_var": -0.010016202926635742, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime_throughput": 228378.05301992036}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.831643460036029e-06, "batch_individual_items": 1.665362678059668e-05, "numpy_to_tensor": 2.6551682881883487e-05, "add_time_dim_to_batch_and_zero_pad": 6.892407251257442e-06, "add_states_from_episodes_to_batch": 3.7163419770109212e-06}}, "connector_pipeline_timer": 0.000106326884899379}, "weights_seq_no": 13.0, "agent_episode_returns_mean": {"default_agent": 0.05}, "env_step_timer": 4.169895120093596e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "num_episodes": 20, "episode_return_max": 14.5, "episode_duration_sec_mean": 0.007456079197581857, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 2.4723968750307153e-05, "remove_single_ts_time_rank_from_batch": 1.998782126973583e-06, "un_batch_to_individual_items": 1.2331467591774356e-05, "get_actions": 0.00011318071012921029, "listify_data_for_vector_env": 2.8678454522297355e-05, "tensor_to_numpy": 3.458305084056331e-05}}, "connector_pipeline_timer": 0.00027607791275413487}, "episode_return_min": -12.5, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.24489355593120501, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "num_episodes_lifetime": 260, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 0.05}, "env_reset_timer": 0.0008567532833065667, "episode_len_min": 20, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 65400, "rlmodule_inference_timer": 7.877831463907502e-05, "episode_return_mean": 0.05, "time_between_sampling": 2.824073356248827}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "49f87_00000", "date": "2025-08-11_19-32-27", "timestamp": 1754933547, "time_this_iter_s": 3.158215045928955, "time_total_s": 45.527891397476196, "pid": 24466, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16fe2d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 45.527891397476196, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 79.425, "ram_util_percent": 80.875}}
{"timers": {"training_iteration": 4.658992354619296, "restore_env_runners": 2.679619459116876e-05, "training_step": 4.658683581372636, "env_runner_sampling_timer": 4.4640880112306816, "learner_update_timer": 0.18970216551228747, "synch_weights": 0.001326665277356472, "restore_eval_env_runners": 1.3014906849166775e-05, "evaluation_iteration": 0.2607859292120568, "synch_eval_env_connectors": 0.00017435552225519567, "synch_env_connectors": 4.802067552759583e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.7917715868085626e-06, "numpy_to_tensor": 1.987378884131788e-05, "add_time_dim_to_batch_and_zero_pad": 4.4531656922724215e-06, "batch_individual_items": 1.2906491836024498e-05, "add_observations_from_episodes_to_batch": 5.20553770725494e-06}}, "connector_pipeline_timer": 8.025573180502547e-05}, "env_step_timer": 2.8995701050638696e-05, "module_episode_returns_mean": {"default_policy": 6.74}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 9.256254062569208e-06, "remove_single_ts_time_rank_from_batch": 1.0793977077268646e-06, "listify_data_for_vector_env": 1.9925815673577902e-05, "get_actions": 8.893625048218026e-05, "tensor_to_numpy": 2.4730013430443297e-05, "normalize_and_clip_actions": 1.6792329806211947e-05}}, "connector_pipeline_timer": 0.0002049594209851952}, "episode_return_min": -9.5, "episode_return_mean": 6.74, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_reset_timer": 8.597216825295892e-05, "num_episodes": 250.0, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "episode_return_max": 10.5, "episode_len_max": 20, "time_between_sampling": 0.002807023398675649, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "episode_duration_sec_mean": 0.008930260009597984, "agent_episode_returns_mean": {"default_agent": 6.74}, "weights_seq_no": 13.0, "num_env_steps_sampled_lifetime": -7400000.0, "sample": 0.009484277434038497, "rlmodule_inference_timer": 5.7407996357875085e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "num_episodes_lifetime": -370000.0, "num_env_steps_sampled_lifetime_throughput": 2243.5003127019017}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04886642876535442, "add_one_ts_to_episodes_and_truncate": 0.019333251157792733, "general_advantage_estimation": 0.013026930501830658, "add_columns_from_episodes_to_train_batch": 0.05375459255832502, "numpy_to_tensor": 9.880799718689113e-05, "add_time_dim_to_batch_and_zero_pad": 2.1956171140273747e-05, "add_states_from_episodes_to_batch": 5.003031780622247e-06, "add_observations_from_episodes_to_batch": 0.002362163569299075}}, "connector_pipeline_timer": 0.1377608694756354}, "num_module_steps_trained_lifetime": 84000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 441000, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1181158.6270534636, "num_module_steps_trained_throughput": 225667.1410872694, "num_module_steps_trained_lifetime_throughput": 225468.49269984994}, "default_policy": {"mean_kl_loss": 5.350949504645541e-05, "num_module_steps_trained_lifetime": 84000, "weights_seq_no": 14.0, "num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "vf_loss": 0.10278083384037018, "gradients_default_optimizer_global_norm": 0.028520269319415092, "curr_kl_coeff": 4.5562519517261535e-05, "entropy": 0.5543418526649475, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 27.92440414428711, "total_loss": -0.13544487953186035, "policy_loss": -0.1991647630929947, "module_train_batch_size_mean": 1000.0, "vf_explained_var": -0.008661389350891113, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime_throughput": 225896.0564610736}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.743391488443531e-06, "batch_individual_items": 7.935372731183957e-06, "numpy_to_tensor": 1.1592080613507459e-05, "add_time_dim_to_batch_and_zero_pad": 3.3967779517092643e-06, "add_states_from_episodes_to_batch": 1.9832184189054363e-06}}, "connector_pipeline_timer": 5.5386433998401325e-05}, "weights_seq_no": 14.0, "agent_episode_returns_mean": {"default_agent": 0.05}, "env_step_timer": 2.3123926226690562e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "num_episodes": 20, "episode_return_max": 14.5, "episode_duration_sec_mean": 0.007642794613493606, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.2712558350905453e-05, "remove_single_ts_time_rank_from_batch": 7.93581996342585e-07, "un_batch_to_individual_items": 6.788519977883227e-06, "get_actions": 5.3520517297285895e-05, "listify_data_for_vector_env": 1.433862023031264e-05, "tensor_to_numpy": 1.7921796334095647e-05}}, "connector_pipeline_timer": 0.0001403301491213827}, "episode_return_min": -12.5, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.24391755537209464, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "num_episodes_lifetime": 280, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 0.05}, "env_reset_timer": 0.000848981170965569, "episode_len_min": 20, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 70400, "rlmodule_inference_timer": 4.050393094329112e-05, "episode_return_mean": 0.05, "time_between_sampling": 2.8258353160165095}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "49f87_00000", "date": "2025-08-11_19-32-31", "timestamp": 1754933551, "time_this_iter_s": 3.1213650703430176, "time_total_s": 48.649256467819214, "pid": 24466, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16fe2d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 48.649256467819214, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 63.120000000000005, "ram_util_percent": 80.8}}
{"timers": {"training_iteration": 4.6413486173236445, "restore_env_runners": 2.6591143485172345e-05, "training_step": 4.6410406576384675, "env_runner_sampling_timer": 4.445824200707591, "learner_update_timer": 0.1903218351064942, "synch_weights": 0.0013203702946647463, "restore_eval_env_runners": 1.3044337575529032e-05, "evaluation_iteration": 0.25972412950022317, "synch_eval_env_connectors": 0.0001755994670799549, "synch_env_connectors": 4.796966878083142e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.746824315789233e-06, "numpy_to_tensor": 1.826879232828224e-05, "add_time_dim_to_batch_and_zero_pad": 4.368932822744517e-06, "batch_individual_items": 1.2575386004124046e-05, "add_observations_from_episodes_to_batch": 5.462362325899104e-06}}, "connector_pipeline_timer": 7.81037298078876e-05}, "env_step_timer": 2.7495846417052685e-05, "module_episode_returns_mean": {"default_policy": 5.299999999999998}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 9.560347706704949e-06, "remove_single_ts_time_rank_from_batch": 1.1612710091875938e-06, "listify_data_for_vector_env": 2.1311973641793034e-05, "get_actions": 8.754873519870745e-05, "tensor_to_numpy": 2.5621950629039165e-05, "normalize_and_clip_actions": 1.6945829387127998e-05}}, "connector_pipeline_timer": 0.00020580958276476867}, "episode_return_min": -9.5, "episode_return_mean": 5.299999999999998, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_reset_timer": 8.724733882572686e-05, "num_episodes": 250.0, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "episode_return_max": 10.5, "episode_len_max": 20, "time_between_sampling": 0.00296808850514737, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "episode_duration_sec_mean": 0.008714408503379675, "agent_episode_returns_mean": {"default_agent": 5.299999999999998}, "weights_seq_no": 14.0, "num_env_steps_sampled_lifetime": -8017500.0, "sample": 0.009275058804795193, "rlmodule_inference_timer": 5.688566763979623e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "num_episodes_lifetime": -400875.0, "num_env_steps_sampled_lifetime_throughput": 2199.0950529069846}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.05002668364795758, "add_one_ts_to_episodes_and_truncate": 0.01926740280669024, "general_advantage_estimation": 0.012953914947086309, "add_columns_from_episodes_to_train_batch": 0.05367805704295934, "numpy_to_tensor": 9.862199666349866e-05, "add_time_dim_to_batch_and_zero_pad": 2.1835768507543536e-05, "add_states_from_episodes_to_batch": 4.984672251119043e-06, "add_observations_from_episodes_to_batch": 0.002351410264420029}}, "connector_pipeline_timer": 0.13869299078144015}, "num_module_steps_trained_lifetime": 90000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 472500, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1179085.6025748644, "num_module_steps_trained_throughput": 225255.48752872678, "num_module_steps_trained_lifetime_throughput": 225066.30566441486}, "default_policy": {"mean_kl_loss": 8.566788892494515e-05, "num_module_steps_trained_lifetime": 90000, "weights_seq_no": 15.0, "num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "vf_loss": 0.10278083384037018, "gradients_default_optimizer_global_norm": 0.03713970631361008, "curr_kl_coeff": 2.2781259758630767e-05, "entropy": 0.5600871443748474, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 28.36760139465332, "total_loss": 0.11288011074066162, "policy_loss": 0.049212247133255005, "module_train_batch_size_mean": 1000.0, "vf_explained_var": -0.010147690773010254, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime_throughput": 225460.08939897342}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.71153533019345e-06, "batch_individual_items": 9.874484320900803e-06, "numpy_to_tensor": 1.3711400359615789e-05, "add_time_dim_to_batch_and_zero_pad": 3.674451410346301e-06, "add_states_from_episodes_to_batch": 2.240331418476597e-06}}, "connector_pipeline_timer": 6.430451195307095e-05}, "weights_seq_no": 15.0, "agent_episode_returns_mean": {"default_agent": 0.85}, "env_step_timer": 2.062976778258101e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "num_episodes": 20, "episode_return_max": 14.5, "episode_duration_sec_mean": 0.007969832954695449, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.4071318913689856e-05, "remove_single_ts_time_rank_from_batch": 7.777553587696882e-07, "un_batch_to_individual_items": 8.454551412559059e-06, "get_actions": 6.177090815554119e-05, "listify_data_for_vector_env": 1.63493622034934e-05, "tensor_to_numpy": 2.0463733400671428e-05}}, "connector_pipeline_timer": 0.0001570024001851222}, "episode_return_min": -12.5, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.24324902356857933, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "num_episodes_lifetime": 300, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 0.85}, "env_reset_timer": 0.0008435142693516645, "episode_len_min": 20, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 75400, "rlmodule_inference_timer": 4.3364509253860497e-05, "episode_return_mean": 0.85, "time_between_sampling": 2.8267765945163568}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "49f87_00000", "date": "2025-08-11_19-32-34", "timestamp": 1754933554, "time_this_iter_s": 3.086158037185669, "time_total_s": 51.73541450500488, "pid": 24466, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16fe2d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 51.73541450500488, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 77.775, "ram_util_percent": 80.7}}
{"timers": {"training_iteration": 4.620730007809464, "restore_env_runners": 2.638606138428163e-05, "training_step": 4.620423136482461, "env_runner_sampling_timer": 4.425945780780491, "learner_update_timer": 0.18957463217599463, "synch_weights": 0.0013173920118373396, "restore_eval_env_runners": 1.2985564128503277e-05, "evaluation_iteration": 0.25900813820508123, "synch_eval_env_connectors": 0.00017502181199854255, "synch_env_connectors": 4.793577292642717e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.6460726043947064e-06, "numpy_to_tensor": 1.639618803804837e-05, "add_time_dim_to_batch_and_zero_pad": 4.2139392344536575e-06, "batch_individual_items": 1.178816235408186e-05, "add_observations_from_episodes_to_batch": 4.69045052121948e-06}}, "connector_pipeline_timer": 7.272364496730041e-05}, "env_step_timer": 2.6603981558026155e-05, "module_episode_returns_mean": {"default_policy": 7.2200000000000015}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 8.874704802696598e-06, "remove_single_ts_time_rank_from_batch": 9.240311124311506e-07, "listify_data_for_vector_env": 1.9033867605156686e-05, "get_actions": 8.154550528408098e-05, "tensor_to_numpy": 2.3922467046980096e-05, "normalize_and_clip_actions": 1.556546465783654e-05}}, "connector_pipeline_timer": 0.0001914644548952207}, "episode_return_min": -9.5, "episode_return_mean": 7.2200000000000015, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_reset_timer": 7.525324297828568e-05, "num_episodes": 250.0, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "episode_return_max": 10.5, "episode_len_max": 20, "time_between_sampling": 0.0030584495921599955, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "episode_duration_sec_mean": 0.008240944834426044, "agent_episode_returns_mean": {"default_agent": 7.2200000000000015}, "weights_seq_no": 15.0, "num_env_steps_sampled_lifetime": -8635000.0, "sample": 0.008926909623052856, "rlmodule_inference_timer": 5.179043518123697e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "num_episodes_lifetime": -431750.0, "num_env_steps_sampled_lifetime_throughput": 2412.4011032096846}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04988793431161032, "add_one_ts_to_episodes_and_truncate": 0.01916138044890418, "general_advantage_estimation": 0.012909046637912341, "add_columns_from_episodes_to_train_batch": 0.0535473693819273, "numpy_to_tensor": 0.00010057910644276728, "add_time_dim_to_batch_and_zero_pad": 2.186450117889255e-05, "add_states_from_episodes_to_batch": 4.978986516789682e-06, "add_observations_from_episodes_to_batch": 0.002336501581201122}}, "connector_pipeline_timer": 0.13825851379307166}, "num_module_steps_trained_lifetime": 96000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 504000, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1182833.2050015936, "num_module_steps_trained_throughput": 225951.12901447222, "num_module_steps_trained_lifetime_throughput": 225769.3488552251}, "default_policy": {"mean_kl_loss": 0.0002683716011233628, "num_module_steps_trained_lifetime": 96000, "weights_seq_no": 16.0, "num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "vf_loss": 0.10278083384037018, "gradients_default_optimizer_global_norm": 0.02891549840569496, "curr_kl_coeff": 1.1390629879315384e-05, "entropy": 0.5402327179908752, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 28.182588577270508, "total_loss": 0.11603890359401703, "policy_loss": 0.05219123512506485, "module_train_batch_size_mean": 1000.0, "vf_explained_var": -0.009708046913146973, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime_throughput": 226128.43006186225}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.881883523804985e-06, "batch_individual_items": 1.0595196774577658e-05, "numpy_to_tensor": 1.6196601292847455e-05, "add_time_dim_to_batch_and_zero_pad": 3.9226591878939976e-06, "add_states_from_episodes_to_batch": 2.5276512440814474e-06}}, "connector_pipeline_timer": 7.076485404395217e-05}, "weights_seq_no": 16.0, "agent_episode_returns_mean": {"default_agent": 0.05}, "env_step_timer": 2.1936766552352696e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "num_episodes": 20, "episode_return_max": 14.5, "episode_duration_sec_mean": 0.008502372510265558, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.4047298405639545e-05, "remove_single_ts_time_rank_from_batch": 7.710907737834234e-07, "un_batch_to_individual_items": 8.238187766944206e-06, "get_actions": 6.1006963095825345e-05, "listify_data_for_vector_env": 1.864181160529288e-05, "tensor_to_numpy": 2.3079134361683167e-05}}, "connector_pipeline_timer": 0.00016411445924287632}, "episode_return_min": -12.5, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.24319778916213466, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "num_episodes_lifetime": 320, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 0.05}, "env_reset_timer": 0.0008359507863803271, "episode_len_min": 20, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 80400, "rlmodule_inference_timer": 4.736690372084949e-05, "episode_return_mean": 0.05, "time_between_sampling": 2.82459021065164}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "49f87_00000", "date": "2025-08-11_19-32-37", "timestamp": 1754933557, "time_this_iter_s": 2.827475070953369, "time_total_s": 54.56288957595825, "pid": 24466, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16fe2d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 54.56288957595825, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 75.30000000000001, "ram_util_percent": 80.325}}
{"timers": {"training_iteration": 4.610746916481433, "restore_env_runners": 2.619428048110118e-05, "training_step": 4.610440674697788, "env_runner_sampling_timer": 4.416516934643309, "learner_update_timer": 0.18900116293426952, "synch_weights": 0.0013172322618273291, "restore_eval_env_runners": 1.2958207521473987e-05, "evaluation_iteration": 0.2588705759830273, "synch_eval_env_connectors": 0.00017457159330001954, "synch_env_connectors": 4.791890998771694e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.0072624839457597e-06, "numpy_to_tensor": 2.4253781593810428e-05, "add_time_dim_to_batch_and_zero_pad": 5.202684619896111e-06, "batch_individual_items": 1.364617284673958e-05, "add_observations_from_episodes_to_batch": 7.290729695940475e-06}}, "connector_pipeline_timer": 9.102042697977268e-05}, "env_step_timer": 3.313817893873929e-05, "module_episode_returns_mean": {"default_policy": 7.299999999999996}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.2344231169168686e-05, "remove_single_ts_time_rank_from_batch": 1.081315188694454e-06, "listify_data_for_vector_env": 2.4889333801941676e-05, "get_actions": 0.00011723274844042882, "tensor_to_numpy": 2.853322708641933e-05, "normalize_and_clip_actions": 1.856421546229481e-05}}, "connector_pipeline_timer": 0.0002537164262668061}, "episode_return_min": -9.5, "episode_return_mean": 7.299999999999996, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_reset_timer": 8.277232592577472e-05, "num_episodes": 250.0, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "episode_return_max": 10.5, "episode_len_max": 20, "time_between_sampling": 0.0027203323278784173, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "episode_duration_sec_mean": 0.011912374475039542, "agent_episode_returns_mean": {"default_agent": 7.299999999999996}, "weights_seq_no": 16.0, "num_env_steps_sampled_lifetime": -9252500.0, "sample": 0.01053336319644882, "rlmodule_inference_timer": 0.00011648210120199863, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "num_episodes_lifetime": -462625.0, "num_env_steps_sampled_lifetime_throughput": 2133.478378294094}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.04972334704828192, "add_one_ts_to_episodes_and_truncate": 0.01912944706401664, "general_advantage_estimation": 0.012846672002004586, "add_columns_from_episodes_to_train_batch": 0.053501538188286915, "numpy_to_tensor": 0.0001002370654848084, "add_time_dim_to_batch_and_zero_pad": 2.1825026332314586e-05, "add_states_from_episodes_to_batch": 4.967106137021508e-06, "add_observations_from_episodes_to_batch": 0.0023312699048612254}}, "connector_pipeline_timer": 0.13794659532454323}, "num_module_steps_trained_lifetime": 102000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 535500, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1188112.2610595883, "num_module_steps_trained_throughput": 226937.59877431882, "num_module_steps_trained_lifetime_throughput": 226762.8218403269}, "default_policy": {"mean_kl_loss": 1.595735375303775e-05, "num_module_steps_trained_lifetime": 102000, "weights_seq_no": 17.0, "num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "vf_loss": 0.10278083384037018, "gradients_default_optimizer_global_norm": 0.05952993407845497, "curr_kl_coeff": 5.695314939657692e-06, "entropy": 0.5353696346282959, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 28.024700164794922, "total_loss": 0.005944760516285896, "policy_loss": -0.057946957647800446, "module_train_batch_size_mean": 1000.0, "vf_explained_var": -0.00909113883972168, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime_throughput": 227090.51018210305}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.62530542135317e-06, "batch_individual_items": 7.75675199382834e-06, "numpy_to_tensor": 1.2224692446832287e-05, "add_time_dim_to_batch_and_zero_pad": 2.9352716546734183e-06, "add_states_from_episodes_to_batch": 1.9037279612315642e-06}}, "connector_pipeline_timer": 5.405238663607315e-05}, "weights_seq_no": 17.0, "agent_episode_returns_mean": {"default_agent": 0.05}, "env_step_timer": 1.809413505886777e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "num_episodes": 20, "episode_return_max": 14.5, "episode_duration_sec_mean": 0.008274911277694627, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.1534030828426963e-05, "remove_single_ts_time_rank_from_batch": 6.923025513396223e-07, "un_batch_to_individual_items": 6.2321738624350764e-06, "get_actions": 4.798646922992497e-05, "listify_data_for_vector_env": 1.477321962055097e-05, "tensor_to_numpy": 1.5884875446984266e-05}}, "connector_pipeline_timer": 0.00012790212074775681}, "episode_return_min": -12.5, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.2421198466901581, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "num_episodes_lifetime": 340, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 0.05}, "env_reset_timer": 0.0008283746185906457, "episode_len_min": 20, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 85400, "rlmodule_inference_timer": 3.4448511228620587e-05, "episode_return_mean": 0.05, "time_between_sampling": 2.8329112702147197}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "49f87_00000", "date": "2025-08-11_19-32-40", "timestamp": 1754933560, "time_this_iter_s": 3.7681028842926025, "time_total_s": 58.330992460250854, "pid": 24466, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16fe2d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 58.330992460250854, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 67.2, "ram_util_percent": 81.12}}
{"timers": {"training_iteration": 4.594886073567064, "restore_env_runners": 2.606691728078176e-05, "training_step": 4.594578670871076, "env_runner_sampling_timer": 4.398506653626205, "learner_update_timer": 0.19113505713445333, "synch_weights": 0.0013275649389081269, "restore_eval_env_runners": 1.2957784753366576e-05, "evaluation_iteration": 0.2577149623030209, "synch_eval_env_connectors": 0.0001771908780079928, "synch_env_connectors": 4.781051532939074e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.7620763623708795e-06, "numpy_to_tensor": 1.9079450385845147e-05, "add_time_dim_to_batch_and_zero_pad": 4.489775909483213e-06, "batch_individual_items": 1.201163623356217e-05, "add_observations_from_episodes_to_batch": 5.220210277874397e-06}}, "connector_pipeline_timer": 7.811733832568611e-05}, "env_step_timer": 2.8576184786059798e-05, "module_episode_returns_mean": {"default_policy": 6.980000000000003}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 9.953057997789449e-06, "remove_single_ts_time_rank_from_batch": 9.471769685246904e-07, "listify_data_for_vector_env": 2.1441708162522438e-05, "get_actions": 9.566646050252942e-05, "tensor_to_numpy": 2.4903895791822893e-05, "normalize_and_clip_actions": 1.7723532463820485e-05}}, "connector_pipeline_timer": 0.0002145412328711351}, "episode_return_min": -9.5, "episode_return_mean": 6.980000000000003, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_reset_timer": 8.596745889018658e-05, "num_episodes": 250.0, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "episode_return_max": 10.5, "episode_len_max": 20, "time_between_sampling": 0.0025692098137416854, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "episode_duration_sec_mean": 0.008763811541721223, "agent_episode_returns_mean": {"default_agent": 6.980000000000003}, "weights_seq_no": 17.0, "num_env_steps_sampled_lifetime": -9870000.0, "sample": 0.011275475062317016, "rlmodule_inference_timer": 5.683994447111268e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "num_episodes_lifetime": -493500.0, "num_env_steps_sampled_lifetime_throughput": 2199.504356400357}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.052109595657286394, "add_one_ts_to_episodes_and_truncate": 0.019031608842827737, "general_advantage_estimation": 0.012818630702080685, "add_columns_from_episodes_to_train_batch": 0.053371500716624665, "numpy_to_tensor": 0.00010268719376139804, "add_time_dim_to_batch_and_zero_pad": 2.173802619527878e-05, "add_states_from_episodes_to_batch": 4.953685642714982e-06, "add_observations_from_episodes_to_batch": 0.0023166113753180753}}, "connector_pipeline_timer": 0.14006679771079802}, "num_module_steps_trained_lifetime": 108000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 567000, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1184462.729775461, "num_module_steps_trained_throughput": 226229.0694235569, "num_module_steps_trained_lifetime_throughput": 226061.24198130018}, "default_policy": {"mean_kl_loss": 2.4402635972364806e-05, "num_module_steps_trained_lifetime": 108000, "weights_seq_no": 18.0, "num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "vf_loss": 0.10278083384037018, "gradients_default_optimizer_global_norm": 0.08836914598941803, "curr_kl_coeff": 2.847657469828846e-06, "entropy": 0.5365307331085205, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 28.1092586517334, "total_loss": 0.06610782444477081, "policy_loss": 0.00222662091255188, "module_train_batch_size_mean": 1000.0, "vf_explained_var": -0.009521961212158203, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime_throughput": 226356.2217912003}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.528623512577106e-06, "batch_individual_items": 1.3496145485880678e-05, "numpy_to_tensor": 1.9537659341423225e-05, "add_time_dim_to_batch_and_zero_pad": 5.266061827814876e-06, "add_states_from_episodes_to_batch": 4.745945602945298e-06}}, "connector_pipeline_timer": 8.822593496586282e-05}, "weights_seq_no": 18.0, "agent_episode_returns_mean": {"default_agent": 0.25}, "env_step_timer": 3.72833896283104e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "num_episodes": 20, "episode_return_max": 14.5, "episode_duration_sec_mean": 0.008912665438838303, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.7327091903383492e-05, "remove_single_ts_time_rank_from_batch": 1.0841555880148423e-06, "un_batch_to_individual_items": 1.1317182744341458e-05, "get_actions": 0.00010292238454247845, "listify_data_for_vector_env": 2.3004684475985214e-05, "tensor_to_numpy": 3.3496067965439455e-05}}, "connector_pipeline_timer": 0.0002350796328117423}, "episode_return_min": -12.5, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.24250054447313193, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "num_episodes_lifetime": 360, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 0.25}, "env_reset_timer": 0.0008369517120827138, "episode_len_min": 20, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 90400, "rlmodule_inference_timer": 7.331874771999668e-05, "episode_return_mean": 0.25, "time_between_sampling": 2.8353589495927136}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "49f87_00000", "date": "2025-08-11_19-32-44", "timestamp": 1754933564, "time_this_iter_s": 3.341928005218506, "time_total_s": 61.67292046546936, "pid": 24466, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16fe2d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 61.67292046546936, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 82.58, "ram_util_percent": 81.9}}
{"timers": {"training_iteration": 4.58198617908131, "restore_env_runners": 2.5922498120043883e-05, "training_step": 4.581677351241818, "env_runner_sampling_timer": 4.3845615258399215, "learner_update_timer": 0.19216607781393752, "synch_weights": 0.0013241330396773705, "restore_eval_env_runners": 1.3063206366932417e-05, "evaluation_iteration": 0.258270693090403, "synch_eval_env_connectors": 0.00018258479911180124, "synch_env_connectors": 4.778240196108667e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.886829736464534e-06, "numpy_to_tensor": 2.0984594371783393e-05, "add_time_dim_to_batch_and_zero_pad": 5.076772850087408e-06, "batch_individual_items": 1.4252529562586756e-05, "add_observations_from_episodes_to_batch": 5.3146908695842265e-06}}, "connector_pipeline_timer": 8.606104235882867e-05}, "env_step_timer": 3.164001639547464e-05, "module_episode_returns_mean": {"default_policy": 7.2200000000000015}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.0963574798220551e-05, "remove_single_ts_time_rank_from_batch": 1.2218375009620026e-06, "listify_data_for_vector_env": 2.3432287120969868e-05, "get_actions": 9.953713525740612e-05, "tensor_to_numpy": 2.8954609453657213e-05, "normalize_and_clip_actions": 1.8035137020057128e-05}}, "connector_pipeline_timer": 0.00023301179546047942}, "episode_return_min": -9.5, "episode_return_mean": 7.2200000000000015, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_reset_timer": 7.894018373575643e-05, "num_episodes": 250.0, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "episode_return_max": 10.5, "episode_len_max": 20, "time_between_sampling": 0.003949961192608811, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "episode_duration_sec_mean": 0.010187483988236632, "agent_episode_returns_mean": {"default_agent": 7.2200000000000015}, "weights_seq_no": 18.0, "num_env_steps_sampled_lifetime": -10487500.0, "sample": 0.010138028096042202, "rlmodule_inference_timer": 6.475483765529608e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "num_episodes_lifetime": -524375.0, "num_env_steps_sampled_lifetime_throughput": 2219.114763170881}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.05362468595133871, "add_one_ts_to_episodes_and_truncate": 0.018933490663652176, "general_advantage_estimation": 0.01277220106532068, "add_columns_from_episodes_to_train_batch": 0.053230939880055395, "numpy_to_tensor": 0.00010246324179088409, "add_time_dim_to_batch_and_zero_pad": 2.1872735925119028e-05, "add_states_from_episodes_to_batch": 4.9428987903111455e-06, "add_observations_from_episodes_to_batch": 0.002302556931643604}}, "connector_pipeline_timer": 0.14128130390287655}, "num_module_steps_trained_lifetime": 114000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 598500, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1180218.9021596636, "num_module_steps_trained_throughput": 225390.01944781066, "num_module_steps_trained_lifetime_throughput": 225232.51124256337}, "default_policy": {"mean_kl_loss": 2.036566183960531e-05, "num_module_steps_trained_lifetime": 114000, "weights_seq_no": 19.0, "num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "vf_loss": 0.10278083384037018, "gradients_default_optimizer_global_norm": 0.020102325826883316, "curr_kl_coeff": 1.423828734914423e-06, "entropy": 0.5288645625114441, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 27.963809967041016, "total_loss": -0.04619554802775383, "policy_loss": -0.1101461872458458, "module_train_batch_size_mean": 1000.0, "vf_explained_var": -0.008934259414672852, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime_throughput": 225494.56405280347}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.87075039200592e-06, "batch_individual_items": 1.0923153034817583e-05, "numpy_to_tensor": 1.9530812894883362e-05, "add_time_dim_to_batch_and_zero_pad": 4.273410711951507e-06, "add_states_from_episodes_to_batch": 2.4361391672010612e-06}}, "connector_pipeline_timer": 7.13043747902702e-05}, "weights_seq_no": 19.0, "agent_episode_returns_mean": {"default_agent": -0.95}, "env_step_timer": 2.6347022367488003e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "num_episodes": 20, "episode_return_max": 12.5, "episode_duration_sec_mean": 0.009439402951393276, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.4378286772526431e-05, "remove_single_ts_time_rank_from_batch": 9.12124786656868e-07, "un_batch_to_individual_items": 7.947341863045985e-06, "get_actions": 6.983133917246532e-05, "listify_data_for_vector_env": 1.9040965740728415e-05, "tensor_to_numpy": 2.2920050144219984e-05}}, "connector_pipeline_timer": 0.00017174340399699571}, "episode_return_min": -12.5, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.2421239731883519, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "num_episodes_lifetime": 380, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": -0.95}, "env_reset_timer": 0.000829725104712229, "episode_len_min": 20, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 95400, "rlmodule_inference_timer": 5.080990458914405e-05, "episode_return_mean": -0.95, "time_between_sampling": 2.8403869338467254}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "49f87_00000", "date": "2025-08-11_19-32-47", "timestamp": 1754933567, "time_this_iter_s": 3.5285329818725586, "time_total_s": 65.20145344734192, "pid": 24466, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16fe2d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 65.20145344734192, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 83.52000000000001, "ram_util_percent": 82.12}}
{"timers": {"training_iteration": 4.565252253960224, "restore_env_runners": 2.5813682898797063e-05, "training_step": 4.564942564809098, "env_runner_sampling_timer": 4.36785505099094, "learner_update_timer": 0.192137978285397, "synch_weights": 0.001326448379540281, "restore_eval_env_runners": 1.3006734355726504e-05, "evaluation_iteration": 0.257880576989881, "synch_eval_env_connectors": 0.00018225270172641544, "synch_env_connectors": 4.808787843438833e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.71802745505221e-06, "numpy_to_tensor": 1.844096182557841e-05, "add_time_dim_to_batch_and_zero_pad": 4.4308362351285875e-06, "batch_individual_items": 1.2161085505623243e-05, "add_observations_from_episodes_to_batch": 5.413846937404758e-06}}, "connector_pipeline_timer": 7.855964605847076e-05}, "env_step_timer": 2.85694143378179e-05, "module_episode_returns_mean": {"default_policy": 6.980000000000003}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 9.638986457795894e-06, "remove_single_ts_time_rank_from_batch": 1.0374639022636629e-06, "listify_data_for_vector_env": 2.0495048122849997e-05, "get_actions": 9.07878484520386e-05, "tensor_to_numpy": 2.60617679814582e-05, "normalize_and_clip_actions": 1.7344239798487543e-05}}, "connector_pipeline_timer": 0.00020908577757423462}, "episode_return_min": -9.5, "episode_return_mean": 6.980000000000003, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_reset_timer": 8.603437074054506e-05, "num_episodes": 250.0, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "episode_return_max": 10.5, "episode_len_max": 20, "time_between_sampling": 0.0034689876270737312, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "episode_duration_sec_mean": 0.008960939846467227, "agent_episode_returns_mean": {"default_agent": 6.980000000000003}, "weights_seq_no": 19.0, "num_env_steps_sampled_lifetime": -11105000.0, "sample": 0.010324930807605489, "rlmodule_inference_timer": 5.770139309574243e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "num_episodes_lifetime": -555250.0, "num_env_steps_sampled_lifetime_throughput": 2203.4659417601392}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.05361492784229985, "add_one_ts_to_episodes_and_truncate": 0.01888896991673679, "general_advantage_estimation": 0.012734809474729419, "add_columns_from_episodes_to_train_batch": 0.05350452465144411, "numpy_to_tensor": 0.00010479277926698508, "add_time_dim_to_batch_and_zero_pad": 2.1790258730227645e-05, "add_states_from_episodes_to_batch": 4.933470106987768e-06, "add_observations_from_episodes_to_batch": 0.0022893722021024476}}, "connector_pipeline_timer": 0.14145079878417333}, "num_module_steps_trained_lifetime": 120000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 630000, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1174577.6473499779, "num_module_steps_trained_throughput": 224283.03842255467, "num_module_steps_trained_lifetime_throughput": 224137.6141573183}, "default_policy": {"mean_kl_loss": 0.0004883734509348869, "num_module_steps_trained_lifetime": 120000, "weights_seq_no": 20.0, "num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "vf_loss": 0.10278083384037018, "gradients_default_optimizer_global_norm": 0.08865606784820557, "curr_kl_coeff": 7.119143674572115e-07, "entropy": 0.5163688063621521, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 28.101835250854492, "total_loss": 0.06485634297132492, "policy_loss": 0.0007925351383164525, "module_train_batch_size_mean": 1000.0, "vf_explained_var": -0.009521126747131348, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime_throughput": 224366.96150880738}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 7.442730733773176e-06, "batch_individual_items": 1.9900070710372754e-05, "numpy_to_tensor": 3.073211288055009e-05, "add_time_dim_to_batch_and_zero_pad": 6.453337055045544e-06, "add_states_from_episodes_to_batch": 3.7098640791383104e-06}}, "connector_pipeline_timer": 0.00011688072526598698}, "weights_seq_no": 20.0, "agent_episode_returns_mean": {"default_agent": -1.75}, "env_step_timer": 4.668901409549196e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "num_episodes": 20, "episode_return_max": 14.5, "episode_duration_sec_mean": 0.010078028340358288, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 2.2267462383993448e-05, "remove_single_ts_time_rank_from_batch": 1.396480415939809e-06, "un_batch_to_individual_items": 2.2981059032728012e-05, "get_actions": 0.00013473022714289166, "listify_data_for_vector_env": 2.9822415331075525e-05, "tensor_to_numpy": 3.748040573650682e-05}}, "connector_pipeline_timer": 0.00031033790331967687}, "episode_return_min": -12.5, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 400}, "sample": 0.24217853220699745, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "num_episodes_lifetime": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_episode_returns_mean": {"default_policy": -1.75}, "env_reset_timer": 0.0008230853528983674, "episode_len_min": 20, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 100400, "rlmodule_inference_timer": 8.843298283895278e-05, "episode_return_mean": -1.75, "time_between_sampling": 2.8416088003487854}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "49f87_00000", "date": "2025-08-11_19-32-50", "timestamp": 1754933570, "time_this_iter_s": 3.17049503326416, "time_total_s": 68.37194848060608, "pid": 24466, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16fe2d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 68.37194848060608, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 78.5, "ram_util_percent": 81.12}}
